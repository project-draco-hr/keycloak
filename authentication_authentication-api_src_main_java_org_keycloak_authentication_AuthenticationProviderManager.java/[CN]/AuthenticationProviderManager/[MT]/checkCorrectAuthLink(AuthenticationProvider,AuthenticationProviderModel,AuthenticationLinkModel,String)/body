{
  AuthUser authUser=authProvider.getUser(realm,providerModel.getConfig(),username);
  if (authUser == null) {
    throw new AuthenticationProviderException("User " + username + " not found in authentication provider "+ providerModel.getProviderName());
  }
  String userExternalId=authUser.getId();
  if (!userExternalId.equals(authLinkModel.getAuthUserId())) {
    throw new AuthenticationProviderException("ID did not match! ID from provider: " + userExternalId + ", ID from authentication link: "+ authLinkModel.getAuthUserId());
  }
}
