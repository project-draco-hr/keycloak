{
  RealmModel realm=getRealm(currentRealm,config);
  String error=realm.getPasswordPolicy().validate(password);
  if (error != null) {
    throw new AuthenticationProviderException(error);
  }
  UserModel user=keycloakSession.users().getUserByUsername(username,realm);
  if (user == null) {
    logger.warnf("User '%s' doesn't exists. Skip password update",username);
    return false;
  }
  UserCredentialModel cred=new UserCredentialModel();
  cred.setType(CredentialRepresentation.PASSWORD);
  cred.setValue(password);
  user.updateCredential(cred);
  return true;
}
