{
  RealmModel realm=getRealm(currentRealm,config);
  UserModel user=KeycloakModelUtils.findUserByNameOrEmail(keycloakSession,realm,username);
  boolean result=keycloakSession.users().validCredentials(realm,user,UserCredentialModel.password(password));
  return result ? AuthProviderStatus.SUCCESS : AuthProviderStatus.INVALID_CREDENTIALS;
}
