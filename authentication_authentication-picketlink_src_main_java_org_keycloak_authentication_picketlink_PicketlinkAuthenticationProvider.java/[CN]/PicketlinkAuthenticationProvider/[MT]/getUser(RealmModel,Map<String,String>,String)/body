{
  IdentityManager identityManager=getIdentityManager(realm);
  try {
    User picketlinkUser=BasicModel.getUser(identityManager,username);
    if (picketlinkUser == null) {
      return null;
    }
    String email=(picketlinkUser.getEmail() != null && picketlinkUser.getEmail().trim().length() > 0) ? picketlinkUser.getEmail() : null;
    return new AuthUser(picketlinkUser.getId(),picketlinkUser.getLoginName(),getName()).setName(picketlinkUser.getFirstName(),picketlinkUser.getLastName()).setEmail(email).setProviderName(getName());
  }
 catch (  IdentityManagementException ie) {
    throw convertIDMException(ie);
  }
}
