{
  if (response.startsWith("{")) {
    try {
      return mapper.readTree(response).get(tokenName).getTextValue();
    }
 catch (    IOException e) {
      throw new RuntimeException("Could not extract token [" + tokenName + "] from response ["+ response+ "].",e);
    }
  }
 else {
    Matcher matcher=Pattern.compile(tokenName + "=([^&]+)").matcher(response);
    if (matcher.find()) {
      return matcher.group(1);
    }
  }
  return null;
}
