{
  JaxrsSAML2BindingBuilder binding=new JaxrsSAML2BindingBuilder().relayState(userSession.getId());
  if (getConfig().isWantAuthnRequestsSigned()) {
    binding.signWith(realm.getPrivateKey(),realm.getPublicKey(),realm.getCertificate()).signatureAlgorithm(getSignatureAlgorithm()).signDocument();
  }
  return binding;
}
