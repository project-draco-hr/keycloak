{
  JWSInput input;
  try {
    input=new JWSInput(tokenString);
  }
 catch (  JWSInputException e) {
    throw new VerificationException("Couldn't parse token",e);
  }
  if (!isPublicKeyValid(input,realmKey))   throw new VerificationException("Invalid token signature.");
  AccessToken token;
  try {
    token=input.readJsonContent(AccessToken.class);
  }
 catch (  JWSInputException e) {
    throw new VerificationException("Couldn't parse token signature",e);
  }
  return token;
}
