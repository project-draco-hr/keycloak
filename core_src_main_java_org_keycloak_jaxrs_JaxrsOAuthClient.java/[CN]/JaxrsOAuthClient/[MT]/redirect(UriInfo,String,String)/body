{
  String state=getStateCode();
  if (path != null) {
    state+="#" + path;
  }
  URI url=UriBuilder.fromUri(authUrl).queryParam("client_id",clientId).queryParam("redirect_uri",redirectUri).queryParam("state",state).build();
  NewCookie cookie=new NewCookie(getStateCookieName(),state,getStateCookiePath(uriInfo),null,null,-1,isSecure,true);
  logger.debug("NewCookie: " + cookie.toString());
  logger.debug("Oauth Redirect to: " + url);
  return Response.status(302).location(url).cookie(cookie).build();
}
