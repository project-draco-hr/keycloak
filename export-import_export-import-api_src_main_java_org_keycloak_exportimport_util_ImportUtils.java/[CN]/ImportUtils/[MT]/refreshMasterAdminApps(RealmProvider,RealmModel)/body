{
  String adminRealmId=Config.getAdminRealm();
  if (adminRealmId.equals(realm.getId())) {
    RealmModel adminRealm=realm;
    for (    RealmModel currentRealm : model.getRealms()) {
      ClientModel masterApp=adminRealm.getClientByClientId(KeycloakModelUtils.getMasterRealmAdminApplicationName(currentRealm));
      if (masterApp != null) {
        currentRealm.setMasterAdminApp(masterApp);
      }
 else {
        setupMasterAdminManagement(model,currentRealm);
      }
    }
  }
 else {
    RealmModel adminRealm=model.getRealm(adminRealmId);
    ClientModel masterApp=adminRealm.getClientByClientId(KeycloakModelUtils.getMasterRealmAdminApplicationName(realm));
    if (masterApp != null) {
      realm.setMasterAdminApp(masterApp);
    }
 else {
      setupMasterAdminManagement(model,realm);
    }
  }
}
