{
  Class<?> modelClass=getModelClass(model);
  checkPropertiesAvailable(modelClass,entity.getClass());
  Map<String,Property<Object>> modelProps=this.objectProperties.get(modelClass);
  Map<String,Property<Object>> entityProps=this.objectProperties.get(entity.getClass());
  Map<String,Property<Object>> entityPropsCopy=new HashMap<String,Property<Object>>(entityProps);
  logger.debugf("Properties of exported entity %s: %s",entity,entityProps.keySet());
  for (  Property<Object> modelProperty : modelProps.values()) {
    Property<Object> entityProperty=entityPropsCopy.get(modelProperty.getName());
    entityPropsCopy.remove(modelProperty.getName());
    if (entityProperty != null) {
      Object propertyValue=entityProperty.getValue(entity);
      if (propertyValue instanceof List && Set.class.isAssignableFrom(modelProperty.getJavaClass())) {
        List propValueAsList=(List)propertyValue;
        modelProperty.setValue(model,new HashSet(propValueAsList));
      }
 else {
        modelProperty.setValue(model,propertyValue);
      }
      if (logger.isTraceEnabled()) {
        logger.tracef("Property %s successfully set in model from entity %s",modelProperty.getName(),entity);
      }
    }
 else {
      logger.debugf("Property %s not known for entity %s",modelProperty.getName(),entity);
    }
  }
  logger.debugf("Entity properties for manual setup: %s",entityPropsCopy.keySet());
}
