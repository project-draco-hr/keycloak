{
  System.setProperty("keycloak.model.provider",getExportModelProvider());
  factory=KeycloakApplication.createProviderSessionFactory();
  beginTransaction();
  new ApplianceBootstrap().bootstrap(identitySession,"/auth");
  commitTransaction();
  beginTransaction();
  RealmRepresentation rep=AbstractModelTest.loadJson("testrealm.json");
  realmManager=new RealmManager(identitySession);
  RealmModel realm=realmManager.createRealm("demo",rep.getRealm());
  realmManager.importRealm(rep,realm);
  commitTransaction();
  exportModel(factory);
  beginTransaction();
  realm=identitySession.getRealm("demo");
  String wburkeId=realm.getUser("wburke").getId();
  String appId=realm.getApplicationByName("Application").getId();
  commitTransaction();
  factory.close();
  System.setProperty("keycloak.model.provider",getImportModelProvider());
  factory=KeycloakApplication.createProviderSessionFactory();
  importModel(factory);
  beginTransaction();
  RealmModel importedRealm=identitySession.getRealm("demo");
  System.out.println("Exported realm: " + realm + ", Imported realm: "+ importedRealm);
  Assert.assertEquals(wburkeId,importedRealm.getUser("wburke").getId());
  Assert.assertEquals(appId,importedRealm.getApplicationByName("Application").getId());
  ImportTest.assertDataImportedInRealm(importedRealm);
  commitTransaction();
  factory.close();
}
