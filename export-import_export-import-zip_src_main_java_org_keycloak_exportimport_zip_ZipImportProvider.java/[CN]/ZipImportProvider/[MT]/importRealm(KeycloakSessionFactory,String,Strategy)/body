{
  try {
    ByteArrayOutputStream bos=new ByteArrayOutputStream();
    this.decrypter.extractEntry(this.decrypter.getEntry(realmName + "-realm.json"),bos,this.password);
    ByteArrayInputStream bis=new ByteArrayInputStream(bos.toByteArray());
    final RealmRepresentation realmRep=JsonSerialization.mapper.readValue(bis,RealmRepresentation.class);
    KeycloakModelUtils.runJobInTransaction(factory,new ExportImportSessionTask(){
      @Override protected void runExportImportTask(      KeycloakSession session) throws IOException {
        ImportUtils.importRealm(session,realmRep,strategy);
      }
    }
);
    for (    ExtZipEntry entry : this.decrypter.getEntryList()) {
      String name=entry.getName();
      if (name.matches(realmName + "-users-[0-9]+\\.json")) {
        bos=new ByteArrayOutputStream();
        this.decrypter.extractEntry(entry,bos,this.password);
        final ByteArrayInputStream bis2=new ByteArrayInputStream(bos.toByteArray());
        KeycloakModelUtils.runJobInTransaction(factory,new ExportImportSessionTask(){
          @Override protected void runExportImportTask(          KeycloakSession session) throws IOException {
            ImportUtils.importUsersFromStream(session,realmName,JsonSerialization.mapper,bis2);
          }
        }
);
      }
    }
  }
 catch (  DataFormatException dfe) {
    throw new RuntimeException(dfe);
  }
}
