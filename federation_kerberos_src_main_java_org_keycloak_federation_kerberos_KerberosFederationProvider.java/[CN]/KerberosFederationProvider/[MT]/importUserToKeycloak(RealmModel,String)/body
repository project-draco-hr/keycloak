{
  String email=username + "@" + kerberosConfig.getKerberosRealm().toLowerCase();
  logger.info("Creating kerberos user: " + username + ", email: "+ email+ " to local Keycloak storage");
  UserModel user=session.userStorage().addUser(realm,username);
  user.setEnabled(true);
  user.setEmail(email);
  user.setFederationLink(model.getId());
  user.setAttribute(KERBEROS_PRINCIPAL,username + "@" + kerberosConfig.getKerberosRealm());
  if (kerberosConfig.isUpdateProfileFirstLogin()) {
    user.addRequiredAction(UserModel.RequiredAction.UPDATE_PROFILE);
  }
  return proxy(user);
}
