{
  if (username.contains("@")) {
    String[] tokens=username.split("@");
    username=tokens[0];
    String kerberosRealm=tokens[1];
    if (kerberosRealm.toUpperCase().equals(config.getKerberosRealm())) {
      logger.warn("Invalid kerberos realm. Expected realm: " + config.getKerberosRealm() + ", username: "+ username);
      throw new LoginException("Invalid kerberos realm");
    }
  }
  return username + "@" + config.getKerberosRealm();
}
