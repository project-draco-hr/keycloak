{
  if (log.isTraceEnabled()) {
    log.trace("SPNEGO Login with token: " + spnegoToken);
  }
  try {
    Subject serverSubject=kerberosSubjectAuthenticator.authenticateServerSubject();
    authenticated=Subject.doAs(serverSubject,new AcceptSecContext());
  }
 catch (  Exception e) {
    String message=e.getMessage();
    if (e instanceof PrivilegedActionException && e.getCause() != null) {
      message=e.getCause().getMessage();
    }
    log.warn("SPNEGO login failed: " + message);
    if (log.isDebugEnabled()) {
      log.debug("SPNEGO login failed: " + message,e);
    }
  }
 finally {
    kerberosSubjectAuthenticator.logoutServerSubject();
  }
}
