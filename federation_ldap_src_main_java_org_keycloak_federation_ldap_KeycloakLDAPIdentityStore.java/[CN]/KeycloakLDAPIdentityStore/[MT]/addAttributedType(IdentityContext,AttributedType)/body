{
  LDAPMappingConfiguration userMappingConfig=getConfig().getMappingConfig(attributedType.getClass());
  String ldapUsernameAttrName=userMappingConfig.getMappedProperties().get(userMappingConfig.getIdProperty().getName());
  if (getConfig().isActiveDirectory() && SAM_ACCOUNT_NAME.equals(ldapUsernameAttrName)) {
    LDAPOperationManager operationManager=Reflections.invokeMethod(false,GET_OPERATION_MANAGER_METHOD,LDAPOperationManager.class,this);
    String cn=getCommonName(attributedType);
    String bindingDN=CN + EQUAL + cn+ COMMA+ userMappingConfig.getBaseDN();
    BasicAttributes ldapAttributes=Reflections.invokeMethod(false,EXTRACT_ATTRIBUTES_METHOD,BasicAttributes.class,this,attributedType,true);
    ldapAttributes.put(CN,cn);
    operationManager.createSubContext(bindingDN,ldapAttributes);
    String ldapId=Reflections.invokeMethod(false,GET_ENTRY_IDENTIFIER_METHOD,String.class,this,attributedType);
    attributedType.setId(ldapId);
  }
 else {
    super.addAttributedType(context,attributedType);
  }
}
