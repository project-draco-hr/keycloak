{
  LDAPQuery ldapQuery=LDAPUtils.createQueryForUserSearch(this,realm);
  LDAPQueryConditionsBuilder conditionsBuilder=new LDAPQueryConditionsBuilder();
  String usernameMappedAttribute=this.ldapIdentityStore.getConfig().getUsernameLdapAttribute();
  Condition usernameCondition=conditionsBuilder.equal(new QueryParameter(usernameMappedAttribute),username);
  ldapQuery.where(usernameCondition);
  LDAPObject ldapUser=ldapQuery.getFirstResult();
  if (ldapUser == null) {
    return null;
  }
  return ldapUser;
}
