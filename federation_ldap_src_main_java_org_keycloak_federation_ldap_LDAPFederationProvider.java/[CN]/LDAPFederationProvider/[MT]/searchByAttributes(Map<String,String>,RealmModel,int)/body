{
  List<UserModel> searchResults=new LinkedList<UserModel>();
  Map<String,LDAPUser> ldapUsers=searchLDAP(attributes,maxResults);
  for (  LDAPUser ldapUser : ldapUsers.values()) {
    if (session.userStorage().getUserByUsername(ldapUser.getLoginName(),realm) == null) {
      UserModel imported=importUserFromLDAP(realm,ldapUser);
      searchResults.add(imported);
    }
  }
  return searchResults;
}
