{
  logger.infof("Sync changed users from LDAP to local store: realm: %s, federation provider: %s, last sync time: " + lastSync,realmId,model.getDisplayName());
  LDAPIdentityStore ldapIdentityStore=this.ldapStoreRegistry.getLdapStore(model);
  IdentityQueryBuilder queryBuilder=ldapIdentityStore.createQueryBuilder();
  Condition createCondition=queryBuilder.greaterThanOrEqualTo(IdentityType.CREATED_DATE,lastSync);
  Condition modifyCondition=queryBuilder.greaterThanOrEqualTo(LDAPUtils.MODIFY_DATE,lastSync);
  Condition orCondition=queryBuilder.orCondition(createCondition,modifyCondition);
  IdentityQuery<LDAPUser> userQuery=queryBuilder.createIdentityQuery(LDAPUser.class).where(orCondition);
  UserFederationSyncResult result=syncImpl(sessionFactory,userQuery,realmId,model);
  logger.infof("Sync changed users finished: %s",result.getStatus());
  return result;
}
