{
  logger.infof("Sync changed users from LDAP to local store: realm: %s, federation provider: %s, current time: %s, last sync time: " + lastSync,realmId,model.getDisplayName(),new Date().toString());
  LDAPIdentityStore ldapIdentityStore=this.ldapStoreRegistry.getLdapStore(model);
  IdentityQueryBuilder queryBuilder=ldapIdentityStore.createQueryBuilder();
  Condition condition=queryBuilder.greaterThanOrEqualTo(IdentityType.CREATED_DATE,lastSync);
  IdentityQuery<LDAPUser> userQuery=queryBuilder.createIdentityQuery(LDAPUser.class).where(condition);
  syncImpl(sessionFactory,userQuery,realmId,model);
  condition=queryBuilder.greaterThanOrEqualTo(LDAPUtils.MODIFY_DATE,lastSync);
  userQuery=queryBuilder.createIdentityQuery(LDAPUser.class).where(condition);
  syncImpl(sessionFactory,userQuery,realmId,model);
}
