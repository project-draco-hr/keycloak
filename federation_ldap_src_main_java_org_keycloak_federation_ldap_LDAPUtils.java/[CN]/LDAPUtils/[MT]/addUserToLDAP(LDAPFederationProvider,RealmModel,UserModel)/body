{
  LDAPObject ldapObject=new LDAPObject();
  LDAPIdentityStore ldapStore=ldapProvider.getLdapIdentityStore();
  LDAPConfig ldapConfig=ldapStore.getConfig();
  ldapObject.setRdnAttributeName(ldapConfig.getRdnLdapAttribute());
  ldapObject.setObjectClasses(ldapConfig.getObjectClasses());
  List<UserFederationMapperModel> federationMappers=realm.getUserFederationMappers();
  for (  UserFederationMapperModel mapperModel : federationMappers) {
    LDAPFederationMapper ldapMapper=ldapProvider.getMapper(mapperModel);
    ldapMapper.registerUserToLDAP(mapperModel,ldapProvider,ldapObject,user);
  }
  LDAPUtils.computeAndSetDn(ldapConfig,ldapObject);
  ldapStore.add(ldapObject);
  return ldapObject;
}
