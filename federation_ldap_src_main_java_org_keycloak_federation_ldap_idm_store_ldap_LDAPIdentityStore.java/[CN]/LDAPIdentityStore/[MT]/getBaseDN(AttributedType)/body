{
  LDAPMappingConfiguration mappingConfig=getMappingConfig(attributedType.getClass());
  String baseDN=mappingConfig.getBaseDN();
  String parentDN=mappingConfig.getParentMapping().get(mappingConfig.getIdProperty().getValue(attributedType));
  if (parentDN != null) {
    baseDN=parentDN;
  }
 else {
    Property<AttributedType> parentProperty=PropertyQueries.<AttributedType>createQuery(attributedType.getClass()).addCriteria(new TypedPropertyCriteria(attributedType.getClass())).getFirstResult();
    if (parentProperty != null) {
      AttributedType parentType=parentProperty.getValue(attributedType);
      if (parentType != null) {
        Property<String> parentIdProperty=getMappingConfig(parentType.getClass()).getIdProperty();
        String parentId=parentIdProperty.getValue(parentType);
        String parentBaseDN=mappingConfig.getParentMapping().get(parentId);
        if (parentBaseDN != null) {
          baseDN=parentBaseDN;
        }
 else {
          baseDN=getBaseDN(parentType);
        }
      }
    }
  }
  if (baseDN == null) {
    baseDN=getConfig().getBaseDN();
  }
  return baseDN;
}
