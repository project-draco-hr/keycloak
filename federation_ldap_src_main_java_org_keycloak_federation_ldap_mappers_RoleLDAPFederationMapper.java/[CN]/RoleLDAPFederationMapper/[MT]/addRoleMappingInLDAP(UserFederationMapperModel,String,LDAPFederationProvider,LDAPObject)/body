{
  LDAPObject ldapRole=loadLDAPRoleByName(mapperModel,ldapProvider,roleName);
  if (ldapRole == null) {
    ldapRole=createLDAPRole(mapperModel,roleName,ldapProvider);
  }
  Set<String> memberships=getExistingMemberships(mapperModel,ldapRole);
  for (  String membership : memberships) {
    if (LDAPConstants.EMPTY_MEMBER_ATTRIBUTE_VALUE.equals(membership)) {
      memberships.remove(membership);
      break;
    }
  }
  memberships.add(ldapUser.getDn().toString());
  ldapRole.setAttribute(getMembershipLdapAttribute(mapperModel),memberships);
  ldapProvider.getLdapIdentityStore().update(ldapRole);
}
