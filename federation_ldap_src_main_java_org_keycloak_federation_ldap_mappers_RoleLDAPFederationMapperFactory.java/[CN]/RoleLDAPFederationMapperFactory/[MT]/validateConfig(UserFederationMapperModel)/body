{
  checkMandatoryConfigAttribute(RoleLDAPFederationMapper.ROLES_DN,"LDAP Roles DN",mapperModel);
  checkMandatoryConfigAttribute(RoleLDAPFederationMapper.MODE,"Mode",mapperModel);
  String realmMappings=mapperModel.getConfig().get(RoleLDAPFederationMapper.USE_REALM_ROLES_MAPPING);
  boolean useRealmMappings=Boolean.parseBoolean(realmMappings);
  if (!useRealmMappings) {
    String clientId=mapperModel.getConfig().get(RoleLDAPFederationMapper.CLIENT_ID);
    if (clientId == null || clientId.trim().isEmpty()) {
      throw new MapperConfigValidationException("Client ID needs to be provided in config when Realm Roles Mapping is not used");
    }
  }
  String customLdapFilter=mapperModel.getConfig().get(RoleLDAPFederationMapper.ROLES_LDAP_FILTER);
  if ((customLdapFilter != null && customLdapFilter.trim().length() > 0) && (!customLdapFilter.startsWith("(") || !customLdapFilter.endsWith(")"))) {
    throw new MapperConfigValidationException("Custom Roles LDAP filter must starts with '(' and ends with ')'");
  }
}
