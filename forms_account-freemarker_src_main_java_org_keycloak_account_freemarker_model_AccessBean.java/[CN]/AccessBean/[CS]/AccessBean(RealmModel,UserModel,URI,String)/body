{
  List<UserConsentModel> grantedConsents=user.getConsents();
  for (  UserConsentModel consent : grantedConsents) {
    ClientModel client=consent.getClient();
    List<RoleModel> realmRolesGranted=new LinkedList<RoleModel>();
    MultivaluedHashMap<String,RoleModel> resourceRolesGranted=new MultivaluedHashMap<String,RoleModel>();
    for (    RoleModel role : consent.getGrantedRoles()) {
      if (role.getContainer() instanceof RealmModel) {
        realmRolesGranted.add(role);
      }
 else {
        resourceRolesGranted.add(((ClientModel)role.getContainer()).getClientId(),role);
      }
    }
    List<String> claimsGranted=new LinkedList<String>();
    for (    ProtocolMapperModel protocolMapper : consent.getGrantedProtocolMappers()) {
      claimsGranted.add(protocolMapper.getConsentText());
    }
    ClientGrantBean clientGrant=new ClientGrantBean(realmRolesGranted,resourceRolesGranted,client,claimsGranted);
    clientGrants.add(clientGrant);
  }
}
