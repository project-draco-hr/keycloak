{
  this.realmName=realm.getName();
  this.enabled=user.isTotp();
  this.contextUrl=baseUri.getPath();
  this.totpSecret=randomString(20);
  this.totpSecretEncoded=Base32.encode(totpSecret.getBytes());
}
