{
  this.code=code;
  this.client=client;
  this.realmRolesRequested=realmRolesRequested;
  this.resourceRolesRequested=resourceRolesRequested;
  this.accessRequestMessage=accessRequestMessage;
  List<String> claims=new LinkedList<String>();
  long mask=client.getAllowedClaimsMask();
  if (ClaimMask.hasEmail(mask)) {
    claims.add("email");
  }
  if (ClaimMask.hasUsername(mask)) {
    claims.add("username");
  }
  if (ClaimMask.hasName(mask)) {
    claims.add("name");
  }
  if (ClaimMask.hasGender(mask)) {
    claims.add("gender");
  }
  if (ClaimMask.hasAddress(mask)) {
    claims.add("address");
  }
  if (ClaimMask.hasPhone(mask)) {
    claims.add("phone");
  }
  if (ClaimMask.hasPicture(mask)) {
    claims.add("picture");
  }
  if (ClaimMask.hasProfile(mask)) {
    claims.add("profile page");
  }
  if (ClaimMask.hasLocale(mask)) {
    claims.add("locale");
  }
  if (ClaimMask.hasWebsite(mask)) {
    claims.add("website");
  }
  if (claims.size() > 0)   this.claimsRequested=claims;
}
