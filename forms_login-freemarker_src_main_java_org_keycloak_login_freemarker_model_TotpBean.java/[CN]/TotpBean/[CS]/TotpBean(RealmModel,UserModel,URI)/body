{
  this.realmName=realm.getName();
  this.enabled=user.isOtpEnabled();
  this.contextUrl=baseUri.getPath();
  this.totpSecret=HmacOTP.generateSecret(20);
  this.totpSecretEncoded=Base32.encode(totpSecret.getBytes());
  this.keyUri=realm.getOTPPolicy().getKeyURI(realm,this.totpSecret);
}
