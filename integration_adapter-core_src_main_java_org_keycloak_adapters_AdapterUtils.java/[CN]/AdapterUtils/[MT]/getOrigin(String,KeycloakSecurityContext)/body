{
  if (session instanceof RefreshableKeycloakSecurityContext) {
    KeycloakDeployment deployment=((RefreshableKeycloakSecurityContext)session).getDeployment();
switch (deployment.getRelativeUrls()) {
case ALL_REQUESTS:
      return UriUtils.getOrigin(browserRequestURL);
case BROWSER_ONLY:
case NEVER:
    return UriUtils.getOrigin(deployment.getCodeUrl());
default :
  return "";
}
}
 else {
return UriUtils.getOrigin(browserRequestURL);
}
}
