{
  if (adapterConfig.getRealm() == null)   throw new RuntimeException("Must set 'realm' in config");
  deployment.setRealm(adapterConfig.getRealm());
  String resource=adapterConfig.getResource();
  if (resource == null)   throw new RuntimeException("Must set 'resource' in config");
  deployment.setResourceName(resource);
  String realmKeyPem=adapterConfig.getRealmKey();
  if (realmKeyPem != null) {
    PublicKey realmKey=null;
    try {
      realmKey=PemUtils.decodePublicKey(realmKeyPem);
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
    deployment.setRealmKey(realmKey);
  }
  deployment.setSslRequired(!adapterConfig.isSslNotRequired());
  deployment.setResourceCredentials(adapterConfig.getCredentials());
  deployment.setPublicClient(adapterConfig.isPublicClient());
  deployment.setUseResourceRoleMappings(adapterConfig.isUseResourceRoleMappings());
  if (adapterConfig.isCors()) {
    deployment.setCors(true);
    deployment.setCorsMaxAge(adapterConfig.getCorsMaxAge());
    deployment.setCorsAllowedHeaders(adapterConfig.getCorsAllowedHeaders());
    deployment.setCorsAllowedMethods(adapterConfig.getCorsAllowedMethods());
  }
  if (realmKeyPem == null && adapterConfig.isBearerOnly() && adapterConfig.getAuthServerUrl() == null) {
    throw new IllegalArgumentException("For bearer auth, you must set the realm-public-key or auth-server-url");
  }
  if (adapterConfig.isBearerOnly()) {
    deployment.setBearerOnly(true);
    return deployment;
  }
  deployment.setClient(new HttpClientBuilder().build(adapterConfig));
  if (adapterConfig.getAuthServerUrl() == null) {
    throw new RuntimeException("You must specify auth-url");
  }
  deployment.setAuthServerBaseUrl(adapterConfig.getAuthServerUrl());
  return deployment;
}
