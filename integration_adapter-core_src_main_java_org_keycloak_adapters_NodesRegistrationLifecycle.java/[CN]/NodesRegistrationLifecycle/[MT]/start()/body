{
  if (!deployment.isRegisterNodeAtStartup() && deployment.getRegisterNodePeriod() <= 0) {
    log.info("Skip registration of cluster nodes at startup");
    return;
  }
  if (deployment.getRelativeUrls() == RelativeUrlsUsed.ALL_REQUESTS) {
    log.warn("Skip registration of cluster nodes at startup as Keycloak node can't be contacted. Make sure to not use relative URI in adapters configuration!");
    return;
  }
  if (deployment.isRegisterNodeAtStartup()) {
    boolean success=sendRegistrationEvent();
    if (!success) {
      throw new IllegalStateException("Failed to register node to keycloak at startup");
    }
  }
  if (deployment.getRegisterNodePeriod() > 0) {
    addPeriodicListener();
  }
}
