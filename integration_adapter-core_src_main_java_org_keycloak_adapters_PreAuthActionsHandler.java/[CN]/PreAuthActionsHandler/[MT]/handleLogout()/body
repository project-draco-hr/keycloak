{
  if (log.isTraceEnabled()) {
    log.trace("K_LOGOUT sent");
  }
  try {
    JWSInput token=verifyAdminRequest();
    if (token == null) {
      return;
    }
    LogoutAction action=JsonSerialization.readValue(token.getContent(),LogoutAction.class);
    if (!validateAction(action))     return;
    String user=action.getUser();
    if (user != null) {
      log.debug("logout of session for: " + user);
      userSessionManagement.logoutUser(user);
    }
 else     if (action.getSession() != null) {
      userSessionManagement.logoutKeycloakSession(action.getSession());
    }
 else {
      log.debug("logout of all sessions");
      if (action.getNotBefore() > deployment.getNotBefore()) {
        deployment.setNotBefore(action.getNotBefore());
      }
      userSessionManagement.logoutAll();
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
