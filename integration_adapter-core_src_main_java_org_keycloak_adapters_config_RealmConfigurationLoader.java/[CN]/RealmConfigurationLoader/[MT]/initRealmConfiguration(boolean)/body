{
  realmConfiguration=new RealmConfiguration();
  realmConfiguration.setMetadata(resourceMetadata);
  realmConfiguration.setSslRequired(!adapterConfig.isSslNotRequired());
  realmConfiguration.setResourceCredentials(adapterConfig.getCredentials());
  if (!setupClient || adapterConfig.isBearerOnly())   return;
  initClient();
  if (adapterConfig.getAuthServerUrl() == null) {
    throw new RuntimeException("You must specify auth-url");
  }
  KeycloakUriBuilder serverBuilder=KeycloakUriBuilder.fromUri(adapterConfig.getAuthServerUrl());
  String authUrl=serverBuilder.clone().path(ServiceUrlConstants.TOKEN_SERVICE_LOGIN_PATH).build(adapterConfig.getRealm()).toString();
  String tokenUrl=serverBuilder.clone().path(ServiceUrlConstants.TOKEN_SERVICE_ACCESS_CODE_PATH).build(adapterConfig.getRealm()).toString();
  String refreshUrl=serverBuilder.clone().path(ServiceUrlConstants.TOKEN_SERVICE_REFRESH_PATH).build(adapterConfig.getRealm()).toString();
  HttpClient client=getClient();
  realmConfiguration.setClient(client);
  realmConfiguration.setAuthUrl(KeycloakUriBuilder.fromUri(authUrl).queryParam("client_id",resourceMetadata.getResourceName()));
  realmConfiguration.setCodeUrl(tokenUrl);
  realmConfiguration.setRefreshUrl(refreshUrl);
}
