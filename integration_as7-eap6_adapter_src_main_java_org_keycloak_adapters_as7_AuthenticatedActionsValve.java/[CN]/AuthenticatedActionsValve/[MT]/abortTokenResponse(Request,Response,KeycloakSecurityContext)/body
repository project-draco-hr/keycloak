{
  if (session == null) {
    log.debugv("session was null, sending back 401: {0}",request.getRequestURI());
    response.sendError(HttpServletResponse.SC_UNAUTHORIZED);
    return true;
  }
  if (!config.isExposeToken()) {
    response.setStatus(HttpServletResponse.SC_OK);
    return true;
  }
  if (!config.isCors() && request.getHeader("Origin") != null) {
    response.setStatus(HttpServletResponse.SC_OK);
    return true;
  }
  return false;
}
