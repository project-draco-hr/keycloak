{
  Set<String> roles=getRolesFromToken(securityContext);
  GenericPrincipal principal=new CatalinaSecurityContextHelper().createPrincipal(request.getContext().getRealm(),skp,roles);
  Session session=request.getSessionInternal(true);
  session.setPrincipal(principal);
  session.setAuthType("OAUTH");
  session.setNote(KeycloakSecurityContext.class.getName(),securityContext);
  String username=securityContext.getToken().getSubject();
  log.debug("userSessionManage.login: " + username);
  userSessionManagement.login(session,username);
}
