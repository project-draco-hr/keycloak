{
  if (log.isTraceEnabled()) {
    log.trace("*** authenticate");
  }
  CatalinaHttpFacade facade=new CatalinaHttpFacade(request,response);
  KeycloakDeployment deployment=deploymentContext.resolveDeployment(facade);
  if (deployment == null || !deployment.isConfigured()) {
    log.info("*** deployment isn't configured return false");
    return false;
  }
  CatalinaRequestAuthenticator authenticator=new CatalinaRequestAuthenticator(deployment,this,userSessionManagement,facade,request);
  AuthOutcome outcome=authenticator.authenticate();
  if (outcome == AuthOutcome.AUTHENTICATED) {
    if (facade.isEnded()) {
      return false;
    }
    return true;
  }
  AuthChallenge challenge=authenticator.getChallenge();
  if (challenge != null) {
    challenge.challenge(facade);
  }
  return false;
}
