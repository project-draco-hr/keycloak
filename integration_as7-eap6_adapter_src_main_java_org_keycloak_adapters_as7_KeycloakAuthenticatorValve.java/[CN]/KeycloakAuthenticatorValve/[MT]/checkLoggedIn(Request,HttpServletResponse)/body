{
  if (request.getSessionInternal(false) == null || request.getSessionInternal().getPrincipal() == null)   return false;
  log.debug("remote logged in already");
  GenericPrincipal principal=(GenericPrincipal)request.getSessionInternal().getPrincipal();
  request.setUserPrincipal(principal);
  request.setAuthType("KEYCLOAK");
  Session session=request.getSessionInternal();
  if (session != null) {
    KeycloakSecurityContext skSession=(KeycloakSecurityContext)session.getNote(KeycloakSecurityContext.class.getName());
    if (skSession != null) {
      request.setAttribute(KeycloakSecurityContext.class.getName(),skSession);
    }
  }
  return true;
}
