{
  if (request.getPrincipal() != null) {
    return (GenericPrincipal)request.getPrincipal();
  }
 else   if (request.getSessionInternal() != null && request.getSessionInternal().getPrincipal() != null) {
    return (GenericPrincipal)request.getSessionInternal().getPrincipal();
  }
  return null;
}
