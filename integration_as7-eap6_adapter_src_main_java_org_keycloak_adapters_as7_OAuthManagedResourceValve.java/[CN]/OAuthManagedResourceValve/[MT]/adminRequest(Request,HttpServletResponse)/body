{
  String token=request.getParameter("token");
  if (token == null) {
    log.warn("admin request failed, no token");
    response.sendError(403,"no token");
    return;
  }
  JWSInput input=new JWSInput(token);
  boolean verified=false;
  try {
    verified=RSAProvider.verify(input,resourceMetadata.getRealmKey());
  }
 catch (  Exception ignore) {
  }
  if (!verified) {
    log.warn("admin request failed, unable to verify token");
    response.sendError(403,"verification failed");
    return;
  }
  String action=request.getParameter("action");
  if (LogoutAction.LOGOUT_ACTION.equals(action)) {
    remoteLogout(input,response);
  }
 else {
    log.warn("admin request failed, unknown action");
    response.sendError(403,"Unknown action");
  }
}
