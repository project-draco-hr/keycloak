{
  try {
    if (bearer(false,request,response))     return true;
 else     if (checkLoggedIn(request,response)) {
      if (request.getSessionInternal().getNote(Constants.FORM_REQUEST_NOTE) != null) {
        if (restoreRequest(request,request.getSessionInternal())) {
          log.debug("restoreRequest");
          return (true);
        }
 else {
          log.debug("Restore of original request failed");
          response.sendError(HttpServletResponse.SC_BAD_REQUEST);
          return (false);
        }
      }
 else {
        return true;
      }
    }
    oauth(request,response);
  }
 catch (  LoginException e) {
  }
  return false;
}
