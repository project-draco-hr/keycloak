{
  ManagedResourceConfigLoader managedResourceConfigLoader=new ManagedResourceConfigLoader(context);
  managedResourceConfigLoader.init(true);
  resourceMetadata=managedResourceConfigLoader.getResourceMetadata();
  remoteSkeletonKeyConfig=managedResourceConfigLoader.getRemoteSkeletonKeyConfig();
  realmConfiguration=new RealmConfiguration();
  String authUrl=remoteSkeletonKeyConfig.getAuthUrl();
  if (authUrl == null) {
    throw new RuntimeException("You must specify auth-url");
  }
  String tokenUrl=remoteSkeletonKeyConfig.getCodeUrl();
  if (tokenUrl == null) {
    throw new RuntimeException("You mut specify code-url");
  }
  realmConfiguration.setMetadata(resourceMetadata);
  realmConfiguration.setSslRequired(!remoteSkeletonKeyConfig.isSslNotRequired());
  for (  Map.Entry<String,String> entry : managedResourceConfigLoader.getRemoteSkeletonKeyConfig().getCredentials().entrySet()) {
    realmConfiguration.getResourceCredentials().param(entry.getKey(),entry.getValue());
  }
  ResteasyClient client=managedResourceConfigLoader.getClient();
  realmConfiguration.setClient(client);
  realmConfiguration.setAuthUrl(UriBuilder.fromUri(authUrl).queryParam("client_id",resourceMetadata.getResourceName()));
  realmConfiguration.setCodeUrl(client.target(tokenUrl));
}
