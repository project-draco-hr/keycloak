{
  log.debug("logoutUser: " + user);
  UserSessions sessions=null;
synchronized (userSessionMap) {
    sessions=userSessionMap.remove(user);
  }
  if (sessions == null) {
    log.debug("no session for user: " + user);
    return;
  }
  log.debug("found session for user");
  for (  Session session : sessions.getSessions().values()) {
    session.setPrincipal(null);
    session.setAuthType(null);
    session.getSession().invalidate();
  }
}
