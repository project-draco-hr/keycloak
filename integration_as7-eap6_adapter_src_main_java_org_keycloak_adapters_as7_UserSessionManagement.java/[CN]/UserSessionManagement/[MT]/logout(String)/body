{
  log.debug("logoutUser: " + user);
  Map<String,Session> map=userSessionMap.remove(user);
  if (map == null) {
    log.debug("no session for user: " + user);
    return;
  }
  log.debug("found session for user");
synchronized (map) {
    for (    Session session : map.values()) {
      log.debug("invalidating session for user: " + user);
      session.setPrincipal(null);
      session.setAuthType(null);
      session.getSession().invalidate();
    }
  }
}
