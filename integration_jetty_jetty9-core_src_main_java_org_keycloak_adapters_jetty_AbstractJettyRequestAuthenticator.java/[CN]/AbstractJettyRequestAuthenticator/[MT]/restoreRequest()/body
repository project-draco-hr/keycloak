{
  HttpSession session=request.getSession(false);
  if (session == null)   return;
synchronized (session) {
    String j_uri=(String)session.getAttribute(FormAuthenticator.__J_URI);
    if (j_uri != null) {
      StringBuffer buf=request.getRequestURL();
      if (request.getQueryString() != null)       buf.append("?").append(request.getQueryString());
      MultiMap<String> j_post=(MultiMap<String>)session.getAttribute(FormAuthenticator.__J_POST);
      if (j_post != null) {
        Request base_request=HttpChannel.getCurrentHttpChannel().getRequest();
        restoreFormParameters(j_post,base_request);
      }
      session.removeAttribute(FormAuthenticator.__J_URI);
      session.removeAttribute(FormAuthenticator.__J_METHOD);
      session.removeAttribute(FormAuthenticator.__J_POST);
    }
  }
}
