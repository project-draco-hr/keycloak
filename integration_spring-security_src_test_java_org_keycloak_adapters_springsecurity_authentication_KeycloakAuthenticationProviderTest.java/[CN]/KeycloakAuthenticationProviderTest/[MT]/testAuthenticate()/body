{
  Authentication result=provider.authenticate(token);
  assertNotNull(result);
  assertEquals(roles.size(),result.getAuthorities().size());
  assertTrue(result.isAuthenticated());
  assertNotNull(result.getPrincipal());
  assertNotNull(result.getCredentials());
  assertNotNull(result.getDetails());
}
