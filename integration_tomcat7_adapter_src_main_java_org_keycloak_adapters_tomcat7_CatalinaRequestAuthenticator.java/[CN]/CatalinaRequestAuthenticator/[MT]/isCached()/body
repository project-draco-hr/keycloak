{
  if (request.getSessionInternal(false) == null || request.getSessionInternal().getPrincipal() == null)   return false;
  log.finer("remote logged in already");
  GenericPrincipal principal=(GenericPrincipal)request.getSessionInternal().getPrincipal();
  request.setUserPrincipal(principal);
  request.setAuthType("KEYCLOAK");
  Session session=request.getSessionInternal();
  if (session != null) {
    RefreshableKeycloakSecurityContext securityContext=(RefreshableKeycloakSecurityContext)session.getNote(KeycloakSecurityContext.class.getName());
    if (securityContext != null) {
      securityContext.setDeployment(deployment);
      request.setAttribute(KeycloakSecurityContext.class.getName(),securityContext);
    }
  }
  restoreRequest();
  return true;
}
