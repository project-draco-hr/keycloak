{
  KeycloakSecurityContext ksc=(KeycloakSecurityContext)request.getAttribute(KeycloakSecurityContext.class.getName());
  if (ksc != null) {
    request.removeAttribute(KeycloakSecurityContext.class.getName());
    Session session=request.getSessionInternal(false);
    if (session != null) {
      session.removeNote(KeycloakSecurityContext.class.getName());
      try {
        CatalinaHttpFacade facade=new CatalinaHttpFacade(request,null);
        ServerRequest.invokeLogout(deploymentContext.resolveDeployment(facade),ksc.getToken().getSessionState());
      }
 catch (      Exception e) {
        log.severe("failed to invoke remote logout. " + e.getMessage());
      }
    }
  }
  super.logout(request);
}
