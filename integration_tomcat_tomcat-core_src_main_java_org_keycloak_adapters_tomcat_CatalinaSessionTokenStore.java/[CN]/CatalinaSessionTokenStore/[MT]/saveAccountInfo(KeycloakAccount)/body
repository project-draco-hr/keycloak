{
  RefreshableKeycloakSecurityContext securityContext=(RefreshableKeycloakSecurityContext)account.getKeycloakSecurityContext();
  Set<String> roles=account.getRoles();
  GenericPrincipal principal=new CatalinaSecurityContextHelper().createPrincipal(request.getContext().getRealm(),account.getPrincipal(),roles,securityContext);
  Session session=request.getSessionInternal(true);
  session.setPrincipal(principal);
  session.setAuthType("OAUTH");
  session.setNote(KeycloakSecurityContext.class.getName(),securityContext);
  String username=securityContext.getToken().getSubject();
  log.fine("userSessionManagement.login: " + username);
  this.sessionManagement.login(session);
}
