{
  AuthChallenge challenge=exchange.getAttachment(KEYCLOAK_CHALLENGE_ATTACHMENT_KEY);
  if (challenge != null) {
    if (challenge.errorPage() && errorPage != null) {
      Integer code=servePage(exchange,errorPage);
      return new ChallengeResult(true,code);
    }
    UndertowHttpFacade facade=new OIDCUndertowHttpFacade(exchange);
    if (challenge.challenge(facade)) {
      return new ChallengeResult(true,exchange.getResponseCode());
    }
  }
  return new ChallengeResult(false);
}
