{
  if (account == null) {
    log.debugv("Not logged in, sending back 401: {0}",exchange.getRequestURI());
    exchange.setResponseCode(StatusCodes.UNAUTHORIZED);
    exchange.endExchange();
    return true;
  }
  if (!deployment.isExposeToken()) {
    exchange.setResponseCode(StatusCodes.OK);
    exchange.endExchange();
    return true;
  }
  if (!deployment.isCors() && exchange.getRequestHeaders().getFirst(Headers.ORIGIN) != null) {
    exchange.setResponseCode(StatusCodes.OK);
    exchange.endExchange();
    return true;
  }
  return false;
}
