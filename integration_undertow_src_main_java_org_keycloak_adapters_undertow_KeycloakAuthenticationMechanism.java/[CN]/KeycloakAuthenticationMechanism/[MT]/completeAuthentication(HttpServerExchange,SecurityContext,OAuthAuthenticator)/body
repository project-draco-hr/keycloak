{
  final KeycloakPrincipal principal=new KeycloakPrincipal(oauth.getToken().getSubject(),null);
  RefreshableKeycloakSession session=new RefreshableKeycloakSession(oauth.getTokenString(),oauth.getToken(),oauth.getIdTokenString(),oauth.getIdToken(),resourceMetadata,realmConfig,oauth.getRefreshToken());
  KeycloakUndertowAccount account=new KeycloakUndertowAccount(principal,session,adapterConfig,resourceMetadata);
  securityContext.authenticationComplete(account,"KEYCLOAK",true);
  login(exchange,account);
}
