{
  Set<String> roles=null;
  if (session.getDeployment().isUseResourceRoleMappings()) {
    if (log.isTraceEnabled()) {
      log.trace("useResourceRoleMappings");
    }
    AccessToken.Access access=accessToken.getResourceAccess(session.getDeployment().getResourceName());
    if (access != null)     roles=access.getRoles();
  }
 else {
    if (log.isTraceEnabled()) {
      log.trace("use realm role mappings");
    }
    AccessToken.Access access=accessToken.getRealmAccess();
    if (access != null)     roles=access.getRoles();
  }
  if (roles == null)   roles=Collections.emptySet();
  this.accountRoles=roles;
}
