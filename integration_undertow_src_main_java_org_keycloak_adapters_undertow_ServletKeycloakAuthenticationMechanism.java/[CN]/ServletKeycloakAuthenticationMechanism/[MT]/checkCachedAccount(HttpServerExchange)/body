{
  final ServletRequestContext servletRequestContext=exchange.getAttachment(ServletRequestContext.ATTACHMENT_KEY);
  HttpServletRequest req=(HttpServletRequest)servletRequestContext.getServletRequest();
  HttpSession session=req.getSession(false);
  if (session == null) {
    log.info("session was null, returning null");
    return null;
  }
  KeycloakUndertowAccount account=(KeycloakUndertowAccount)session.getAttribute(KeycloakUndertowAccount.class.getName());
  if (account == null) {
    log.info("Account was not in session, returning null");
    return null;
  }
  if (account.isActive(realmConfig,adapterConfig))   return account;
  log.info("Account was not active, returning null");
  session.setAttribute(KeycloakUndertowAccount.class.getName(),null);
  return null;
}
