{
  String algorithm=credential.getAlgorithm() != null ? credential.getAlgorithm() : passwordPolicy.getHashAlgorithm();
  PasswordHashProvider provider=session.getProvider(PasswordHashProvider.class,algorithm);
  return provider.verify(password,credential);
}
