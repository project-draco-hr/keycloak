{
  String algorithm=credential.getAlgorithm() != null ? credential.getAlgorithm() : realm.getPasswordPolicy().getHashAlgorithm();
  PasswordHashProvider provider=session.getProvider(PasswordHashProvider.class,algorithm);
  return provider.verify(password,credential);
}
