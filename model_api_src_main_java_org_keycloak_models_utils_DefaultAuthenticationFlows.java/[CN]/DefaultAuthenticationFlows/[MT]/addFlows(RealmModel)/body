{
  AuthenticatorModel model=new AuthenticatorModel();
  model.setProviderId("auth-cookie");
  model.setAlias("Cookie");
  AuthenticatorModel cookieAuth=realm.addAuthenticator(model);
  model=new AuthenticatorModel();
  model.setProviderId("auth-login-form-otp");
  model.setAlias("Login Form OTP");
  AuthenticatorModel loginFormOtp=realm.addAuthenticator(model);
  model=new AuthenticatorModel();
  model.setProviderId("auth-login-form-password");
  model.setAlias("Login Form Password");
  AuthenticatorModel password=realm.addAuthenticator(model);
  model=new AuthenticatorModel();
  model.setProviderId("auth-login-form-username");
  model.setAlias("Login Form Username");
  AuthenticatorModel username=realm.addAuthenticator(model);
  model=new AuthenticatorModel();
  model.setProviderId("auth-otp-form");
  model.setAlias("Single OTP Form");
  AuthenticatorModel otp=realm.addAuthenticator(model);
  AuthenticationFlowModel browser=new AuthenticationFlowModel();
  browser.setAlias("browser");
  browser.setDescription("browser based authentication");
  browser=realm.addAuthenticationFlow(browser);
  AuthenticationExecutionModel execution=new AuthenticationExecutionModel();
  execution.setParentFlow(browser.getId());
  execution.setRequirement(AuthenticationExecutionModel.Requirement.ALTERNATIVE);
  execution.setAuthenticator(cookieAuth.getId());
  execution.setPriority(0);
  execution.setUserSetupAllowed(false);
  execution.setAutheticatorFlow(false);
  realm.addAuthenticatorExecution(execution);
  AuthenticationFlowModel forms=new AuthenticationFlowModel();
  forms.setAlias("forms");
  forms.setDescription("Username, password, otp and other auth forms.");
  forms=realm.addAuthenticationFlow(forms);
  execution=new AuthenticationExecutionModel();
  execution.setParentFlow(browser.getId());
  execution.setRequirement(AuthenticationExecutionModel.Requirement.ALTERNATIVE);
  execution.setAuthenticator(forms.getId());
  execution.setPriority(1);
  execution.setUserSetupAllowed(false);
  execution.setAutheticatorFlow(true);
  realm.addAuthenticatorExecution(execution);
  execution=new AuthenticationExecutionModel();
  execution.setParentFlow(forms.getId());
  execution.setRequirement(AuthenticationExecutionModel.Requirement.REQUIRED);
  execution.setAuthenticator(username.getId());
  execution.setPriority(10);
  execution.setUserSetupAllowed(false);
  execution.setAutheticatorFlow(false);
  realm.addAuthenticatorExecution(execution);
  execution=new AuthenticationExecutionModel();
  execution.setParentFlow(forms.getId());
  execution.setRequirement(AuthenticationExecutionModel.Requirement.REQUIRED);
  execution.setAuthenticator(password.getId());
  execution.setPriority(11);
  execution.setUserSetupAllowed(false);
  execution.setAutheticatorFlow(false);
  realm.addAuthenticatorExecution(execution);
  execution=new AuthenticationExecutionModel();
  execution.setParentFlow(forms.getId());
  execution.setRequirement(AuthenticationExecutionModel.Requirement.OPTIONAL);
  execution.setAuthenticator(otp.getId());
  execution.setPriority(12);
  execution.setUserSetupAllowed(true);
  execution.setAutheticatorFlow(false);
  realm.addAuthenticatorExecution(execution);
}
