{
  String allowKerberosCfg=model.getConfig().get(KerberosConstants.ALLOW_KERBEROS_AUTHENTICATION);
  if (Boolean.valueOf(allowKerberosCfg)) {
    boolean found=false;
    List<RequiredCredentialModel> currentCreds=realm.getRequiredCredentials();
    for (    RequiredCredentialModel cred : currentCreds) {
      if (cred.getType().equals(UserCredentialModel.KERBEROS)) {
        found=true;
      }
    }
    if (!found) {
      realm.addRequiredCredential(UserCredentialModel.KERBEROS);
      return true;
    }
  }
  return false;
}
