{
  if (rep.getProtocolMappers() != null) {
    Set<ProtocolMapperModel> mappers=newRealm.getProtocolMappers();
    for (    ProtocolMapperRepresentation representation : rep.getProtocolMappers()) {
      ProtocolMapperModel existing=newRealm.getProtocolMapperByName(representation.getProtocol(),representation.getName());
      if (existing == null) {
        newRealm.addProtocolMapper(toModel(representation));
      }
 else {
        ProtocolMapperModel mapping=toModel(representation);
        mapping.setId(existing.getId());
        newRealm.updateProtocolMapper(mapping);
      }
    }
  }
}
