{
  if (name == null)   throw new NullPointerException("name == null");
  if (id == null)   throw new NullPointerException("id == null");
  if (getApplicationNameMap().containsKey(name)) {
    throw new ModelDuplicateException("Application named '" + name + "' already exists.");
  }
  ApplicationEntity appEntity=new ApplicationEntity();
  appEntity.setId(id);
  appEntity.setName(name);
  appEntity.setRealmId(getId());
  appEntity.setEnabled(true);
  ClientEntity clientEntity=new ClientEntity();
  clientEntity.setId(id);
  clientEntity.setName(name);
  clientEntity.setRealmId(getId());
  clientEntity.setEnabled(true);
  final ApplicationModel app=new ApplicationAdapter(session,this,appEntity,clientEntity,inMemoryModel);
  session.getKeycloakSessionFactory().publish(new ApplicationCreationEvent(){
    @Override public ApplicationModel getCreatedApplication(){
      return app;
    }
    @Override public ClientModel getCreatedClient(){
      return app;
    }
  }
);
  allApps.put(id,app);
  return app;
}
