{
  List<CredentialEntity> credentials=new ArrayList<CredentialEntity>(user.getCredentials());
  List<UserCredentialValueModel> result=new ArrayList<UserCredentialValueModel>();
  for (  CredentialEntity credEntity : credentials) {
    UserCredentialValueModel credModel=new UserCredentialValueModel();
    credModel.setType(credEntity.getType());
    credModel.setDevice(credEntity.getDevice());
    credModel.setCreatedDate(credEntity.getCreatedDate());
    credModel.setValue(credEntity.getValue());
    credModel.setSalt(credEntity.getSalt());
    credModel.setHashIterations(credEntity.getHashIterations());
    if (UserCredentialModel.isOtp(credEntity.getType())) {
      credModel.setCounter(credEntity.getCounter());
      if (credEntity.getAlgorithm() == null) {
        credModel.setAlgorithm(realm.getOTPPolicy().getAlgorithm());
      }
 else {
        credModel.setAlgorithm(credEntity.getAlgorithm());
      }
      if (credEntity.getDigits() == 0) {
        credModel.setDigits(realm.getOTPPolicy().getDigits());
      }
 else {
        credModel.setDigits(credEntity.getDigits());
      }
      if (credEntity.getPeriod() == 0) {
        credModel.setPeriod(realm.getOTPPolicy().getPeriod());
      }
 else {
        credModel.setPeriod(credEntity.getPeriod());
      }
    }
    result.add(credModel);
  }
  return result;
}
