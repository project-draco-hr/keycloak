{
  if (!validatePassword(user,password))   return false;
  for (  UserCredentialValueModel cred : user.getCredentialsDirectly()) {
    if (cred.getType().equals(UserCredentialModel.TOTP)) {
      return new TimeBasedOTP().validate(token,cred.getValue().getBytes());
    }
  }
  return false;
}
