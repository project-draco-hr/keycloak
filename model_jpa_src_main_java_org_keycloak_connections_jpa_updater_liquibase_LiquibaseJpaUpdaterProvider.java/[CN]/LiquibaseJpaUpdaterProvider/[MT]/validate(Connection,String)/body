{
  logger.debug("Validating if database is updated");
  try {
    Liquibase liquibase=getLiquibase(connection,defaultSchema);
    List<ChangeSet> changeSets=liquibase.listUnrunChangeSets((Contexts)null);
    if (!changeSets.isEmpty()) {
      List<RanChangeSet> ranChangeSets=liquibase.getDatabase().getRanChangeSetList();
      String errorMessage=String.format("Failed to validate database schema. Schema needs updating database from %s to %s. Please change databaseSchema to 'update' or use other database",ranChangeSets.get(ranChangeSets.size() - 1).getId(),changeSets.get(changeSets.size() - 1).getId());
      throw new RuntimeException(errorMessage);
    }
 else {
      logger.debug("Validation passed. Database is up-to-date");
    }
  }
 catch (  LiquibaseException e) {
    throw new RuntimeException("Failed to validate database",e);
  }
}
