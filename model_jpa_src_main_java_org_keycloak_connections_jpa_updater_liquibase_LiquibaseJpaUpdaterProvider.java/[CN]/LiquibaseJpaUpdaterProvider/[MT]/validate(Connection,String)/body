{
  logger.debug("Validating if database is updated");
  try {
    Liquibase liquibase=getLiquibaseForKeycloakUpdate(connection,defaultSchema);
    validateChangeSet(liquibase,liquibase.getChangeLogFile());
    Set<JpaEntityProvider> jpaProviders=session.getAllProviders(JpaEntityProvider.class);
    for (    JpaEntityProvider jpaProvider : jpaProviders) {
      String customChangelog=jpaProvider.getChangelogLocation();
      if (customChangelog != null) {
        String factoryId=jpaProvider.getFactoryId();
        String changelogTableName=JpaUtils.getCustomChangelogTableName(factoryId);
        liquibase=getLiquibaseForCustomProviderUpdate(connection,defaultSchema,customChangelog,jpaProvider.getClass().getClassLoader(),changelogTableName);
        validateChangeSet(liquibase,liquibase.getChangeLogFile());
      }
    }
  }
 catch (  LiquibaseException e) {
    throw new RuntimeException("Failed to validate database",e);
  }
}
