{
  IdentityProviderEntity entity=new IdentityProviderEntity();
  entity.setInternalId(KeycloakModelUtils.generateId());
  entity.setId(identityProvider.getId());
  entity.setProviderId(identityProvider.getProviderId());
  entity.setName(identityProvider.getName());
  entity.setEnabled(identityProvider.isEnabled());
  entity.setStoreToken(identityProvider.isStoreToken());
  entity.setUpdateProfileFirstLogin(identityProvider.isUpdateProfileFirstLogin());
  entity.setAuthenticateByDefault(identityProvider.isAuthenticateByDefault());
  entity.setConfig(identityProvider.getConfig());
  realm.addIdentityProvider(entity);
  em.persist(entity);
  em.flush();
}
