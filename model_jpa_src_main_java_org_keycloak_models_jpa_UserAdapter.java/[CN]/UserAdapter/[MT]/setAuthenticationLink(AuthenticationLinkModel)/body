{
  AuthenticationLinkEntity entity=new AuthenticationLinkEntity();
  entity.setAuthProvider(authenticationLink.getAuthProvider());
  entity.setAuthUserId(authenticationLink.getAuthUserId());
  entity.setUser(user);
  if (user.getAuthenticationLink() != null) {
    AuthenticationLinkEntity old=user.getAuthenticationLink();
    old.setUser(null);
    em.remove(old);
    user.setAuthenticationLink(null);
    em.flush();
  }
  em.persist(entity);
  user.setAuthenticationLink(entity);
  em.flush();
}
