{
  this.database=database;
  mapperRegistry=new MapperRegistry();
  for (  Class<?> simpleMapperClass : SIMPLE_TYPES) {
    SimpleMapper mapper=new SimpleMapper(simpleMapperClass);
    mapperRegistry.addAppObjectMapper(mapper);
    mapperRegistry.addDBObjectMapper(mapper);
  }
  mapperRegistry.addAppObjectMapper(new ListMapper(mapperRegistry,ArrayList.class));
  mapperRegistry.addAppObjectMapper(new ListMapper(mapperRegistry,List.class));
  mapperRegistry.addDBObjectMapper(new BasicDBListMapper(mapperRegistry));
  mapperRegistry.addAppObjectMapper(new MapMapper(HashMap.class));
  mapperRegistry.addAppObjectMapper(new MapMapper(Map.class));
  mapperRegistry.addDBObjectMapper(new BasicDBObjectToMapMapper());
  mapperRegistry.addAppObjectMapper(new EnumToStringMapper());
  mapperRegistry.addDBObjectMapper(new StringToEnumMapper());
  for (  Class<?> type : managedEntityTypes) {
    getEntityInfo(type);
    mapperRegistry.addAppObjectMapper(new MongoEntityMapper(this,mapperRegistry,type));
    mapperRegistry.addDBObjectMapper(new BasicDBObjectMapper(this,mapperRegistry,type));
  }
  if (clearCollectionsOnStartup) {
    clearManagedCollections(managedEntityTypes);
  }
  initManagedCollections(managedEntityTypes);
}
