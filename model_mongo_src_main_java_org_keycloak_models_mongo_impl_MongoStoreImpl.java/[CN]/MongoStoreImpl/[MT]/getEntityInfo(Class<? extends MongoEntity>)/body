{
  EntityInfo entityInfo=entityInfoCache.get(entityClass);
  if (entityInfo == null) {
    List<Property<Object>> properties=PropertyQueries.createQuery(entityClass).addCriteria(new AnnotatedPropertyCriteria(MongoField.class)).getResultList();
    MongoCollection classAnnotation=entityClass.getAnnotation(MongoCollection.class);
    String dbCollectionName=classAnnotation == null ? null : classAnnotation.collectionName();
    entityInfo=new EntityInfo(entityClass,dbCollectionName,properties);
    EntityInfo existing=entityInfoCache.putIfAbsent(entityClass,entityInfo);
    if (existing != null) {
      entityInfo=existing;
    }
  }
  return entityInfo;
}
