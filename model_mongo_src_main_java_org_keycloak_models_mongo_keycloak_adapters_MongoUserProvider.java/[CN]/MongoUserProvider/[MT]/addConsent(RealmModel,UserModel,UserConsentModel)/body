{
  String clientId=consent.getClient().getId();
  if (getConsentEntityByClientId(user,clientId) != null) {
    throw new ModelDuplicateException("Consent already exists for client [" + clientId + "] and user ["+ user.getId()+ "]");
  }
  long currentTime=Time.currentTimeMillis();
  MongoUserConsentEntity consentEntity=new MongoUserConsentEntity();
  consentEntity.setUserId(user.getId());
  consentEntity.setClientId(clientId);
  consentEntity.setCreatedDate(currentTime);
  consentEntity.setLastUpdatedDate(currentTime);
  fillEntityFromModel(consent,consentEntity);
  getMongoStore().insertEntity(consentEntity,invocationContext);
}
