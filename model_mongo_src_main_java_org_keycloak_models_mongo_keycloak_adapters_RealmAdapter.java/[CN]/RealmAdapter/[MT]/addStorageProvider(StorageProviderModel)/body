{
  KeycloakModelUtils.ensureUniqueDisplayName(model.getDisplayName(),null,getStorageProviders());
  StorageProviderEntity entity=new StorageProviderEntity();
  entity.setId(KeycloakModelUtils.generateId());
  entity.setPriority(model.getPriority());
  entity.setProviderName(model.getProviderName());
  entity.setConfig(model.getConfig());
  String displayName=model.getDisplayName();
  if (displayName == null) {
    displayName=entity.getId();
  }
  entity.setDisplayName(displayName);
  realm.getStorageProviders().add(entity);
  updateRealm();
  StorageProviderModel providerModel=new StorageProviderModel(entity.getId(),model.getProviderName(),model.getConfig(),model.getPriority(),displayName);
  return providerModel;
}
