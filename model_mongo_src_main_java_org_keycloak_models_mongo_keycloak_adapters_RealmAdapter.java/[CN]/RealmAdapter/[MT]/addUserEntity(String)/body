{
  if (getUser(username) != null) {
    throw new IllegalArgumentException("User " + username + " already exists");
  }
  UserEntity userEntity=new UserEntity();
  userEntity.setLoginName(username);
  userEntity.setEnabled(true);
  userEntity.setRealmId(getId());
  getMongoStore().insertEntity(userEntity,invocationContext);
  return new UserAdapter(userEntity,invocationContext);
}
