{
  device=getDevice(device);
  NoSQLQuery query=noSQL.createQueryBuilder().andCondition("userId",user.getId()).andCondition("device",device).build();
  OTPData otpData=noSQL.loadSingleObject(OTPData.class,query);
  if (otpData == null) {
    otpData=new OTPData();
  }
  otpData.setSecretKey(secret);
  otpData.setDevice(device);
  if (effectiveDate != null) {
    otpData.setEffectiveDate(effectiveDate);
  }
  otpData.setExpiryDate(expiryDate);
  otpData.setUserId(user.getId());
  noSQL.saveObject(otpData);
}
