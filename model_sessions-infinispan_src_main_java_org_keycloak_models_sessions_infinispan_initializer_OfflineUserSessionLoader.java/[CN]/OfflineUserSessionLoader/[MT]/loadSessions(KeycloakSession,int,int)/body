{
  UserSessionPersisterProvider persister=session.getProvider(UserSessionPersisterProvider.class);
  List<UserSessionModel> sessions=persister.loadUserSessions(first,max,true);
  int currentTime=Time.currentTime();
  for (  UserSessionModel persistentSession : sessions) {
    persistentSession.setLastSessionRefresh(currentTime);
    persister.updateUserSession(persistentSession,true);
    UserSessionModel offlineUserSession=session.sessions().createOfflineUserSession(persistentSession);
    for (    ClientSessionModel persistentClientSession : persistentSession.getClientSessions()) {
      ClientSessionModel offlineClientSession=session.sessions().createOfflineClientSession(persistentClientSession);
      offlineClientSession.setUserSession(offlineUserSession);
    }
  }
  return true;
}
