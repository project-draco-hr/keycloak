{
  UsernameLoginFailureKey key=new UsernameLoginFailureKey(username,realm.getId());
  UsernameLoginFailureEntity entity=new UsernameLoginFailureEntity(username,realm.getId());
  if (loginFailures.putIfAbsent(key,entity) != null) {
    throw new ModelDuplicateException();
  }
  return new UsernameLoginFailureAdapter(entity);
}
