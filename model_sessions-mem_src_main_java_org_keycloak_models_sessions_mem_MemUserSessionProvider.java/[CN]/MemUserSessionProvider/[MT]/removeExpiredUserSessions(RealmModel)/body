{
  Iterator<UserSessionEntity> itr=sessions.values().iterator();
  while (itr.hasNext()) {
    UserSessionEntity s=itr.next();
    if (s.getRealm().equals(realm.getId()) && (s.getLastSessionRefresh() < Time.currentTime() - realm.getSsoSessionIdleTimeout() || s.getStarted() < Time.currentTime() - realm.getSsoSessionMaxLifespan())) {
      itr.remove();
    }
  }
}
