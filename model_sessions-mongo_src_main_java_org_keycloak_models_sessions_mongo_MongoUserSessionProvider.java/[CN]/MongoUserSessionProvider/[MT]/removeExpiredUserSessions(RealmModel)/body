{
  int currentTime=Time.currentTime();
  DBObject query=new QueryBuilder().and("realmId").is(realm.getId()).and("started").lessThan(currentTime - realm.getSsoSessionMaxLifespan()).get();
  mongoStore.removeEntities(MongoUserSessionEntity.class,query,invocationContext);
  query=new QueryBuilder().and("realmId").is(realm.getId()).and("lastSessionRefresh").lessThan(currentTime - realm.getSsoSessionIdleTimeout()).get();
  mongoStore.removeEntities(MongoUserSessionEntity.class,query,invocationContext);
  query=new QueryBuilder().and("sessionId").is(null).and("realmId").is(realm.getId()).and("timestamp").lessThan(currentTime - RealmInfoUtil.getDettachedClientSessionLifespan(realm)).get();
  mongoStore.removeEntities(MongoClientSessionEntity.class,query,invocationContext);
}
