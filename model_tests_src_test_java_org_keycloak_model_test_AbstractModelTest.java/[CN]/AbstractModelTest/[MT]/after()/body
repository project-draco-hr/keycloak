{
  identitySession.getTransaction().commit();
  providerSession.close();
  providerSession=providerSessionFactory.createSession();
  identitySession=providerSession.getProvider(KeycloakSession.class);
  try {
    identitySession.getTransaction().begin();
    RealmManager rm=new RealmManager(identitySession);
    for (    RealmModel realm : identitySession.getRealms()) {
      if (!realm.getName().equals(Config.getAdminRealm())) {
        rm.removeRealm(realm);
      }
    }
    identitySession.getTransaction().commit();
  }
  finally {
    providerSession.close();
  }
}
