{
  UserCredentialEntity entity=getCredentialEntity(credentials.getType());
  if (entity == null) {
    entity=new UserCredentialEntity(user,credentials.getType());
    user.getCredentials().add(entity);
  }
  entity.setValue(credentials.getValue());
  entity.setSalt(credentials.getSalt());
  entity.setHashIterations(credentials.getHashIterations());
  entity.setDevice(credentials.getDevice());
}
