{
  if (account != null) {
    IDToken idToken=account.getKeycloakSecurityContext().getIdToken();
    if (idToken.getSubject() != null) {
      exchange.getRequestHeaders().put(KEYCLOAK_SUBJECT,idToken.getSubject());
    }
    if (idToken.getPreferredUsername() != null) {
      exchange.getRequestHeaders().put(KEYCLOAK_USERNAME,idToken.getPreferredUsername());
    }
    if (idToken.getEmail() != null) {
      exchange.getRequestHeaders().put(KEYCLOAK_EMAIL,idToken.getEmail());
    }
    if (idToken.getName() != null) {
      exchange.getRequestHeaders().put(KEYCLOAK_NAME,idToken.getName());
    }
  }
  next.handleRequest(exchange);
}
