{
  KeyManager[] keyManagers;
  KeyManagerFactory keyManagerFactory=KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
  keyManagerFactory.init(keyStore,password.toCharArray());
  keyManagers=keyManagerFactory.getKeyManagers();
  TrustManager[] trustManagers=null;
  if (trustStore != null) {
    TrustManagerFactory trustManagerFactory=TrustManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
    trustManagerFactory.init(trustStore);
    trustManagers=trustManagerFactory.getTrustManagers();
  }
  SSLContext sslContext;
  sslContext=SSLContext.getInstance("TLS");
  sslContext.init(keyManagers,trustManagers,null);
  return sslContext;
}
