{
  ClientModel client=clientSession.getClient();
  if (!(client instanceof ApplicationModel))   return;
  ApplicationModel app=(ApplicationModel)client;
  String logoutUrl=getLogoutServiceUrl(uriInfo,client,SAML_POST_BINDING);
  if (logoutUrl == null) {
    logger.warnv("Can't do backchannel logout. No SingleLogoutService POST Binding registered for client: {1}",client.getClientId());
    return;
  }
  SAML2LogoutRequestBuilder logoutBuilder=createLogoutRequest(clientSession,client);
  String logoutRequestString=null;
  try {
    logoutRequestString=logoutBuilder.postBinding().encoded();
  }
 catch (  Exception e) {
    logger.warn("failed to send saml logout",e);
    return;
  }
  ApacheHttpClient4Executor executor=ResourceAdminManager.createExecutor();
  try {
    ClientRequest request=executor.createRequest(logoutUrl);
    request.formParameter(GeneralConstants.SAML_REQUEST_KEY,logoutRequestString);
    request.formParameter(SAML2LogOutHandler.BACK_CHANNEL_LOGOUT,SAML2LogOutHandler.BACK_CHANNEL_LOGOUT);
    ClientResponse response=null;
    try {
      response=request.post();
      response.releaseConnection();
      if (response.getStatus() == 302 && !logoutUrl.endsWith("/")) {
        String redirect=(String)response.getHeaders().getFirst(HttpHeaders.LOCATION);
        String withSlash=logoutUrl + "/";
        if (withSlash.equals(redirect)) {
          request=executor.createRequest(withSlash);
          request.formParameter(GeneralConstants.SAML_REQUEST_KEY,logoutRequestString);
          request.formParameter(SAML2LogOutHandler.BACK_CHANNEL_LOGOUT,SAML2LogOutHandler.BACK_CHANNEL_LOGOUT);
          response=request.post();
          response.releaseConnection();
        }
      }
    }
 catch (    Exception e) {
      logger.warn("failed to send saml logout",e);
    }
  }
  finally {
    executor.getHttpClient().getConnectionManager().shutdown();
  }
}
