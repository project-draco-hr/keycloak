{
  if (!"true".equals(client.getAttribute(SamlProtocol.SAML_CLIENT_SIGNATURE_ATTRIBUTE))) {
    return;
  }
  SAML2Signature saml2Signature=new SAML2Signature();
  PublicKey publicKey=getSignatureValidationKey(client);
  try {
    if (!saml2Signature.validate(document,publicKey)) {
      throw new VerificationException("Invalid signature on document");
    }
  }
 catch (  ProcessingException e) {
    throw new VerificationException("Error validating signature",e);
  }
}
