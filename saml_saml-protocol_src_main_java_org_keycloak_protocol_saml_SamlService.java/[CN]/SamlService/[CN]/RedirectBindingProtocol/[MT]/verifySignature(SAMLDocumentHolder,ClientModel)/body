{
  if (!"true".equals(client.getAttribute("saml.client.signature"))) {
    return;
  }
  MultivaluedMap<String,String> encodedParams=uriInfo.getQueryParameters(false);
  String request=encodedParams.getFirst(GeneralConstants.SAML_REQUEST_KEY);
  String algorithm=encodedParams.getFirst(GeneralConstants.SAML_SIG_ALG_REQUEST_KEY);
  String signature=encodedParams.getFirst(GeneralConstants.SAML_SIGNATURE_REQUEST_KEY);
  if (request == null)   throw new VerificationException("SAMLRequest as null");
  if (algorithm == null)   throw new VerificationException("SigAlg as null");
  if (signature == null)   throw new VerificationException("Signature as null");
  PublicKey publicKey=SamlProtocolUtils.getPublicKey(client);
  UriBuilder builder=UriBuilder.fromPath("/").queryParam(GeneralConstants.SAML_REQUEST_KEY,request);
  if (encodedParams.containsKey(GeneralConstants.RELAY_STATE)) {
    builder.queryParam(GeneralConstants.RELAY_STATE,encodedParams.getFirst(GeneralConstants.RELAY_STATE));
  }
  builder.queryParam(GeneralConstants.SAML_SIG_ALG_REQUEST_KEY,algorithm);
  String rawQuery=builder.build().getRawQuery();
  try {
    byte[] decodedSignature=RedirectBindingUtil.urlBase64Decode(signature);
    SignatureAlgorithm signatureAlgorithm=SamlProtocol.getSignatureAlgorithm(client);
    Signature validator=signatureAlgorithm.createSignature();
    validator.initVerify(publicKey);
    validator.update(rawQuery.getBytes("UTF-8"));
    if (!validator.verify(decodedSignature)) {
      throw new VerificationException("Invalid query param signature");
    }
  }
 catch (  Exception e) {
    throw new VerificationException(e);
  }
}
