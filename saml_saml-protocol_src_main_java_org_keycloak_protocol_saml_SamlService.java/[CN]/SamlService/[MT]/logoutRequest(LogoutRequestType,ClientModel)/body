{
  AuthenticationManager.AuthResult authResult=authManager.authenticateIdentityCookie(session,realm,uriInfo,clientConnection,headers,false);
  if (authResult != null) {
    logout(authResult.getSession());
  }
  String redirectUri=null;
  if (client instanceof ApplicationModel) {
    redirectUri=((ApplicationModel)client).getBaseUrl();
  }
  if (redirectUri != null) {
    String validatedRedirect=OpenIDConnectService.verifyRedirectUri(uriInfo,redirectUri,realm,client);
    ;
    if (validatedRedirect == null) {
      return Flows.forwardToSecurityFailurePage(session,realm,uriInfo,"Invalid redirect uri.");
    }
    return Response.status(302).location(UriBuilder.fromUri(validatedRedirect).build()).build();
  }
 else {
    return Response.ok().build();
  }
}
