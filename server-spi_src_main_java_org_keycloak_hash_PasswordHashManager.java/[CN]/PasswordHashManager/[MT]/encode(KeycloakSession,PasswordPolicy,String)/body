{
  PasswordHashProvider provider=session.getProvider(PasswordHashProvider.class,passwordPolicy.getHashAlgorithm());
  if (provider == null) {
    log.warnv("Could not find hash provider {0} from password policy, using default provider {1}",passwordPolicy.getHashAlgorithm(),HashAlgorithmPasswordPolicyProviderFactory.DEFAULT_VALUE);
    provider=session.getProvider(PasswordHashProvider.class,HashAlgorithmPasswordPolicyProviderFactory.DEFAULT_VALUE);
  }
  return provider.encode(rawPassword,passwordPolicy.getHashIterations());
}
