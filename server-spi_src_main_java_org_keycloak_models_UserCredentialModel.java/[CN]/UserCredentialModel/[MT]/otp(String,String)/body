{
  if (type.equals(HOTP))   return hotp(key);
  if (type.equals(TOTP))   return totp(key);
  throw new RuntimeException("Unknown OTP type");
}
