{
  UserCredentialValueModel passwordCred=null;
  for (  UserCredentialValueModel cred : user.getCredentialsDirectly()) {
    if (cred.getType().equals(UserCredentialModel.PASSWORD)) {
      passwordCred=cred;
    }
  }
  if (passwordCred == null)   return false;
  return validateHashedCredential(session,realm,user,password,passwordCred);
}
