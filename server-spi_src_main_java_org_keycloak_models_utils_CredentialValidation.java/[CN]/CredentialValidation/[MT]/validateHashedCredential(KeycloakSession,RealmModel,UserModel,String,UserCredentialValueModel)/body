{
  if (unhashedCredValue == null || unhashedCredValue.isEmpty()) {
    return false;
  }
  boolean validated=PasswordHashManager.verify(session,realm,unhashedCredValue,credential);
  if (validated) {
    if (realm.getPasswordPolicy().getHashIterations() != credential.getHashIterations()) {
      UserCredentialValueModel newCred=PasswordHashManager.encode(session,realm,unhashedCredValue);
      user.updateCredentialDirectly(newCred);
    }
  }
  return validated;
}
