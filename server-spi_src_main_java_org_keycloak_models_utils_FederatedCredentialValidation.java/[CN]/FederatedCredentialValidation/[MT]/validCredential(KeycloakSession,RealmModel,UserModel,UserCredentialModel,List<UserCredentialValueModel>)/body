{
  if (credential.getType().equals(UserCredentialModel.PASSWORD)) {
    if (!validPassword(session,realm,user,credential.getValue(),fedCreds.get(0))) {
      return false;
    }
  }
 else   if (credential.getType().equals(UserCredentialModel.PASSWORD_TOKEN)) {
    if (!validPasswordToken(realm,user,credential.getValue())) {
      return false;
    }
  }
 else   if (credential.getType().equals(UserCredentialModel.TOTP)) {
    if (!validTOTP(realm,user,credential.getValue(),fedCreds)) {
      return false;
    }
  }
 else   if (credential.getType().equals(UserCredentialModel.HOTP)) {
    if (!validHOTP(session,realm,user,credential.getValue(),fedCreds)) {
      return false;
    }
  }
 else   if (credential.getType().equals(UserCredentialModel.SECRET)) {
    if (!validSecret(realm,user,credential.getValue(),fedCreds.get(0))) {
      return false;
    }
  }
 else {
    return false;
  }
  return true;
}
