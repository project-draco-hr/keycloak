{
  if (unhashedCredValue == null || unhashedCredValue.isEmpty()) {
    return false;
  }
  boolean validated=PasswordHashManager.verify(session,realm,unhashedCredValue,credential);
  if (validated) {
    int iterations=hashIterations(realm);
    if (iterations > -1 && iterations != credential.getHashIterations()) {
      UserCredentialValueModel newCred=PasswordHashManager.encode(session,realm,unhashedCredValue);
      session.userFederatedStorage().updateCredential(realm,user,newCred);
    }
  }
  return validated;
}
