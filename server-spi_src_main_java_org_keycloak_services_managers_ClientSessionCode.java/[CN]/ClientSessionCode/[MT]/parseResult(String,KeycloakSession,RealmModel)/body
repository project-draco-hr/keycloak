{
  ParseResult result=new ParseResult();
  if (code == null) {
    result.illegalHash=true;
    return result;
  }
  try {
    String[] parts=code.split("\\.");
    String id=parts[1];
    result.clientSession=session.sessions().getClientSession(realm,id);
    if (result.clientSession == null) {
      result.clientSessionNotFound=true;
      return result;
    }
    String hash=createHash(realm,result.clientSession);
    if (!hash.equals(parts[0])) {
      result.illegalHash=true;
      return result;
    }
    result.code=new ClientSessionCode(realm,result.clientSession);
    return result;
  }
 catch (  RuntimeException e) {
    result.illegalHash=true;
    return result;
  }
}
