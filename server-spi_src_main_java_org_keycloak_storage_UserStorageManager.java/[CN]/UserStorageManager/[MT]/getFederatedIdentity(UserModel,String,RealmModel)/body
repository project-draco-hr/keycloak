{
  if (user == null)   throw new IllegalStateException("Federated user no longer valid");
  if (StorageId.isLocalStorage(user)) {
    return localStorage().getFederatedIdentity(user,socialProvider,realm);
  }
  return getFederatedStorage().getFederatedIdentity(user,socialProvider,realm);
}
