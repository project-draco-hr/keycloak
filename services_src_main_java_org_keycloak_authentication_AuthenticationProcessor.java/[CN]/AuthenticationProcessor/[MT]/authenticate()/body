{
  UserModel authUser=clientSession.getAuthenticatedUser();
  validateUser(authUser);
  Response challenge=processFlow(flowId);
  if (challenge != null)   return challenge;
  if (clientSession.getAuthenticatedUser() == null) {
    throw new AuthException(Error.UNKNOWN_USER);
  }
  return authenticationComplete();
}
