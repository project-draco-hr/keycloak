{
  ClientSessionCode code=new ClientSessionCode(realm,clientSession);
  if (!code.isValidAction(ClientSessionModel.Action.AUTHENTICATE.name())) {
    throw new AuthenticationFlowException(AuthenticationFlowError.INVALID_CLIENT_SESSION);
  }
  if (!code.isActionActive(ClientSessionModel.Action.AUTHENTICATE.name())) {
    throw new AuthenticationFlowException(AuthenticationFlowError.EXPIRED_CODE);
  }
  clientSession.setTimestamp(Time.currentTime());
}
