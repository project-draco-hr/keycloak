{
  if (authenticatedUser == null)   return;
  if (!authenticatedUser.isEnabled())   throw new AuthenticationFlowException(AuthenticationFlowError.USER_DISABLED);
  if (realm.isBruteForceProtected()) {
    if (protector.isTemporarilyDisabled(session,realm,authenticatedUser.getUsername())) {
      throw new AuthenticationFlowException(AuthenticationFlowError.USER_TEMPORARILY_DISABLED);
    }
  }
}
