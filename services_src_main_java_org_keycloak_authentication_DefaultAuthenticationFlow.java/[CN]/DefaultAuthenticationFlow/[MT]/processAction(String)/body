{
  while (executionIterator.hasNext()) {
    AuthenticationExecutionModel model=executionIterator.next();
    if (isProcessed(model)) {
      AuthenticationProcessor.logger.debug("execution is processed");
      if (!alternativeSuccessful && model.isAlternative() && processor.isSuccessful(model))       alternativeSuccessful=true;
      continue;
    }
    if (model.isAuthenticatorFlow()) {
      AuthenticationFlow authenticationFlow=processor.createFlowExecution(model.getFlowId(),model);
      return authenticationFlow.processAction(actionExecution);
    }
 else     if (model.getId().equals(actionExecution)) {
      AuthenticatorFactory factory=(AuthenticatorFactory)processor.getSession().getKeycloakSessionFactory().getProviderFactory(Authenticator.class,model.getAuthenticator());
      if (factory == null) {
        throw new RuntimeException("Unable to find factory for AuthenticatorFactory: " + model.getAuthenticator() + " did you forget to declare it in a META-INF/services file?");
      }
      Authenticator authenticator=factory.create(processor.getSession());
      AuthenticationProcessor.Result result=processor.createAuthenticatorContext(model,authenticator,executions);
      authenticator.action(result);
      Response response=processResult(result);
      if (response == null)       return processFlow();
 else       return response;
    }
  }
  throw new AuthenticationFlowException("action is not in current execution",AuthenticationFlowError.INTERNAL_ERROR);
}
