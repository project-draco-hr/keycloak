{
  if (formData.containsKey("cancel")) {
    LoginProtocol protocol=context.getSession().getProvider(LoginProtocol.class,context.getClientSession().getAuthMethod());
    protocol.setRealm(context.getRealm()).setHttpHeaders(context.getHttpRequest().getHttpHeaders()).setUriInfo(context.getUriInfo());
    context.getEvent().error(Errors.REJECTED_BY_USER);
    return protocol.consentDenied(context.getClientSession());
  }
  context.getUser().removeRequiredAction(PROVIDER_ID);
  return AuthenticationManager.nextActionAfterAuthentication(context.getSession(),context.getUserSession(),context.getClientSession(),context.getConnection(),context.getHttpRequest(),context.getUriInfo(),context.getEvent());
}
