{
  if (user == null) {
    Response challengeResponse=invalidUser(context);
    context.failureChallenge(AuthenticationProcessor.Error.INVALID_USER,challengeResponse);
    return true;
  }
  if (!user.isEnabled()) {
    Response challengeResponse=disabledUser(context);
    context.failureChallenge(AuthenticationProcessor.Error.USER_DISABLED,challengeResponse);
    return true;
  }
  if (context.getRealm().isBruteForceProtected()) {
    if (context.getProtector().isTemporarilyDisabled(context.getSession(),context.getRealm(),user.getUsername())) {
      Response challengeResponse=temporarilyDisabledUser(context);
      context.failureChallenge(AuthenticationProcessor.Error.USER_TEMPORARILY_DISABLED,challengeResponse);
      return true;
    }
  }
  return false;
}
