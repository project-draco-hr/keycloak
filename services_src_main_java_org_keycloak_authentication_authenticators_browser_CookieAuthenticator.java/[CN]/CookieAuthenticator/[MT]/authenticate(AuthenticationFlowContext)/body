{
  AuthenticationManager.AuthResult authResult=AuthenticationManager.authenticateIdentityCookie(context.getSession(),context.getRealm(),true);
  if (authResult == null) {
    context.attempted();
  }
 else {
    if (requireReauthentication(authResult.getSession(),context.getClientSession())) {
      context.attempted();
    }
 else {
      ClientSessionModel clientSession=context.getClientSession();
      clientSession.setNote(AuthenticationManager.SSO_AUTH,"true");
      context.setUser(authResult.getUser());
      context.attachUserSession(authResult.getSession());
      context.success();
    }
  }
}
