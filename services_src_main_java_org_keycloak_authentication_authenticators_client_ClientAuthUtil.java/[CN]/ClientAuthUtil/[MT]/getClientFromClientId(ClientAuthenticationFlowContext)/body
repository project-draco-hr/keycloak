{
  String client_id=null;
  String authorizationHeader=context.getHttpRequest().getHttpHeaders().getRequestHeaders().getFirst(HttpHeaders.AUTHORIZATION);
  MultivaluedMap<String,String> formData=context.getHttpRequest().getDecodedFormParameters();
  if (authorizationHeader != null) {
    String[] usernameSecret=BasicAuthHelper.parseHeader(authorizationHeader);
    if (usernameSecret != null) {
      client_id=usernameSecret[0];
    }
 else {
      if (!formData.containsKey(OAuth2Constants.CLIENT_ID)) {
        Response challengeResponse=Response.status(Response.Status.UNAUTHORIZED).header(HttpHeaders.WWW_AUTHENTICATE,"Basic realm=\"" + context.getRealm().getName() + "\"").build();
        context.challenge(challengeResponse);
        return null;
      }
    }
  }
  if (client_id == null) {
    client_id=formData.getFirst(OAuth2Constants.CLIENT_ID);
  }
  if (client_id == null) {
    Response challengeResponse=ClientAuthUtil.errorResponse(Response.Status.BAD_REQUEST.getStatusCode(),"invalid_client","Missing client_id parameter");
    context.challenge(challengeResponse);
    return null;
  }
  context.getEvent().client(client_id);
  ClientModel client=context.getRealm().getClientByClientId(client_id);
  if (client == null) {
    context.failure(AuthenticationFlowError.CLIENT_NOT_FOUND,null);
    return null;
  }
  if (!client.isEnabled()) {
    context.failure(AuthenticationFlowError.CLIENT_DISABLED,null);
    return null;
  }
  return client;
}
