{
  KeycloakIdentity identity=createIdentity();
  if (!identity.hasRole("uma_protection")) {
    throw new ErrorResponseException(OAuthErrorException.INVALID_SCOPE,"Requires uma_protection scope.",Status.FORBIDDEN);
  }
  ResourceSetService resourceManager=new ResourceSetService(getResourceServer(identity),this.authorization,null);
  ResteasyProviderFactory.getInstance().injectProperties(resourceManager);
  ResourceService resource=new ResourceService(getResourceServer(identity),identity,resourceManager,this.authorization);
  ResteasyProviderFactory.getInstance().injectProperties(resource);
  return resource;
}
