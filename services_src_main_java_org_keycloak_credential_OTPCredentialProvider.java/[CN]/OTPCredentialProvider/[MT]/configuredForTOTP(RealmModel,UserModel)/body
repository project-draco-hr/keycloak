{
  return !getCachedCredentials(user,CredentialModel.TOTP).isEmpty() || !getCredentialStore().getStoredCredentialsByType(realm,user,CredentialModel.TOTP).isEmpty();
}
