{
  List<ComponentModel> components=getCredentialProviderComponents(realm);
  for (  ComponentModel component : components) {
    CredentialProviderFactory factory=(CredentialProviderFactory)session.getKeycloakSessionFactory().getProviderFactory(CredentialProvider.class,component.getProviderId());
    if (!Types.supports(OnUserCache.class,factory,CredentialProviderFactory.class))     continue;
    OnUserCache validator=(OnUserCache)session.getAttribute(component.getId());
    if (validator == null) {
      validator=(OnUserCache)factory.create(session,component);
      session.setAttribute(component.getId(),validator);
    }
    validator.onCache(realm,user);
  }
}
