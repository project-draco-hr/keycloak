{
  String redirect=clientSession.getRedirectUri();
  String state=clientSession.getNote(OIDCLoginProtocol.STATE_PARAM);
  UriBuilder redirectUri=UriBuilder.fromUri(redirect).queryParam(OAuth2Constants.ERROR,"access_denied");
  if (state != null) {
    redirectUri.queryParam(OAuth2Constants.STATE,state);
  }
  session.sessions().removeClientSession(realm,clientSession);
  RestartLoginCookie.expireRestartCookie(realm,session.getContext().getConnection(),uriInfo);
  return Response.status(302).location(redirectUri.build()).build();
}
