{
  if (client.isBearerOnly()) {
    event.error(Errors.INVALID_CLIENT);
    throw new ErrorResponseException("unauthorized_client","Bearer-only client not allowed to retrieve service account",Response.Status.UNAUTHORIZED);
  }
  if (client.isPublicClient()) {
    event.error(Errors.INVALID_CLIENT);
    throw new ErrorResponseException("unauthorized_client","Public client not allowed to retrieve service account",Response.Status.UNAUTHORIZED);
  }
  if (!client.isServiceAccountsEnabled()) {
    event.error(Errors.INVALID_CLIENT);
    throw new ErrorResponseException("unauthorized_client","Client not enabled to retrieve service account",Response.Status.UNAUTHORIZED);
  }
}
