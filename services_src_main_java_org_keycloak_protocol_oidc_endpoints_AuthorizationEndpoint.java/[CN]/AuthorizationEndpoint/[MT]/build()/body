{
  MultivaluedMap<String,String> params=uriInfo.getQueryParameters();
  clientId=params.getFirst(OIDCLoginProtocol.CLIENT_ID_PARAM);
  responseType=params.getFirst(OIDCLoginProtocol.RESPONSE_TYPE_PARAM);
  responseMode=params.getFirst(OIDCLoginProtocol.RESPONSE_MODE_PARAM);
  redirectUriParam=params.getFirst(OIDCLoginProtocol.REDIRECT_URI_PARAM);
  state=params.getFirst(OIDCLoginProtocol.STATE_PARAM);
  scope=params.getFirst(OIDCLoginProtocol.SCOPE_PARAM);
  loginHint=params.getFirst(OIDCLoginProtocol.LOGIN_HINT_PARAM);
  prompt=params.getFirst(OIDCLoginProtocol.PROMPT_PARAM);
  idpHint=params.getFirst(AdapterConstants.KC_IDP_HINT);
  nonce=params.getFirst(OIDCLoginProtocol.NONCE_PARAM);
  checkSsl();
  checkRealm();
  checkResponseType();
  checkClient();
  checkRedirectUri();
  createClientSession();
  CacheControlUtil.noBackButtonCacheControlHeader();
switch (action) {
case REGISTER:
    return buildRegister();
case FORGOT_CREDENTIALS:
  return buildForgotCredential();
case CODE:
return buildAuthorizationCodeAuthorizationResponse();
}
throw new RuntimeException("Unknown action " + action);
}
