{
  if (clientId == null) {
    event.error(Errors.INVALID_REQUEST);
    throw new ErrorPageException(session,Messages.MISSING_PARAMETER,OIDCLoginProtocol.CLIENT_ID_PARAM);
  }
  event.client(clientId);
  client=realm.getClientByClientId(clientId);
  if (client == null) {
    event.error(Errors.CLIENT_NOT_FOUND);
    throw new ErrorPageException(session,Messages.CLIENT_NOT_FOUND);
  }
  if (client.isBearerOnly()) {
    event.error(Errors.NOT_ALLOWED);
    throw new ErrorPageException(session,Messages.BEARER_ONLY);
  }
  if ((parsedResponseType.hasResponseType(OIDCResponseType.CODE) || parsedResponseType.hasResponseType(OIDCResponseType.NONE)) && !client.isStandardFlowEnabled()) {
    event.error(Errors.NOT_ALLOWED);
    throw new ErrorPageException(session,Messages.STANDARD_FLOW_DISABLED);
  }
  if ((parsedResponseType.hasResponseType(OIDCResponseType.TOKEN) || parsedResponseType.hasResponseType(OIDCResponseType.ID_TOKEN) || parsedResponseType.hasResponseType(OIDCResponseType.REFRESH_TOKEN)) && !client.isImplicitFlowEnabled()) {
    event.error(Errors.NOT_ALLOWED);
    throw new ErrorPageException(session,Messages.IMPLICIT_FLOW_DISABLED);
  }
  session.getContext().setClient(client);
}
