{
  event.event(EventType.LOGOUT);
  if (redirectUri != null) {
    event.detail(Details.REDIRECT_URI,redirectUri);
  }
  AuthenticationManager.AuthResult authResult=authManager.authenticateIdentityCookie(session,realm,uriInfo,clientConnection,headers,false);
  if (authResult != null) {
    logout(authResult.getSession());
  }
  if (redirectUri != null) {
    String validatedRedirect=RedirectUtils.verifyRealmRedirectUri(uriInfo,redirectUri,realm);
    if (validatedRedirect == null) {
      return Flows.forwardToSecurityFailurePage(session,realm,uriInfo,"Invalid redirect uri.");
    }
    return Response.status(302).location(UriBuilder.fromUri(validatedRedirect).build()).build();
  }
 else {
    return Response.ok().build();
  }
}
