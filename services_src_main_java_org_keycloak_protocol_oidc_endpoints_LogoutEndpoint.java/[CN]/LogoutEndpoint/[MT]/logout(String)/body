{
  if (redirectUri != null) {
    String validatedUri=RedirectUtils.verifyRealmRedirectUri(uriInfo,redirectUri,realm);
    if (validatedUri == null) {
      event.event(EventType.LOGOUT);
      event.detail(Details.REDIRECT_URI,redirectUri);
      event.error(Errors.INVALID_REDIRECT_URI);
      return Flows.forwardToSecurityFailurePage(session,realm,uriInfo,headers,Messages.INVALID_REDIRECT_URI);
    }
    redirectUri=validatedUri;
  }
  AuthenticationManager.AuthResult authResult=authManager.authenticateIdentityCookie(session,realm,uriInfo,clientConnection,headers,false);
  if (authResult != null) {
    if (redirectUri != null)     authResult.getSession().setNote(OIDCLoginProtocol.LOGOUT_REDIRECT_URI,redirectUri);
    authResult.getSession().setNote(AuthenticationManager.KEYCLOAK_LOGOUT_PROTOCOL,OIDCLoginProtocol.LOGIN_PROTOCOL);
    return AuthenticationManager.browserLogout(session,realm,authResult.getSession(),uriInfo,clientConnection,headers);
  }
  if (redirectUri != null) {
    return Response.status(302).location(UriBuilder.fromUri(redirectUri).build()).build();
  }
 else {
    return Response.ok().build();
  }
}
