{
  if (!transaction.isActive())   throw new IllegalStateException("Transaction is not active");
  if (model == null) {
    model=getModelProvider();
    model.getTransaction().begin();
    managedTransactions.add(model.getTransaction());
  }
  return model;
}
