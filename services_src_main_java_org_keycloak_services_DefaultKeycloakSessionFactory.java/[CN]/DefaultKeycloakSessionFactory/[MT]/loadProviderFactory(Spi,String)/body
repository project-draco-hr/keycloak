{
  for (  ProviderFactory factory : ServiceLoader.load(spi.getProviderFactoryClass())) {
    if (factory.getId().equals(id)) {
      return factory;
    }
  }
  throw new RuntimeException("Failed to find provider " + id + " for "+ spi.getName());
}
