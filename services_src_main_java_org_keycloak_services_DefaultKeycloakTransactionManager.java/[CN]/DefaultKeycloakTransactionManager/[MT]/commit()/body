{
  RuntimeException exception=null;
  for (  KeycloakTransaction tx : transactions) {
    try {
      tx.commit();
    }
 catch (    RuntimeException e) {
      exception=exception == null ? e : exception;
    }
  }
  if (exception == null) {
    for (    KeycloakTransaction tx : afterCompletion) {
      try {
        tx.commit();
      }
 catch (      RuntimeException e) {
        exception=exception == null ? e : exception;
      }
    }
  }
 else {
    for (    KeycloakTransaction tx : afterCompletion) {
      try {
        tx.rollback();
      }
 catch (      RuntimeException e) {
        logger.error("Exception during rollback",e);
      }
    }
  }
  active=false;
  if (exception != null) {
    throw exception;
  }
}
