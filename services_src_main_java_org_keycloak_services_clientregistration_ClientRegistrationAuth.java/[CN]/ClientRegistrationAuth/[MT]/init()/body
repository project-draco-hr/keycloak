{
  realm=session.getContext().getRealm();
  UriInfo uri=session.getContext().getUri();
  String authorizationHeader=session.getContext().getRequestHeaders().getRequestHeaders().getFirst(HttpHeaders.AUTHORIZATION);
  if (authorizationHeader == null) {
    return;
  }
  String[] split=authorizationHeader.split(" ");
  if (!split[0].equalsIgnoreCase("bearer")) {
    return;
  }
  jwt=ClientRegistrationTokenUtils.verifyToken(realm,uri,split[1]);
  if (jwt == null) {
    throw unauthorized();
  }
  if (isInitialAccessToken()) {
    initialAccessModel=session.sessions().getClientInitialAccessModel(session.getContext().getRealm(),jwt.getId());
    if (initialAccessModel == null) {
      throw unauthorized();
    }
  }
}
