{
  logger.debugf("Verifying remote host : %s",hostAddress);
  List<ClientRegistrationTrustedHostModel> trustedHosts=session.sessions().listClientRegistrationTrustedHosts(realm);
  for (  ClientRegistrationTrustedHostModel realmTrustedHost : trustedHosts) {
    try {
      if (realmTrustedHost.getRemainingCount() <= 0) {
        continue;
      }
      String realmHostIPAddress=InetAddress.getByName(realmTrustedHost.getHostName()).getHostAddress();
      logger.debugf("Trying host '%s' of address '%s'",realmTrustedHost.getHostName(),realmHostIPAddress);
      if (realmHostIPAddress.equals(hostAddress)) {
        logger.debugf("Successfully verified host : %s",realmTrustedHost.getHostName());
        return realmTrustedHost;
      }
    }
 catch (    UnknownHostException uhe) {
      logger.debugf("Unknown host from realm configuration: %s",realmTrustedHost.getHostName());
    }
  }
  logger.debugf("Failed to verify remote host : %s",hostAddress);
  return null;
}
