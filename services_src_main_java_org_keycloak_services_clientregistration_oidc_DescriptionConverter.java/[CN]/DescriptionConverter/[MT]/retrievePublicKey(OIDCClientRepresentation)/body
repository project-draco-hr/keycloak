{
  if (clientOIDC.getJwksUri() == null && clientOIDC.getJwks() == null) {
    throw new ClientRegistrationException("Requested client authentication method '%s' but jwks_uri nor jwks were available in config");
  }
  if (clientOIDC.getJwksUri() != null && clientOIDC.getJwks() != null) {
    throw new ClientRegistrationException("Illegal to use both jwks_uri and jwks");
  }
  JSONWebKeySet keySet;
  if (clientOIDC.getJwks() != null) {
    keySet=clientOIDC.getJwks();
  }
 else {
    try {
      keySet=JWKSUtils.sendJwksRequest(clientOIDC.getJwksUri());
    }
 catch (    IOException ioe) {
      throw new ClientRegistrationException("Failed to send JWKS request to specified jwks_uri",ioe);
    }
  }
  return JWKSUtils.getKeyForUse(keySet,JWK.Use.SIG);
}
