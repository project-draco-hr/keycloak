{
  UriBuilder builder=Urls.accountBase(uriInfo.getBaseUri()).path(AccountService.class,"processEmailVerification");
  for (  Entry<String,List<String>> e : uriInfo.getQueryParameters().entrySet()) {
    builder.queryParam(e.getKey(),e.getValue().toArray());
  }
  builder.queryParam("code",code);
  URI uri=builder.build(realm.getId());
  StringBuilder sb=new StringBuilder();
  sb.append(uri.toString());
  sb.append("\n");
  sb.append("Expires in " + TimeUnit.SECONDS.toMinutes(realm.getAccessCodeLifespanUserAction()));
  try {
    send(user.getEmail(),"Verify email",sb.toString());
  }
 catch (  Exception e1) {
    log.warn("Failed to send email verification");
  }
}
