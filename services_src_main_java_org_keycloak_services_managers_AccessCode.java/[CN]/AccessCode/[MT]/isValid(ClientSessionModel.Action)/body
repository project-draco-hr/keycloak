{
  ClientSessionModel.Action action=clientSession.getAction();
  if (action == null) {
    return false;
  }
  int timestamp=clientSession.getTimestamp();
  if (!action.equals(requestedAction)) {
    return false;
  }
  int lifespan=action.equals(ClientSessionModel.Action.CODE_TO_TOKEN) ? realm.getAccessCodeLifespan() : realm.getAccessCodeLifespanUserAction();
  return timestamp + lifespan > Time.currentTime();
}
