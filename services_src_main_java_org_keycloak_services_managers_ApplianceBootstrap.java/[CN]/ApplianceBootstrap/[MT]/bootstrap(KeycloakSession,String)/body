{
  if (session.getRealm(Config.getAdminRealm()) != null) {
    return;
  }
  String adminRealmName=Config.getAdminRealm();
  logger.info("Initializing " + adminRealmName + " realm");
  RealmManager manager=new RealmManager(session);
  RealmModel realm=manager.createRealm(adminRealmName,adminRealmName);
  realm.setName(adminRealmName);
  realm.setEnabled(true);
  realm.addRequiredCredential(CredentialRepresentation.PASSWORD);
  realm.setCentralLoginLifespan(3000);
  realm.setAccessTokenLifespan(60);
  realm.setRefreshTokenLifespan(3600);
  realm.setAccessCodeLifespan(60);
  realm.setAccessCodeLifespanUserAction(300);
  realm.setSslNotRequired(true);
  realm.setRegistrationAllowed(false);
  manager.generateRealmKeys(realm);
  realm.setAuthenticationProviders(Arrays.asList(AuthenticationProviderModel.DEFAULT_PROVIDER));
  ApplicationModel adminConsole=new ApplicationManager(manager).createApplication(realm,Constants.ADMIN_CONSOLE_APPLICATION);
  adminConsole.setBaseUrl(contextPath + "/admin/index.html");
  adminConsole.setEnabled(true);
  adminConsole.setPublicClient(true);
  adminConsole.addRedirectUri(contextPath + "/admin/" + realm.getName()+ "/console/*");
  realm.setAuditListeners(Collections.singleton("jboss-logging"));
  RoleModel adminRole=realm.getRole(AdminRoles.ADMIN);
  realm.addScopeMapping(adminConsole,adminRole);
  UserModel adminUser=realm.addUser("admin");
  adminUser.setEnabled(true);
  UserCredentialModel password=new UserCredentialModel();
  password.setType(UserCredentialModel.PASSWORD);
  password.setValue("admin");
  realm.updateCredential(adminUser,password);
  adminUser.addRequiredAction(UserModel.RequiredAction.UPDATE_PASSWORD);
  realm.grantRole(adminUser,adminRole);
  ApplicationModel accountApp=realm.getApplicationNameMap().get(Constants.ACCOUNT_MANAGEMENT_APP);
  for (  String r : accountApp.getDefaultRoles()) {
    realm.grantRole(adminUser,accountApp.getRole(r));
  }
}
