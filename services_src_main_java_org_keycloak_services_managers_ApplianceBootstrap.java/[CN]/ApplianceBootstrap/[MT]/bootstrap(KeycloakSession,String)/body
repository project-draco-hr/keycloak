{
  String adminRealmName=Config.getAdminRealm();
  if (session.realms().getRealm(adminRealmName) != null) {
    return;
  }
  logger.info("Initializing " + adminRealmName + " realm");
  RealmManager manager=new RealmManager(session);
  manager.setContextPath(contextPath);
  RealmModel realm=manager.createRealm(adminRealmName,adminRealmName);
  realm.setName(adminRealmName);
  realm.setEnabled(true);
  realm.addRequiredCredential(CredentialRepresentation.PASSWORD);
  realm.setSsoSessionIdleTimeout(1800);
  realm.setAccessTokenLifespan(60);
  realm.setSsoSessionMaxLifespan(36000);
  realm.setAccessCodeLifespan(60);
  realm.setAccessCodeLifespanUserAction(300);
  realm.setAccessCodeLifespanLogin(1800);
  realm.setSslRequired(SslRequired.EXTERNAL);
  realm.setRegistrationAllowed(false);
  realm.setRegistrationEmailAsUsername(false);
  KeycloakModelUtils.generateRealmKeys(realm);
  UserModel adminUser=session.users().addUser(realm,"admin");
  adminUser.setEnabled(true);
  UserCredentialModel password=new UserCredentialModel();
  password.setType(UserCredentialModel.PASSWORD);
  password.setValue("admin");
  session.users().updateCredential(realm,adminUser,password);
  adminUser.addRequiredAction(UserModel.RequiredAction.UPDATE_PASSWORD);
  RoleModel adminRole=realm.getRole(AdminRoles.ADMIN);
  adminUser.grantRole(adminRole);
  ClientModel accountApp=realm.getClientNameMap().get(Constants.ACCOUNT_MANAGEMENT_APP);
  for (  String r : accountApp.getDefaultRoles()) {
    adminUser.grantRole(accountApp.getRole(r));
  }
}
