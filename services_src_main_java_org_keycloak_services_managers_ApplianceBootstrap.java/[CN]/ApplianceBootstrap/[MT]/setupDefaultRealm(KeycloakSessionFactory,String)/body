{
  KeycloakSession session=sessionFactory.create();
  session.getTransaction().begin();
  try {
    String adminRealmName=Config.getAdminRealm();
    if (session.realms().getRealm(adminRealmName) != null) {
      return false;
    }
    logger.info("Initializing " + adminRealmName + " realm");
    RealmManager manager=new RealmManager(session);
    manager.setContextPath(contextPath);
    RealmModel realm=manager.createRealm(adminRealmName,adminRealmName);
    realm.setName(adminRealmName);
    realm.setEnabled(true);
    realm.addRequiredCredential(CredentialRepresentation.PASSWORD);
    realm.setSsoSessionIdleTimeout(1800);
    realm.setAccessTokenLifespan(60);
    realm.setSsoSessionMaxLifespan(36000);
    realm.setOfflineSessionIdleTimeout(Constants.DEFAULT_OFFLINE_SESSION_IDLE_TIMEOUT);
    realm.setAccessCodeLifespan(60);
    realm.setAccessCodeLifespanUserAction(300);
    realm.setAccessCodeLifespanLogin(1800);
    realm.setSslRequired(SslRequired.EXTERNAL);
    realm.setRegistrationAllowed(false);
    realm.setRegistrationEmailAsUsername(false);
    KeycloakModelUtils.generateRealmKeys(realm);
    session.getTransaction().commit();
    return true;
  }
  finally {
    session.close();
  }
}
