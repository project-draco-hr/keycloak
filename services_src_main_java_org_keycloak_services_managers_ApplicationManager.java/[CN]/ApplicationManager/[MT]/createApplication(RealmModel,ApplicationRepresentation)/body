{
  logger.debug("************ CREATE APPLICATION: {0}" + resourceRep.getName());
  ApplicationModel applicationModel=realm.addApplication(resourceRep.getName());
  if (resourceRep.isEnabled() != null)   applicationModel.setEnabled(resourceRep.isEnabled());
  applicationModel.setManagementUrl(resourceRep.getAdminUrl());
  if (resourceRep.isSurrogateAuthRequired() != null)   applicationModel.setSurrogateAuthRequired(resourceRep.isSurrogateAuthRequired());
  applicationModel.setBaseUrl(resourceRep.getBaseUrl());
  if (resourceRep.isBearerOnly() != null)   applicationModel.setBearerOnly(resourceRep.isBearerOnly());
  if (resourceRep.isPublicClient() != null)   applicationModel.setPublicClient(resourceRep.isPublicClient());
  applicationModel.updateApplication();
  if (resourceRep.getNotBefore() != null) {
    applicationModel.setNotBefore(resourceRep.getNotBefore());
  }
  applicationModel.setSecret(resourceRep.getSecret());
  if (applicationModel.getSecret() == null) {
    generateSecret(applicationModel);
  }
  if (resourceRep.getRedirectUris() != null) {
    for (    String redirectUri : resourceRep.getRedirectUris()) {
      applicationModel.addRedirectUri(redirectUri);
    }
  }
  if (resourceRep.getWebOrigins() != null) {
    for (    String webOrigin : resourceRep.getWebOrigins()) {
      logger.debugv("Application: {0} webOrigin: {1}",resourceRep.getName(),webOrigin);
      applicationModel.addWebOrigin(webOrigin);
    }
  }
 else {
    if (resourceRep.getRedirectUris() != null) {
      Set<String> origins=new HashSet<String>();
      for (      String redirectUri : resourceRep.getRedirectUris()) {
        logger.info("add redirectUri to origin: " + redirectUri);
        if (redirectUri.startsWith("http:")) {
          URI uri=URI.create(redirectUri);
          String origin=uri.getScheme() + "://" + uri.getHost();
          if (uri.getPort() != -1) {
            origin+=":" + uri.getPort();
          }
          logger.debugv("adding default application origin: {0}",origin);
          origins.add(origin);
        }
      }
      if (origins.size() > 0) {
        applicationModel.setWebOrigins(origins);
      }
    }
  }
  if (resourceRep.getDefaultRoles() != null) {
    applicationModel.updateDefaultRoles(resourceRep.getDefaultRoles());
  }
  if (resourceRep.getClaims() != null) {
    ClaimManager.setClaims(applicationModel,resourceRep.getClaims());
  }
 else {
    applicationModel.setAllowedClaimsMask(ClaimMask.USERNAME);
  }
  return applicationModel;
}
