{
  if (resourceRep.getRoleMappings() != null) {
    for (    UserRoleMappingRepresentation mapping : resourceRep.getRoleMappings()) {
      UserModel user=realm.getUser(mapping.getUsername());
      if (user == null) {
        throw new RuntimeException("User not found");
      }
      for (      String roleString : mapping.getRoles()) {
        RoleModel role=applicationModel.getRole(roleString.trim());
        if (role == null) {
          role=applicationModel.addRole(roleString.trim());
        }
        applicationModel.grantRole(user,role);
      }
    }
  }
  if (resourceRep.getScopeMappings() != null) {
    for (    ScopeMappingRepresentation mapping : resourceRep.getScopeMappings()) {
      UserModel user=realm.getUser(mapping.getUsername());
      for (      String roleString : mapping.getRoles()) {
        RoleModel role=applicationModel.getRole(roleString.trim());
        if (role == null) {
          role=applicationModel.addRole(roleString.trim());
        }
        applicationModel.addScopeMapping(user,role.getName());
      }
    }
  }
}
