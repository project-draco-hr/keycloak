{
  logger.info("authenticateIdentityCookie");
  Cookie cookie=headers.getCookies().get(KEYCLOAK_IDENTITY_COOKIE);
  if (cookie == null) {
    logger.infov("authenticateCookie could not find cookie: {0}",KEYCLOAK_IDENTITY_COOKIE);
    return null;
  }
  String tokenString=cookie.getValue();
  AuthResult authResult=verifyIdentityToken(session,realm,uriInfo,connection,checkActive,tokenString);
  if (authResult == null) {
    expireIdentityCookie(realm,uriInfo,connection);
    return null;
  }
  authResult.getSession().setLastSessionRefresh(Time.currentTime());
  return authResult;
}
