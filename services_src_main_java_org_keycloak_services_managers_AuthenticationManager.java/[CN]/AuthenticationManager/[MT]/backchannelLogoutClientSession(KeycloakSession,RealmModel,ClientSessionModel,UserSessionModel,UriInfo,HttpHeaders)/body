{
  ClientModel client=clientSession.getClient();
  if (client instanceof ClientModel && !client.isFrontchannelLogout() && clientSession.getAction() != ClientSessionModel.Action.LOGGED_OUT) {
    String authMethod=clientSession.getAuthMethod();
    if (authMethod == null)     return;
    LoginProtocol protocol=session.getProvider(LoginProtocol.class,authMethod);
    protocol.setRealm(realm).setHttpHeaders(headers).setUriInfo(uriInfo);
    protocol.backchannelLogout(userSession,clientSession);
    clientSession.setAction(ClientSessionModel.Action.LOGGED_OUT);
  }
}
