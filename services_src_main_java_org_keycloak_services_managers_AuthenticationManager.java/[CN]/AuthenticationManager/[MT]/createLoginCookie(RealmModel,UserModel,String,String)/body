{
  SkeletonKeyToken identityToken=createIdentityToken(realm,user.getLoginName());
  String encoded=encodeToken(realm,identityToken);
  boolean secureOnly=!realm.isSslNotRequired();
  logger.info("creatingLoginCookie - name: " + cookieName + " path: "+ cookiePath);
  NewCookie cookie=new NewCookie(cookieName,encoded,cookiePath,null,null,NewCookie.DEFAULT_MAX_AGE,secureOnly,true);
  return cookie;
}
