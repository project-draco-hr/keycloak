{
  if (userSession == null)   return;
  UserModel user=userSession.getUser();
  logger.debugv("Logging out: {0} ({1})",user.getUsername(),userSession.getId());
  expireIdentityCookie(realm,uriInfo,connection);
  expireRememberMeCookie(realm,uriInfo,connection);
  for (  ClientSessionModel clientSession : userSession.getClientSessions()) {
    ClientModel client=clientSession.getClient();
    if (client instanceof ApplicationModel) {
      String authMethod=clientSession.getAuthMethod();
      if (authMethod == null)       continue;
      LoginProtocol protocol=session.getProvider(LoginProtocol.class,authMethod);
      protocol.setRealm(realm).setUriInfo(uriInfo);
      protocol.backchannelLogout(userSession,clientSession);
    }
  }
  session.sessions().removeUserSession(realm,userSession);
}
