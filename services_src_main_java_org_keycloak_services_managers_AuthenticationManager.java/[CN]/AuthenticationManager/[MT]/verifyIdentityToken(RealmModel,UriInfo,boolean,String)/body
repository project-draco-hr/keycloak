{
  try {
    AccessToken token=RSATokenVerifier.verifyToken(tokenString,realm.getPublicKey(),realm.getName(),checkActive);
    logger.info("identity token verified");
    if (checkActive) {
      logger.info("Checking if identity token is active");
      if (!token.isActive() || token.getIssuedAt() < realm.getNotBefore()) {
        logger.info("identity cookie expired");
        return null;
      }
 else {
        logger.info("token.isActive() : " + token.isActive());
        logger.info("token.issuedAt: " + token.getIssuedAt());
        logger.info("real.notbefore: " + realm.getNotBefore());
      }
    }
    UserModel user=realm.getUserById(token.getSubject());
    if (user == null || !user.isEnabled()) {
      logger.info("Unknown user in identity token");
      return null;
    }
    UserSessionModel session=realm.getUserSession(token.getSessionState());
    if (!isSessionValid(realm,session)) {
      if (session != null)       logout(realm,session,uriInfo);
      logger.info("User session not active");
      return null;
    }
    return new AuthResult(user,session,token);
  }
 catch (  VerificationException e) {
    logger.info("Failed to verify identity token",e);
  }
  return null;
}
