{
  try {
    Key codeSecretKey=realm.getCodeSecretKey();
    Mac mac=Mac.getInstance(codeSecretKey.getAlgorithm());
    mac.init(codeSecretKey);
    mac.update(clientSession.getId().getBytes());
    mac.update(HASH_SEPERATOR);
    mac.update(clientSession.getNote(ACTION_KEY).getBytes());
    return Base64Url.encode(mac.doFinal());
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
