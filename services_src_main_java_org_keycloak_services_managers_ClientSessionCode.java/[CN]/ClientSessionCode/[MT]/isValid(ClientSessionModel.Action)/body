{
  ClientSessionModel.Action action=clientSession.getAction();
  if (action == null) {
    return false;
  }
  int timestamp=clientSession.getTimestamp();
  if (!action.equals(requestedAction)) {
    return false;
  }
  int lifespan;
switch (action) {
case CODE_TO_TOKEN:
    lifespan=realm.getAccessCodeLifespan();
  break;
case AUTHENTICATE:
lifespan=realm.getAccessCodeLifespanLogin() > 0 ? realm.getAccessCodeLifespanLogin() : realm.getAccessCodeLifespanUserAction();
break;
default :
lifespan=realm.getAccessCodeLifespanUserAction();
break;
}
return timestamp + lifespan > Time.currentTime();
}
