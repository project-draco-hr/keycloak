{
  String action=clientSession.getAction();
  if (action == null) {
    return false;
  }
  int timestamp=clientSession.getTimestamp();
  if (!action.equals(requestedAction)) {
    return false;
  }
  int lifespan;
  if (action.equals(ClientSessionModel.Action.CODE_TO_TOKEN.name())) {
    lifespan=realm.getAccessCodeLifespan();
  }
 else   if (action.equals(ClientSessionModel.Action.AUTHENTICATE.name())) {
    lifespan=realm.getAccessCodeLifespanLogin() > 0 ? realm.getAccessCodeLifespanLogin() : realm.getAccessCodeLifespanUserAction();
  }
 else {
    lifespan=realm.getAccessCodeLifespanUserAction();
  }
  return timestamp + lifespan > Time.currentTime();
}
