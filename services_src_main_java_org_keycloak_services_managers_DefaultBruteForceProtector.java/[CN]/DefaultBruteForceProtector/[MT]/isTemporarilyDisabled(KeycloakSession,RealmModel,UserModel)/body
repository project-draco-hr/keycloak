{
  UserLoginFailureModel failure=session.sessions().getUserLoginFailure(realm,user.getId());
  if (failure != null) {
    int currTime=markCheck=(int)(Time.currentTimeMillis() / 1000);
    int failedLoginNotBefore=failure.getFailedLoginNotBefore();
    testCount++;
    if (currTime < failedLoginNotBefore) {
      logger.debugv("Current: {0} notBefore: {1}",currTime,failedLoginNotBefore);
      return true;
    }
 else     if (failedLoginNotBefore > 0) {
      logger.debugv("failedLoginNotBefore > 0 Current: {0} notBefore: {1}",currTime,failedLoginNotBefore);
    }
  }
 else {
    logger.debugv("failure was null");
    nullFailureCount++;
  }
  return false;
}
