{
  Response response;
  if (!user.isEnabled()) {
    event.error(Errors.USER_DISABLED);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,Messages.ACCOUNT_DISABLED);
  }
 else {
    UserSessionModel userSession=session.sessions().createUserSession(realm,user,user.getUsername(),clientConnection.getRemoteAddr(),authMethod,false);
    TokenManager.attachClientSession(userSession,clientSession);
    event.session(userSession);
    response=AuthenticationManager.nextActionAfterAuthentication(session,userSession,clientSession,clientConnection,request,uriInfo,event);
  }
  return new HttpAuthOutput(response,null);
}
