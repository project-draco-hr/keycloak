{
  UserModel user=newRealm.addUser(userRep.getUsername());
  user.setEnabled(userRep.isEnabled());
  user.setEmail(userRep.getEmail());
  user.setFirstName(userRep.getFirstName());
  user.setLastName(userRep.getLastName());
  if (userRep.getAttributes() != null) {
    for (    Map.Entry<String,String> entry : userRep.getAttributes().entrySet()) {
      user.setAttribute(entry.getKey(),entry.getValue());
    }
  }
  if (userRep.getRequiredActions() != null) {
    for (    String requiredAction : userRep.getRequiredActions()) {
      user.addRequiredAction(RequiredAction.valueOf(requiredAction));
    }
  }
  if (userRep.getCredentials() != null) {
    for (    CredentialRepresentation cred : userRep.getCredentials()) {
      UserCredentialModel credential=fromRepresentation(cred);
      user.updateCredential(credential);
    }
  }
  if (userRep.getAuthenticationLink() != null) {
    AuthenticationLinkRepresentation link=userRep.getAuthenticationLink();
    AuthenticationLinkModel authLink=new AuthenticationLinkModel(link.getAuthProvider(),link.getAuthUserId());
    user.setAuthenticationLink(authLink);
  }
  return user;
}
