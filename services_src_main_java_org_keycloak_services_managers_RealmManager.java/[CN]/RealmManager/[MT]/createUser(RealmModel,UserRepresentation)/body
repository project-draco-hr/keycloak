{
  UserModel user=newRealm.addUser(userRep.getUsername());
  user.setStatus(UserModel.Status.valueOf(userRep.getStatus()));
  user.setEmail(userRep.getEmail());
  if (userRep.getAttributes() != null) {
    for (    Map.Entry<String,String> entry : userRep.getAttributes().entrySet()) {
      user.setAttribute(entry.getKey(),entry.getValue());
    }
  }
  if (userRep.getRequiredActions() != null) {
    for (    String requiredAction : userRep.getRequiredActions()) {
      user.addRequiredAction(RequiredAction.valueOf(requiredAction));
    }
  }
  if (userRep.getCredentials() != null) {
    for (    CredentialRepresentation cred : userRep.getCredentials()) {
      UserCredentialModel credential=new UserCredentialModel();
      credential.setType(cred.getType());
      credential.setValue(cred.getValue());
      newRealm.updateCredential(user,credential);
    }
  }
  return user;
}
