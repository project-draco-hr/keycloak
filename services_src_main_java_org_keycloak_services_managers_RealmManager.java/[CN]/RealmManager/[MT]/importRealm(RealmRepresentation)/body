{
  String id=rep.getId();
  if (id == null) {
    id=KeycloakModelUtils.generateId();
  }
  RealmModel realm=model.createRealm(id,rep.getRealm());
  realm.setName(rep.getRealm());
  setupRealmDefaults(realm);
  setupMasterAdminManagement(realm);
  if (!hasRealmAdminManagementClient(rep))   setupRealmAdminManagement(realm);
  if (!hasAccountManagementClient(rep))   setupAccountManagement(realm);
  if (!hasImpersonationServiceClient(rep))   setupImpersonationService(realm);
  if (!hasBrokerClient(rep))   setupBrokerService(realm);
  if (!hasAdminConsoleClient(rep))   setupAdminConsole(realm);
  RepresentationToModel.importRealm(session,rep,realm);
  setupAuthenticationFlows(realm);
  setupRequiredActions(realm);
  List<UserFederationProviderModel> federationProviders=realm.getUserFederationProviders();
  UsersSyncManager usersSyncManager=new UsersSyncManager();
  for (  final UserFederationProviderModel fedProvider : federationProviders) {
    usersSyncManager.refreshPeriodicSyncForProvider(session.getKeycloakSessionFactory(),session.getProvider(TimerProvider.class),fedProvider,realm.getId());
  }
  return realm;
}
