{
  ApacheHttpClient4Executor executor=createExecutor();
  try {
    List<ApplicationModel> resources;
    if (session != null) {
      resources=new LinkedList<ApplicationModel>();
      for (      ClientSessionModel clientSession : session.getClientSessions()) {
        ClientModel client=clientSession.getClient();
        if (client instanceof ApplicationModel) {
          resources.add((ApplicationModel)client);
        }
      }
    }
 else {
      resources=realm.getApplications();
    }
    logger.debugv("logging out {0} resources ",resources.size());
    for (    ApplicationModel resource : resources) {
      logoutApplication(requestUri,realm,resource,user,session != null ? session.getId() : null,executor,0);
    }
  }
  finally {
    executor.getHttpClient().getConnectionManager().shutdown();
  }
}
