{
  this.partitionManager=partitionManager;
  this.entityManager=entityManager;
  if (currentEntityManager.get() != null) {
    setWhere.get().printStackTrace();
    String path=setFromPath.get();
    if (path == null)     path="???";
    throw new IllegalStateException("Thread local was leaked! from path: " + path);
  }
  HttpRequest request=ResteasyProviderFactory.getContextData(HttpRequest.class);
  if (request != null) {
    setFromPath.set(request.getUri().getPath());
  }
  currentEntityManager.set(entityManager);
  setWhere.set(new Exception());
}
