{
  IdentityManager idm=getIdm();
  if (cred.getType().equals(CredentialRepresentation.PASSWORD)) {
    Password password=new Password(cred.getValue());
    idm.updateCredential(((UserAdapter)user).getUser(),password);
  }
 else   if (cred.getType().equals(CredentialRepresentation.TOTP)) {
    TOTPCredential totp=new TOTPCredential(cred.getValue());
    totp.setDevice(cred.getDevice());
    idm.updateCredential(((UserAdapter)user).getUser(),totp);
  }
 else   if (cred.getType().equals(CredentialRepresentation.CLIENT_CERT)) {
    X509Certificate cert=null;
    try {
      cert=org.keycloak.PemUtils.decodeCertificate(cred.getValue());
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
    X509CertificateCredentials creds=new X509CertificateCredentials(cert);
    idm.updateCredential(((UserAdapter)user).getUser(),creds);
  }
}
