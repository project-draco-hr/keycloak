{
  Auth auth=getAuth(false);
  if (auth != null) {
    try {
      require(auth,AccountRoles.MANAGE_ACCOUNT);
    }
 catch (    ForbiddenException e) {
      return Flows.forms(realm,request,uriInfo).setError("No access").createErrorPage();
    }
    Account account=AccountLoader.load().createAccount(uriInfo).setRealm(realm).setUser(auth.getUser());
    String referrer=getReferrer();
    if (referrer != null) {
      account.setReferrer(referrer);
    }
    return account.createResponse(page);
  }
 else {
    return login(path);
  }
}
