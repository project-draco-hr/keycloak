{
  if (auth != null) {
    try {
      require(AccountRoles.MANAGE_ACCOUNT);
    }
 catch (    ForbiddenException e) {
      return Flows.forms(session,realm,null,uriInfo,headers).setError(Messages.NO_ACCESS).createErrorPage();
    }
    setReferrerOnPage();
    return account.createResponse(page);
  }
 else {
    return login(path);
  }
}
