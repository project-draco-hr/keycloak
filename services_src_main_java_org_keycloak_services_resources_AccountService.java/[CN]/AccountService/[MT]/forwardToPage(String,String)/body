{
  AuthenticationManager.Auth auth=getAuth(false);
  if (auth != null) {
    if (!hasAccess(auth)) {
      return noAccess();
    }
    FormFlows forms=Flows.forms(realm,request,uriInfo).setUser(auth.getUser());
    String referrer=getReferrer();
    if (referrer != null) {
      forms.setQueryParam("referrer",referrer);
    }
    return forms.forwardToForm(template);
  }
 else {
    return login(path);
  }
}
