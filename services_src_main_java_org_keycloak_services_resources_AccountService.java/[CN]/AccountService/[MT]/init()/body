{
  auditProvider=providers.getProvider(AuditProvider.class);
  account=AccountLoader.load().createAccount(uriInfo).setRealm(realm);
  boolean passwordUpdateSupported=false;
  UserModel user=authManager.authenticateRequest(realm,uriInfo,headers);
  if (user != null) {
    auth=new Auth(realm,user,application);
    account.setUser(auth.getUser());
    AuthenticationLinkModel authLinkModel=realm.getAuthenticationLink(auth.getUser());
    if (authLinkModel != null) {
      AuthenticationProviderModel authProviderModel=AuthenticationProviderManager.getConfiguredProviderModel(realm,authLinkModel.getAuthProvider());
      passwordUpdateSupported=authProviderModel.isPasswordUpdateSupported();
    }
  }
  account.setFeatures(realm.isSocial(),auditProvider != null,passwordUpdateSupported);
}
