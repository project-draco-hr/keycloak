{
  OAuthRedirect oauth=new OAuthRedirect();
  String authUrl=Urls.realmLoginPage(uriInfo.getBaseUri(),realm.getName()).toString();
  oauth.setAuthUrl(authUrl);
  oauth.setClientId(Constants.ACCOUNT_MANAGEMENT_APP);
  UriBuilder uriBuilder=Urls.accountPageBuilder(uriInfo.getBaseUri()).path(AccountService.class,"loginRedirect");
  if (path != null) {
    uriBuilder.queryParam("path",path);
  }
  String referrer=uriInfo.getQueryParameters().getFirst("referrer");
  if (referrer != null) {
    uriBuilder.queryParam("referrer",referrer);
  }
  String referrerUri=uriInfo.getQueryParameters().getFirst("referrer_uri");
  if (referrerUri != null) {
    uriBuilder.queryParam("referrer_uri",referrerUri);
  }
  URI accountUri=uriBuilder.build(realm.getName());
  oauth.setStateCookiePath(accountUri.getRawPath());
  return oauth.redirect(uriInfo,accountUri.toString());
}
