{
  AuthenticationManager.Auth auth=getAuth(true);
  if (!hasAccess(auth)) {
    return noAccess();
  }
  UserModel user=auth.getUser();
  String error=Validation.validateUpdateProfileForm(formData);
  if (error != null) {
    return Flows.forms(realm,request,uriInfo).setUser(user).setError(error).forwardToAccount();
  }
  user.setFirstName(formData.getFirst("firstName"));
  user.setLastName(formData.getFirst("lastName"));
  user.setEmail(formData.getFirst("email"));
  return Flows.forms(realm,request,uriInfo).setUser(user).setError("accountUpdated").setErrorType(FormFlows.MessageType.SUCCESS).forwardToAccount();
}
