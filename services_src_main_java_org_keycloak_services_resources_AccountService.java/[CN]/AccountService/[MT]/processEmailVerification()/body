{
  AccessCodeEntry accessCodeEntry=getAccessCodeEntry(RequiredAction.VERIFY_EMAIL);
  UserModel user=accessCodeEntry != null ? getUserFromAccessCode(accessCodeEntry) : null;
  if (user == null) {
    return Response.status(Status.FORBIDDEN).build();
  }
  user.setEmailVerified(true);
  user.removeRequiredAction(UserModel.RequiredAction.VERIFY_EMAIL);
  if (accessCodeEntry != null) {
    accessCodeEntry.getRequiredActions().remove(UserModel.RequiredAction.VERIFY_EMAIL);
  }
  Response response=redirectOauth(accessCodeEntry);
  if (response != null) {
    return response;
  }
 else {
    return Flows.forms(realm,request,uriInfo).setUser(user).forwardToVerifyEmail();
  }
}
