{
  return new Transaction<Response>(){
    protected Response callImpl(){
      UserModel user=authManager.authenticateIdentityCookie(realm,uriInfo,headers);
      if (user != null) {
        return Flows.forms(realm,request).setUser(user).forwardToSocial();
      }
 else {
        return Response.status(Status.FORBIDDEN).build();
      }
    }
  }
.call();
}
