{
  ClientModel client=AuthorizeClientUtil.authorizeClient(session,event).getClient();
  if (client.isPublicClient()) {
    Map<String,String> error=new HashMap<String,String>();
    error.put(OAuth2Constants.ERROR,"invalid_client");
    error.put(OAuth2Constants.ERROR_DESCRIPTION,"Public clients not allowed");
    event.error(Errors.INVALID_CLIENT);
    throw new BadRequestException("Public clients not allowed",javax.ws.rs.core.Response.status(javax.ws.rs.core.Response.Status.BAD_REQUEST).entity(error).type(MediaType.APPLICATION_JSON_TYPE).build());
  }
  return client;
}
