{
  IdentityProviderModel identityProviderModel=this.realmModel.getIdentityProviderById(providerId);
  if (identityProviderModel != null) {
    IdentityProviderFactory providerFactory=getIdentityProviderFactory(identityProviderModel);
    if (providerFactory == null) {
      throw new IdentityBrokerException("Could not find factory for identity provider [" + providerId + "].");
    }
    return providerFactory.create(identityProviderModel);
  }
  throw new IdentityBrokerException("Identity Provider [" + providerId + "] not found.");
}
