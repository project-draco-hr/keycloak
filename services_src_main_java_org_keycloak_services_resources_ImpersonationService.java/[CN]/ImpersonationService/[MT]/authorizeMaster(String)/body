{
  RealmModel possibleRealm=session.realms().getRealmByName(realmName);
  if (possibleRealm == null) {
    throw new NotFoundException("Could not find realm");
  }
  ClientModel realmAdminApp=realm.getClientByClientId(KeycloakModelUtils.getMasterRealmAdminApplicationClientId(possibleRealm));
  RoleModel role=realmAdminApp.getRole(ImpersonationServiceConstants.IMPERSONATION_ALLOWED);
  if (!auth.getUser().hasRole(role)) {
    throw new ForbiddenException("not authorized to access impersonation",ErrorPage.error(session,Messages.NO_ACCESS));
  }
}
