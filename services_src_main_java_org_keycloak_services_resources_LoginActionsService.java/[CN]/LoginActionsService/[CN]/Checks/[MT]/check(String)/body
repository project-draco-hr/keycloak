{
  if (!checkSsl()) {
    event.error(Errors.SSL_REQUIRED);
    response=ErrorPage.error(session,Messages.HTTPS_REQUIRED);
    return false;
  }
  if (!realm.isEnabled()) {
    event.error(Errors.REALM_DISABLED);
    response=ErrorPage.error(session,Messages.REALM_NOT_ENABLED);
    return false;
  }
  clientCode=ClientSessionCode.parse(code,session,realm);
  if (clientCode == null) {
    event.error(Errors.INVALID_CODE);
    response=ErrorPage.error(session,Messages.UNKNOWN_CODE);
    return false;
  }
  session.getContext().setClient(clientCode.getClientSession().getClient());
  return true;
}
