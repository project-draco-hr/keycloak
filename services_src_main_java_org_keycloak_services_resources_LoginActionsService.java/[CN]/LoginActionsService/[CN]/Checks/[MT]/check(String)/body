{
  if (!checkSsl()) {
    event.error(Errors.SSL_REQUIRED);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,"HTTPS required");
    return false;
  }
  if (!realm.isEnabled()) {
    event.error(Errors.REALM_DISABLED);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,"Realm not enabled.");
    return false;
  }
  clientCode=ClientSessionCode.parse(code,session,realm);
  if (clientCode == null) {
    event.error(Errors.INVALID_CODE);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,"Unknown code, please login again through your application.");
    return false;
  }
  return true;
}
