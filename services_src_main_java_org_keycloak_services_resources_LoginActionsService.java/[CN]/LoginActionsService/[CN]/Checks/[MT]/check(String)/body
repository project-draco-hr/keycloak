{
  if (!checkSsl()) {
    event.error(Errors.SSL_REQUIRED);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,headers,Messages.HTTPS_REQUIRED);
    return false;
  }
  if (!realm.isEnabled()) {
    event.error(Errors.REALM_DISABLED);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,headers,Messages.REALM_NOT_ENABLED);
    return false;
  }
  clientCode=ClientSessionCode.parse(code,session,realm);
  if (clientCode == null) {
    event.error(Errors.INVALID_CODE);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,headers,Messages.UNKNOWN_CODE);
    return false;
  }
  return true;
}
