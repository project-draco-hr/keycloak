{
  if (!check(code))   return false;
  if (!clientCode.isValid(requiredAction)) {
    event.error(Errors.INVALID_CODE);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,"Invalid code, please login again through your application.");
  }
  return true;
}
