{
  if (!check(code)) {
    return false;
  }
 else   if (!(clientCode.isValid(requiredAction) || clientCode.isValid(alternativeRequiredAction))) {
    event.error(Errors.INVALID_CODE);
    response=Flows.forwardToSecurityFailurePage(session,realm,uriInfo,headers,Messages.INVALID_CODE);
    return false;
  }
 else {
    return true;
  }
}
