{
  event.event(EventType.LOGIN).client(clientSession.getClient()).user(clientSession.getUserSession().getUser()).session(clientSession.getUserSession().getId()).detail(Details.CODE_ID,clientSession.getId()).detail(Details.REDIRECT_URI,clientSession.getRedirectUri()).detail(Details.USERNAME,clientSession.getNote(AbstractUsernameFormAuthenticator.ATTEMPTED_USERNAME)).detail(Details.RESPONSE_TYPE,"code");
  UserSessionModel userSession=clientSession.getUserSession();
  if (userSession != null) {
    event.detail(Details.AUTH_METHOD,userSession.getAuthMethod());
    event.detail(Details.USERNAME,userSession.getLoginUsername());
    if (userSession.isRememberMe()) {
      event.detail(Details.REMEMBER_ME,"true");
    }
  }
}
