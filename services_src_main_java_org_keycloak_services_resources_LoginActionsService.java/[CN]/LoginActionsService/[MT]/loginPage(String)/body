{
  event.event(EventType.LOGIN);
  Checks checks=new Checks();
  if (!checks.check(code)) {
    return checks.response;
  }
  event.detail(Details.CODE_ID,code);
  ClientSessionCode clientSessionCode=checks.clientCode;
  ClientSessionModel clientSession=clientSessionCode.getClientSession();
  if (clientSession.getAction().equals(ClientSessionModel.Action.RECOVER_PASSWORD.name())) {
    TokenManager.dettachClientSession(session.sessions(),realm,clientSession);
    clientSession.setAction(ClientSessionModel.Action.AUTHENTICATE.name());
  }
  AuthenticationFlowModel flow=realm.getFlowByAlias(DefaultAuthenticationFlows.BROWSER_FLOW);
  String flowId=flow.getId();
  AuthenticationProcessor processor=new AuthenticationProcessor();
  processor.setClientSession(clientSession).setFlowId(flowId).setConnection(clientConnection).setEventBuilder(event).setProtector(authManager.getProtector()).setRealm(realm).setSession(session).setUriInfo(uriInfo).setRequest(request);
  try {
    return processor.authenticate();
  }
 catch (  Exception e) {
    return processor.handleBrowserException(e);
  }
}
