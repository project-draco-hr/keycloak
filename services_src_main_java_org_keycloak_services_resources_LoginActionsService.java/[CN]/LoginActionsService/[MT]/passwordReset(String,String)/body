{
  event.event(EventType.RESET_PASSWORD);
  if (key != null) {
    Checks checks=new Checks();
    if (!checks.check(key,ClientSessionModel.Action.RECOVER_PASSWORD)) {
      return checks.response;
    }
    ClientSessionCode accessCode=checks.clientCode;
    accessCode.setRequiredAction(RequiredAction.UPDATE_PASSWORD);
    return Flows.forms(session,realm,null,uriInfo).setClientSessionCode(accessCode.getCode()).createResponse(RequiredAction.UPDATE_PASSWORD);
  }
 else {
    return Flows.forms(session,realm,null,uriInfo).setClientSessionCode(code).createPasswordReset();
  }
}
