{
  if (rep.getRequiredCredentials() == null) {
    throw new WebApplicationException(Response.status(Response.Status.BAD_REQUEST).entity("Realm credential requirements not defined").type("text/plain").build());
  }
  HashMap<String,UserRepresentation> userReps=new HashMap<String,UserRepresentation>();
  for (  UserRepresentation userRep : rep.getUsers())   userReps.put(userRep.getUsername(),userRep);
  for (  UserRepresentation userRep : rep.getUsers()) {
    if (userRep.getCredentials() == null) {
      userRep.setEnabled(false);
    }
 else {
      boolean hasBrowserCredentials=true;
      for (      RequiredCredentialRepresentation credential : rep.getRequiredCredentials()) {
        boolean hasCredential=false;
        for (        UserRepresentation.Credential cred : userRep.getCredentials()) {
          if (cred.getType().equals(credential.getType())) {
            hasCredential=true;
            break;
          }
        }
        if (!hasCredential) {
          hasBrowserCredentials=false;
          break;
        }
      }
      if (!hasBrowserCredentials) {
        userRep.setEnabled(false);
      }
    }
  }
  if (rep.getResources() != null) {
    for (    ResourceRepresentation resourceRep : rep.getResources()) {
      if (resourceRep.getRoleMappings() != null) {
        for (        RoleMappingRepresentation mapping : resourceRep.getRoleMappings()) {
          if (!userReps.containsKey(mapping.getUsername())) {
            throw new WebApplicationException(Response.status(Response.Status.BAD_REQUEST).entity("No users declared for role mapping").type("text/plain").build());
          }
        }
      }
    }
  }
}
