{
  RealmManager realmManager=new RealmManager(session);
  RealmModel realm=locateRealm(name,realmManager);
  ApplicationModel application=realm.getApplicationNameMap().get(Constants.ACCOUNT_MANAGEMENT_APP);
  if (application == null || !application.isEnabled()) {
    logger.debug("account management not enabled");
    throw new NotFoundException();
  }
  Audit audit=new AuditManager(realm,providers,clientConnection).createAudit();
  AccountService accountService=new AccountService(realm,application,tokenManager,socialRequestManager,audit);
  resourceContext.initResource(accountService);
  accountService.init();
  return accountService;
}
