{
  RealmManager realmManager=new RealmManager(session);
  RealmModel realm=locateRealm(name,realmManager);
  ApplicationModel application=realm.getApplicationNameMap().get(Constants.ACCOUNT_MANAGEMENT_APP);
  if (application == null || !application.isEnabled()) {
    logger.debug("account management not enabled");
    throw new NotFoundException("account management not enabled");
  }
  EventBuilder event=new EventsManager(realm,session,clientConnection).createEventBuilder();
  AccountService accountService=new AccountService(realm,application,event);
  ResteasyProviderFactory.getInstance().injectProperties(accountService);
  accountService.init();
  return accountService;
}
