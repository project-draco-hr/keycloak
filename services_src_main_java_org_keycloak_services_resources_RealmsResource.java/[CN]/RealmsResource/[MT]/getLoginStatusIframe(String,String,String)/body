{
  logger.info("getLoginStatusIframe");
  AuthenticationManager auth=new AuthenticationManager(providers);
  RealmManager realmManager=new RealmManager(session);
  RealmModel realm=locateRealm(name,realmManager);
  ClientModel client=realm.findClient(client_id);
  if (client == null) {
    throw new NotFoundException("could not find client: " + client_id);
  }
  AuthenticationManager.AuthResult result=auth.authenticateIdentityCookie(realm,uriInfo,headers);
  if (result == null) {
    throw new UnauthorizedException("not logged in, can't get page");
  }
  InputStream is=getClass().getClassLoader().getResourceAsStream("login-status-iframe.html");
  if (is == null)   throw new NotFoundException("Could not find login-status-iframe.html ");
  boolean valid=false;
  for (  String o : client.getWebOrigins()) {
    if (o.equals("*") || o.equals(origin)) {
      valid=true;
      break;
    }
  }
  for (  String r : TokenService.resolveValidRedirects(uriInfo,client.getRedirectUris())) {
    r=r.substring(0,r.indexOf('/',8));
    if (r.equals(origin)) {
      valid=true;
      break;
    }
  }
  if (!valid) {
    throw new BadRequestException("Invalid origin");
  }
  try {
    String file=StreamUtil.readString(is);
    return file.replace("ORIGIN",origin);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
