{
  RealmManager realmManager=new RealmManager(session);
  RealmModel realm=locateRealm(name,realmManager);
  EventBuilder event=new EventsManager(realm,session,clientConnection).createEventBuilder();
  AuthenticationManager authManager=new AuthenticationManager(protector);
  LoginProtocolFactory factory=(LoginProtocolFactory)session.getKeycloakSessionFactory().getProviderFactory(LoginProtocol.class,OIDCLoginProtocol.LOGIN_PROTOCOL);
  OIDCLoginProtocolService endpoint=(OIDCLoginProtocolService)factory.createProtocolEndpoint(realm,event,authManager);
  ResteasyProviderFactory.getInstance().injectProperties(endpoint);
  return endpoint.getLoginStatusIframe(client_id,origin);
}
