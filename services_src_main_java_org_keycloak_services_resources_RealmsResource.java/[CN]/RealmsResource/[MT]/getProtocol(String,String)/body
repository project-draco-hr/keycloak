{
  RealmManager realmManager=new RealmManager(session);
  RealmModel realm=locateRealm(name,realmManager);
  EventBuilder event=new EventBuilder(realm,session,clientConnection);
  AuthenticationManager authManager=new AuthenticationManager(protector);
  LoginProtocolFactory factory=(LoginProtocolFactory)session.getKeycloakSessionFactory().getProviderFactory(LoginProtocol.class,protocol);
  Object endpoint=factory.createProtocolEndpoint(realm,event,authManager);
  ResteasyProviderFactory.getInstance().injectProperties(endpoint);
  return endpoint;
}
