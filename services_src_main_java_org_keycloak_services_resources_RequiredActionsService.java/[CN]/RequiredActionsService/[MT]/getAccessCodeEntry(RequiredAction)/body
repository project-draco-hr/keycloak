{
  String code=uriInfo.getQueryParameters().getFirst(OAuth2Constants.CODE);
  if (code == null) {
    logger.debug("Code query param not found");
    return null;
  }
  AccessCode accessCode=AccessCode.parse(code,session,realm);
  if (accessCode == null) {
    logger.debug("Access code not found");
    return null;
  }
  if (!accessCode.isValid(requiredAction)) {
    logger.debugv("Invalid access code");
    return null;
  }
  return accessCode;
}
