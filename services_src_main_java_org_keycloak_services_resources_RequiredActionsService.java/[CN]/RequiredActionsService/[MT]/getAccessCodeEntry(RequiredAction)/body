{
  String code=uriInfo.getQueryParameters().getFirst(FormFlows.CODE);
  if (code == null) {
    return null;
  }
  JWSInput input=new JWSInput(code,providers);
  boolean verifiedCode=false;
  try {
    verifiedCode=RSAProvider.verify(input,realm.getPublicKey());
  }
 catch (  Exception ignored) {
    return null;
  }
  if (!verifiedCode) {
    return null;
  }
  String key=input.readContent(String.class);
  AccessCodeEntry accessCodeEntry=tokenManager.getAccessCode(key);
  if (accessCodeEntry == null) {
    return null;
  }
  if (accessCodeEntry.isExpired()) {
    return null;
  }
  if (accessCodeEntry.getRequiredActions() == null || !accessCodeEntry.getRequiredActions().contains(requiredAction)) {
    return null;
  }
  return accessCodeEntry;
}
