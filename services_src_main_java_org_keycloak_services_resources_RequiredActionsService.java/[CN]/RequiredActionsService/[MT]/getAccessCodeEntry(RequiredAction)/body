{
  String code=uriInfo.getQueryParameters().getFirst(OAuth2Constants.CODE);
  if (code == null) {
    logger.debug("getAccessCodeEntry code as not in query param");
    return null;
  }
  JWSInput input=new JWSInput(code);
  boolean verifiedCode=false;
  try {
    verifiedCode=RSAProvider.verify(input,realm.getPublicKey());
  }
 catch (  Exception ignored) {
    logger.debug("getAccessCodeEntry code failed verification");
    return null;
  }
  if (!verifiedCode) {
    logger.debug("getAccessCodeEntry code failed verification2");
    return null;
  }
  String key=input.readContentAsString();
  AccessCodeEntry accessCodeEntry=tokenManager.getAccessCode(key);
  if (accessCodeEntry == null) {
    logger.debug("getAccessCodeEntry access code entry null");
    return null;
  }
  if (accessCodeEntry.isExpired()) {
    logger.debugv("getAccessCodeEntry: access code id: {0}",accessCodeEntry.getId());
    logger.debugv("getAccessCodeEntry access code entry expired: {0}",accessCodeEntry.getExpiration());
    logger.debugv("getAccessCodeEntry current time: {0}",Time.currentTime());
    return null;
  }
  if (accessCodeEntry.getRequiredActions() == null || !accessCodeEntry.getRequiredActions().contains(requiredAction)) {
    logger.debugv("getAccessCodeEntry required actions null || entry does not contain required action: {0}|{1}",(accessCodeEntry.getRequiredActions() == null),!accessCodeEntry.getRequiredActions().contains(requiredAction));
    return null;
  }
  return accessCodeEntry;
}
