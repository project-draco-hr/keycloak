{
  String code=uriInfo.getQueryParameters().getFirst(OAuth2Constants.CODE);
  if (code == null) {
    logger.debug("getAccessCodeEntry code as not in query param");
    return null;
  }
  AccessCodeEntry accessCodeEntry=tokenManager.parseCode(code,session,realm);
  if (accessCodeEntry == null) {
    logger.debug("getAccessCodeEntry access code entry null");
    return null;
  }
  if (accessCodeEntry.isExpired()) {
    logger.debugv("getAccessCodeEntry: access code id: {0}",accessCodeEntry.getCodeId());
    logger.debugv("getAccessCodeEntry access code entry expired");
    return null;
  }
  if (accessCodeEntry.getRequiredActions() == null || !accessCodeEntry.getRequiredActions().contains(requiredAction)) {
    logger.debugv("getAccessCodeEntry required actions null || entry does not contain required action: {0}|{1}",(accessCodeEntry.getRequiredActions() == null),!accessCodeEntry.getRequiredActions().contains(requiredAction));
    return null;
  }
  return accessCodeEntry;
}
