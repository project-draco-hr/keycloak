{
  if (uriInfo.getQueryParameters().containsKey("key")) {
    AccessCode accessCode=AccessCode.parse(uriInfo.getQueryParameters().getFirst("key"),session,realm);
    if (accessCode == null || !accessCode.isValid(RequiredAction.UPDATE_PASSWORD)) {
      return unauthorized();
    }
    return Flows.forms(session,realm,null,uriInfo).setAccessCode(accessCode.getCode()).createResponse(RequiredAction.UPDATE_PASSWORD);
  }
 else {
    return Flows.forms(session,realm,null,uriInfo).createPasswordReset();
  }
}
