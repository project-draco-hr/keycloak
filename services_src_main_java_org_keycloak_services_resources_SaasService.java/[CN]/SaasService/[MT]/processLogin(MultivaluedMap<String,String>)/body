{
  logger.info("processLogin start");
  RealmManager realmManager=new RealmManager(session);
  RealmModel realm=realmManager.defaultRealm();
  if (realm == null)   throw new NotFoundException();
  if (!realm.isEnabled()) {
    throw new NotImplementedYetException();
  }
  String username=formData.getFirst("username");
  UserModel user=realm.getUser(username);
  AuthenticationStatus status=authManager.authenticateForm(realm,user,formData);
switch (status) {
case SUCCESS:
    NewCookie cookie=authManager.createSaasIdentityCookie(realm,user,uriInfo);
  return Response.status(302).cookie(cookie).location(contextRoot(uriInfo).path(adminPath).build()).build();
case ACCOUNT_DISABLED:
return Flows.forms(realm,request,uriInfo).setError(Messages.ACCOUNT_DISABLED).setFormData(formData).forwardToLogin();
case ACTIONS_REQUIRED:
return Flows.forms(realm,request,uriInfo).forwardToAction(user.getRequiredActions().iterator().next());
default :
return Flows.forms(realm,request,uriInfo).setError(Messages.INVALID_USER).setFormData(formData).forwardToLogin();
}
}
