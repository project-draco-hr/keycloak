{
  RealmManager realmManager=new RealmManager(session);
  RealmModel realm=realmManager.getRealmByName(realmName);
  EventBuilder event=new EventsManager(realm,session,clientConnection).createEventBuilder().event(EventType.LOGIN).client(clientId).detail(Details.REDIRECT_URI,redirectUri).detail(Details.RESPONSE_TYPE,"code").detail(Details.AUTH_METHOD,"social@" + providerId);
  SocialProvider provider=SocialLoader.load(providerId);
  if (provider == null) {
    event.error(Errors.SOCIAL_PROVIDER_NOT_FOUND);
    return Flows.forms(session,realm,null,uriInfo).setError("Social provider not found").createErrorPage();
  }
  ClientModel client=realm.findClient(clientId);
  if (client == null) {
    event.error(Errors.CLIENT_NOT_FOUND);
    return Flows.forms(session,realm,null,uriInfo).setError("Unknown login requester.").createErrorPage();
  }
  if (!client.isEnabled()) {
    event.error(Errors.CLIENT_DISABLED);
    return Flows.forms(session,realm,null,uriInfo).setError("Login requester not enabled.").createErrorPage();
  }
  redirectUri=TokenService.verifyRedirectUri(uriInfo,redirectUri,realm,client);
  if (redirectUri == null) {
    event.error(Errors.INVALID_REDIRECT_URI);
    return Flows.forms(session,realm,null,uriInfo).setError("Invalid redirect_uri.").createErrorPage();
  }
  try {
    return Flows.social(realm,uriInfo,clientConnection,provider).putClientAttribute(OAuth2Constants.CLIENT_ID,clientId).putClientAttribute(OAuth2Constants.SCOPE,scope).putClientAttribute(OAuth2Constants.STATE,state).putClientAttribute(OAuth2Constants.REDIRECT_URI,redirectUri).putClientAttribute(OAuth2Constants.RESPONSE_TYPE,responseType).redirectToSocialProvider();
  }
 catch (  Throwable t) {
    logger.error("Failed to redirect to social auth",t);
    return Flows.forms(session,realm,null,uriInfo).setError("Failed to redirect to social auth").createErrorPage();
  }
}
