{
  if (realm.isSslNotRequired()) {
    return true;
  }
  if (uriInfo.getBaseUri().getScheme().equals("https")) {
    return true;
  }
  if ("https".equals(headers.getHeaderString("X-Forwarded-Proto"))) {
    return true;
  }
  return false;
}
