{
  String redirect=formData.getFirst("redirect_uri");
  String state=formData.getFirst("state");
  if (formData.containsKey("cancel")) {
    return redirectAccessDenied(redirect,state);
  }
  String code=formData.getFirst("code");
  JWSInput input=new JWSInput(code,providers);
  boolean verifiedCode=false;
  try {
    verifiedCode=RSAProvider.verify(input,realm.getPublicKey());
  }
 catch (  Exception ignored) {
    logger.debug("Failed to verify signature",ignored);
  }
  if (!verifiedCode) {
    return redirectAccessDenied(redirect,state);
  }
  String key=input.readContent(String.class);
  AccessCodeEntry accessCodeEntry=tokenManager.getAccessCode(key);
  if (accessCodeEntry == null) {
    return redirectAccessDenied(redirect,state);
  }
  return redirectAccessCode(accessCodeEntry,state,redirect);
}
