{
  logger.info("**********registerPage()");
  OAuthFlows oauth=Flows.oauth(realm,request,uriInfo,authManager,tokenManager);
  if (!checkSsl()) {
    return oauth.forwardToSecurityFailure("HTTPS required");
  }
  if (!realm.isEnabled()) {
    logger.warn("Realm not enabled");
    return oauth.forwardToSecurityFailure("Realm not enabled");
  }
  UserModel client=realm.getUser(clientId);
  if (client == null) {
    logger.warn("Unknown login requester.");
    return oauth.forwardToSecurityFailure("Unknown login requester.");
  }
  if (!client.isEnabled()) {
    logger.warn("Login requester not enabled.");
    return oauth.forwardToSecurityFailure("Login requester not enabled.");
  }
  redirect=verifyRedirectUri(redirect,client);
  if (redirect == null) {
    return oauth.forwardToSecurityFailure("Invalid redirect_uri.");
  }
  if (!realm.isRegistrationAllowed()) {
    logger.warn("Registration not allowed");
    return oauth.forwardToSecurityFailure("Registration not allowed");
  }
  authManager.expireIdentityCookie(realm,uriInfo);
  return Flows.forms(realm,request,uriInfo).forwardToRegistration();
}
