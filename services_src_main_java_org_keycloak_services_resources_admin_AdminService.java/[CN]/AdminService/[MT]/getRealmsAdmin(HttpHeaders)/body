{
  RealmManager realmManager=new RealmManager(session);
  RealmModel saasRealm=getAdminstrationRealm(realmManager);
  if (saasRealm == null)   throw new NotFoundException();
  UserModel admin=authManager.authenticateSaasIdentity(saasRealm,uriInfo,headers);
  if (admin == null) {
    throw new NotAuthorizedException("Bearer");
  }
  ApplicationModel adminConsole=saasRealm.getApplicationNameMap().get(Constants.ADMIN_CONSOLE_APPLICATION);
  if (adminConsole == null) {
    throw new NotFoundException();
  }
  RoleModel adminRole=adminConsole.getRole(Constants.ADMIN_CONSOLE_ADMIN_ROLE);
  if (!saasRealm.hasRole(admin,adminRole)) {
    logger.warn("not a Realm admin");
    throw new NotAuthorizedException("Bearer");
  }
  RealmsAdminResource adminResource=new RealmsAdminResource(admin);
  resourceContext.initResource(adminResource);
  return adminResource;
}
