{
  RealmManager realmManager=new RealmManager(session);
  RealmModel realm=getAdminstrationRealm(realmManager);
  if (realm == null)   throw new NotFoundException("No realm found");
  Auth auth=authManager.authenticateCookie(realm,headers);
  if (auth == null) {
    logger.debug("No auth cookie");
    return Response.status(401).build();
  }
  UserModel user=auth.getUser();
  if (user == null) {
    return Response.status(401).build();
  }
  String displayName;
  if (user.getFirstName() != null || user.getLastName() != null) {
    displayName=user.getFirstName();
    if (user.getLastName() != null) {
      displayName=displayName != null ? displayName + " " + user.getLastName() : user.getLastName();
    }
  }
 else {
    displayName=user.getLoginName();
  }
  boolean createRealm=realm.hasRole(user,realm.getRole(AdminRoles.CREATE_REALM));
  Map<String,Set<String>> realmAccess=new HashMap<String,Set<String>>();
  addRealmAdminAccess(realmAccess,auth.getRealm().getRoleMappings(auth.getUser()));
  return Response.ok(new WhoAmI(user.getId(),Config.getAdminRealm(),displayName,createRealm,realmAccess)).build();
}
