{
  CertificateRepresentation info=getCertFromRequest(uriInfo,input);
  if (info.getPrivateKey() != null) {
    client.setAttribute(privateAttribute,info.getPrivateKey());
  }
 else   if (info.getCertificate() != null) {
    client.removeAttribute(privateAttribute);
  }
 else {
    throw new ErrorResponseException("certificate-not-found","Certificate or key with given alias not found in the keystore",Response.Status.BAD_REQUEST);
  }
  if (info.getCertificate() != null) {
    client.setAttribute(certificateAttribute,info.getCertificate());
  }
  adminEvent.operation(OperationType.ACTION).resourcePath(session.getContext().getUri()).representation(info).success();
  return info;
}
