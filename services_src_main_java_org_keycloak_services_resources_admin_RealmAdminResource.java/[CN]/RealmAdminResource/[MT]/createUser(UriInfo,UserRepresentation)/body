{
  return new Transaction(){
    @Override protected Response callImpl(){
      if (realm.getUser(rep.getUsername()) != null) {
        return Response.status(Response.Status.FOUND).build();
      }
      rep.setCredentials(null);
      UserManager userManager=new UserManager();
      UserModel userModel=userManager.createUser(realm,rep);
      return Response.created(uriInfo.getAbsolutePathBuilder().path(userModel.getLoginName()).build()).build();
    }
  }
.call();
}
