{
  return new Transaction(){
    @Override protected List<UserRepresentation> callImpl(){
      logger.info("queryUsers");
      Map<String,String> params=new HashMap<String,String>();
      MultivaluedMap<String,String> queryParameters=uriInfo.getQueryParameters();
      for (      String key : queryParameters.keySet()) {
        logger.info("   " + key + "="+ queryParameters.getFirst(key));
        params.put(key,queryParameters.getFirst(key));
      }
      List<UserModel> userModels=realm.queryUsers(params);
      List<UserRepresentation> users=new ArrayList<UserRepresentation>();
      for (      UserModel userModel : userModels) {
        users.add(UserManager.toRepresentation(userModel));
      }
      logger.info("   resultSet: " + users.size());
      return users;
    }
  }
.call();
}
