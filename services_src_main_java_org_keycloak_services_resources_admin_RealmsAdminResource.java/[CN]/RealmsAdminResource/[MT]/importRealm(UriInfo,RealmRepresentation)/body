{
  if (!auth.hasRealmRole(AdminRoles.ADMIN)) {
    throw new ForbiddenException();
  }
  logger.debug("importRealm: {0}",rep.getRealm());
  RealmManager realmManager=new RealmManager(session);
  if (realmManager.getRealmByName(rep.getRealm()) != null) {
    return Flows.errors().exists("Realm " + rep.getRealm() + " already exists");
  }
  RealmModel realm=realmManager.importRealm(rep);
  URI location=realmUrl(uriInfo).build(realm.getName());
  logger.debug("imported realm success, sending back: {0}",location.toString());
  return Response.created(location).build();
}
