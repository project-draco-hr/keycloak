{
  RealmManager realmManager=new RealmManager(session);
  realmManager.setContextPath(keycloak.getContextPath());
  if (!auth.getRealm().equals(realmManager.getKeycloakAdminstrationRealm())) {
    throw new ForbiddenException();
  }
  if (!auth.hasRealmRole(AdminRoles.CREATE_REALM)) {
    throw new ForbiddenException();
  }
  Map<String,List<InputPart>> uploadForm=input.getFormDataMap();
  List<InputPart> inputParts=uploadForm.get("file");
  for (  InputPart inputPart : inputParts) {
    RealmRepresentation rep=JsonSerialization.readValue(inputPart.getBodyAsString(),RealmRepresentation.class);
    RealmModel realm;
    try {
      realm=realmManager.importRealm(rep);
    }
 catch (    ModelDuplicateException e) {
      return Flows.errors().exists("Realm " + rep.getRealm() + " already exists");
    }
    grantPermissionsToRealmCreator(realm);
    if (inputParts.size() == 1) {
      URI location=AdminRoot.realmsUrl(uriInfo).path(realm.getName()).build();
      return Response.created(location).build();
    }
    event.event(EventType.CREATE_REALM).representation(rep).success();
  }
  return Response.noContent().build();
}
