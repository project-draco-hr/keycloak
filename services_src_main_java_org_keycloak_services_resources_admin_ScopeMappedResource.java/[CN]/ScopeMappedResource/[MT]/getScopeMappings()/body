{
  auth.requireView();
  MappingsRepresentation all=new MappingsRepresentation();
  Set<RoleModel> realmMappings=realm.getRealmScopeMappings(agent);
  RealmManager manager=new RealmManager(session);
  if (realmMappings.size() > 0) {
    List<RoleRepresentation> realmRep=new ArrayList<RoleRepresentation>();
    for (    RoleModel roleModel : realmMappings) {
      realmRep.add(ModelToRepresentation.toRepresentation(roleModel));
    }
    all.setRealmMappings(realmRep);
  }
  List<ApplicationModel> applications=realm.getApplications();
  if (applications.size() > 0) {
    Map<String,ApplicationMappingsRepresentation> appMappings=new HashMap<String,ApplicationMappingsRepresentation>();
    for (    ApplicationModel app : applications) {
      Set<RoleModel> roleMappings=app.getApplicationScopeMappings(agent);
      if (roleMappings.size() > 0) {
        ApplicationMappingsRepresentation mappings=new ApplicationMappingsRepresentation();
        mappings.setApplicationId(app.getId());
        mappings.setApplication(app.getName());
        List<RoleRepresentation> roles=new ArrayList<RoleRepresentation>();
        mappings.setMappings(roles);
        for (        RoleModel role : roleMappings) {
          roles.add(ModelToRepresentation.toRepresentation(role));
        }
        appMappings.put(app.getName(),mappings);
        all.setApplicationMappings(appMappings);
      }
    }
  }
  return all;
}
