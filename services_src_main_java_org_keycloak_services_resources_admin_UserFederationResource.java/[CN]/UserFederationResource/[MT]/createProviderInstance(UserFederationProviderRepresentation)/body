{
  auth.requireManage();
  String displayName=rep.getDisplayName();
  if (displayName != null && displayName.trim().equals("")) {
    displayName=null;
  }
  UserFederationProviderModel model=realm.addUserFederationProvider(rep.getProviderName(),rep.getConfig(),rep.getPriority(),displayName,rep.getFullSyncPeriod(),rep.getChangedSyncPeriod(),rep.getLastSync());
  new UsersSyncManager().refreshPeriodicSyncForProvider(session.getKeycloakSessionFactory(),session.getProvider(TimerProvider.class),model,realm.getId());
  checkKerberosCredential(model);
  event.event(EventType.CREATE_PROVIDER).detail(Details.PROVIDER_ID,model.getId()).detail(Details.PROVIDER_NAME,model.getProviderName()).success();
  return Response.created(uriInfo.getAbsolutePathBuilder().path(model.getId()).build()).build();
}
