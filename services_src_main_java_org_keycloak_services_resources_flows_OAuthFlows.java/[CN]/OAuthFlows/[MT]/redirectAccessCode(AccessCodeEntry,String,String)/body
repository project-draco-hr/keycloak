{
  UserModel client=realm.getUser(accessCode.getClient().getLoginName());
  Set<String> redirectUris=client.getRedirectUris();
  if (!redirectUris.isEmpty() && !redirectUris.contains(redirect)) {
    return forwardToSecurityFailure("Invalid redirect_uri " + redirect);
  }
  String code=accessCode.getCode();
  UriBuilder redirectUri=UriBuilder.fromUri(redirect).queryParam("code",code);
  log.debug("redirectAccessCode: state: {0}",state);
  if (state != null)   redirectUri.queryParam("state",state);
  Response.ResponseBuilder location=Response.status(302).location(redirectUri.build());
  if (realm.isCookieLoginAllowed()) {
    location.cookie(authManager.createLoginCookie(realm,accessCode.getUser(),uriInfo));
  }
  return location.build();
}
