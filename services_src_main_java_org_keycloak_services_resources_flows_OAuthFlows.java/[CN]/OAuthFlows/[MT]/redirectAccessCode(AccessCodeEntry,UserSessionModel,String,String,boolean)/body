{
  String code=accessCode.getCode();
  UriBuilder redirectUri=UriBuilder.fromUri(redirect).queryParam(OAuth2Constants.CODE,code);
  log.debugv("redirectAccessCode: state: {0}",state);
  if (state != null)   redirectUri.queryParam(OAuth2Constants.STATE,state);
  Response.ResponseBuilder location=Response.status(302).location(redirectUri.build());
  Cookie remember=request.getHttpHeaders().getCookies().get(AuthenticationManager.KEYCLOAK_REMEMBER_ME);
  rememberMe=rememberMe || remember != null;
  authManager.createLoginCookie(realm,accessCode.getUser(),session,uriInfo,rememberMe);
  if (rememberMe)   authManager.createRememberMeCookie(realm,uriInfo);
  return location.build();
}
