{
  KeycloakSession session=sessionFactory.create();
  try {
    runTask(session);
  }
 catch (  Throwable t) {
    logger.failedToRunScheduledTask(t,task.getClass().getSimpleName());
    session.getTransactionManager().rollback();
  }
 finally {
    try {
      session.close();
    }
 catch (    Throwable t) {
      logger.failedToCloseProviderSession(t);
    }
  }
}
