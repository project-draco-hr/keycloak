{
  Set<String> mapping=realm.getScope(client);
  if (!mapping.contains("*")) {
    throw new ForbiddenException(Response.status(403).entity("<h1>Security Alert</h1><p>Known client not authorized to request a user login.</p>").type("text/html").build());
  }
  SkeletonKeyToken token=createAccessToken(realm,user);
  token.issuedFor(client.getLoginName());
  return token;
}
