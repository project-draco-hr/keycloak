{
  deployment=new ResteasyDeployment();
  deployment.setApplicationClass(KeycloakApplication.class.getName());
  server=new UndertowJaxrsServer().start();
  DeploymentInfo di=server.undertowDeployment(deployment);
  di.setClassLoader(AbstractKeycloakServerTest.class.getClassLoader());
  di.setContextPath("/");
  di.setDeploymentName("Keycloak");
  FilterInfo filter=Servlets.filter("SessionFilter",KeycloakSessionServletFilter.class);
  di.addFilter(filter);
  di.addFilterUrlMapping("SessionFilter","/*",DispatcherType.REQUEST);
  server.deploy(di);
  application=(KeycloakApplication)deployment.getApplication();
  client=new ResteasyClientBuilder().connectionPoolSize(10).build();
  client.register(SkeletonKeyContextResolver.class);
}
