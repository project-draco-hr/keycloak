{
  try {
    JsonNode profile=SimpleHttp.doGet(PROFILE_URL).header("Authorization","Bearer " + accessToken).asJson();
    JsonNode id=profile.get("id");
    JsonNode username=profile.get("username");
    JsonNode email=profile.get("email");
    if (username == null)     username=email == null ? id : email;
    SocialUser user=new SocialUser(id.getTextValue(),username.getTextValue());
    user.setName(profile.has("first_name") ? profile.get("first_name").getTextValue() : null,profile.has("last_name") ? profile.get("last_name").getTextValue() : null);
    user.setEmail(profile.has("email") ? email.getTextValue() : null);
    return user;
  }
 catch (  Exception e) {
    throw new SocialProviderException(e);
  }
}
