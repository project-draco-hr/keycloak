{
  if (callback.getQueryParam("denied") != null) {
    throw new SocialAccessDeniedException();
  }
  try {
    Twitter twitter=new TwitterFactory().getInstance();
    twitter.setOAuthConsumer(config.getKey(),config.getSecret());
    String token=callback.getQueryParam("oauth_token");
    String verifier=callback.getQueryParam("oauth_verifier");
    String twitterToken=clientSession.getNote("twitter_token");
    String twitterSecret=clientSession.getNote("twitter_tokenSecret");
    RequestToken requestToken=new RequestToken(twitterToken,twitterSecret);
    twitter.getOAuthAccessToken(requestToken,verifier);
    twitter4j.User twitterUser=twitter.verifyCredentials();
    SocialUser user=new SocialUser(Long.toString(twitterUser.getId()),twitterUser.getScreenName());
    user.setName(twitterUser.getName());
    return user;
  }
 catch (  Exception e) {
    throw new SocialProviderException(e);
  }
}
