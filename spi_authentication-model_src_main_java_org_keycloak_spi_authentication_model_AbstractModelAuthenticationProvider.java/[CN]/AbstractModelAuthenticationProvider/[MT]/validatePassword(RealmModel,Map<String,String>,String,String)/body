{
  RealmModel realm=getRealm(currentRealm,config);
  UserModel user=KeycloakModelUtils.findUserByNameOrEmail(realm,username);
  if (user == null) {
    return new AuthResult(AuthProviderStatus.USER_NOT_FOUND);
  }
  boolean result=realm.validatePassword(user,password);
  if (!result) {
    return new AuthResult(AuthProviderStatus.INVALID_CREDENTIALS);
  }
  AuthenticatedUser authUser=createAuthenticatedUserInstance(user);
  return new AuthResult(AuthProviderStatus.SUCCESS).setProviderName(getName()).setUser(authUser);
}
