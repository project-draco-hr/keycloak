{
  List<AuthenticationProviderModel> configuredProviders=getConfiguredProviders(realm);
  boolean userExists=false;
  for (  AuthenticationProviderModel authProviderConfig : configuredProviders) {
    String providerName=authProviderConfig.getProviderName();
    AuthenticationProvider delegate=getDelegate(providerName);
    if (delegate == null) {
      continue;
    }
    try {
      AuthResult currentResult=delegate.validatePassword(realm,authProviderConfig.getConfig(),username,password);
      logger.debugf("Authentication provider '%s' finished with '%s' for authentication of '%s'",delegate.getName(),currentResult.getAuthProviderStatus().toString(),username);
      if (currentResult.getAuthProviderStatus() == AuthProviderStatus.SUCCESS) {
        return currentResult;
      }
 else       if (currentResult.getAuthProviderStatus() == AuthProviderStatus.INVALID_CREDENTIALS) {
        userExists=true;
      }
    }
 catch (    AuthenticationProviderException ape) {
      logger.warn(ape.getMessage(),ape);
    }
  }
  AuthProviderStatus status=userExists ? AuthProviderStatus.INVALID_CREDENTIALS : AuthProviderStatus.USER_NOT_FOUND;
  logger.debugf("Not able to authenticate '%s' with any authentication provider. Status: '%s'",username,status.toString());
  return new AuthResult(status);
}
