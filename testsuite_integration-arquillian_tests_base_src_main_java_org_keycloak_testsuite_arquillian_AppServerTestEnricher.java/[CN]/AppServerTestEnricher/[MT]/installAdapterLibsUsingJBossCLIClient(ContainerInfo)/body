{
  if (!appServerInfo.isAdapterLibsInstalled()) {
    if (!appServerInfo.isJBossBased()) {
      throw new IllegalArgumentException("App server must be JBoss-based to run jboss-cli-client.");
    }
    String jbossHomePath=appServerInfo.getProperties().get("jbossHome");
    File bin=new File(jbossHomePath + "/bin");
    File clientJar=new File(jbossHomePath + "/bin/client/jboss-cli-client.jar");
    if (!clientJar.exists()) {
      clientJar=new File(jbossHomePath + "/bin/client/jboss-client.jar");
    }
    if (!clientJar.exists()) {
      throw new IOException("JBoss CLI client JAR not found.");
    }
    String command="java -jar " + clientJar.getAbsolutePath();
    String adapterScript="adapter-install.cli";
    String samlAdapterScript="adapter-install-saml.cli";
    String managementPort=appServerInfo.getProperties().get("managementPort");
    String controllerArg=" --controller=localhost:" + managementPort;
    if (new File(bin,adapterScript).exists()) {
      log.info("Installing adapter to app server via cli script");
      execCommand(command + " --connect --file=" + adapterScript+ controllerArg,bin);
    }
    if (new File(bin,samlAdapterScript).exists()) {
      log.info("Installing saml adapter to app server via cli script");
      execCommand(command + " --connect --file=" + samlAdapterScript+ controllerArg,bin);
    }
    if (new File(bin,adapterScript).exists() || new File(bin,samlAdapterScript).exists()) {
      log.info("Restarting container");
      execCommand(command + " --connect --command=reload" + controllerArg,bin);
      log.info("Container restarted");
      pause(5000);
      if (System.getProperty("app.server.log.check","true").equals("true")) {
        LogChecker.checkJBossServerLog(jbossHomePath);
      }
    }
    appServerInfo.setAdapterLibsInstalled(true);
  }
}
