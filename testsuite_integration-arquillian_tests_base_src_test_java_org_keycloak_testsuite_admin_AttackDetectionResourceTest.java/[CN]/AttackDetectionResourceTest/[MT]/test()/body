{
  AttackDetectionResource detection=adminClient.realm("test").attackDetection();
  assertBruteForce(detection.bruteForceUserStatus("test-user@localhost"),0,false,false);
  oauthClient.doLogin("test-user@localhost","invalid");
  oauthClient.doLogin("test-user@localhost","invalid");
  oauthClient.doLogin("test-user@localhost","invalid");
  oauthClient.doLogin("test-user2","invalid");
  oauthClient.doLogin("test-user2","invalid");
  oauthClient.doLogin("nosuchuser","invalid");
  assertBruteForce(detection.bruteForceUserStatus("test-user@localhost"),3,true,true);
  assertBruteForce(detection.bruteForceUserStatus("test-user2"),2,true,true);
  assertBruteForce(detection.bruteForceUserStatus("nosuchuser"),0,false,false);
  detection.clearBruteForceForUser("test-user@localhost");
  assertAdminEvents.assertEvent("test",OperationType.DELETE,AdminEventPaths.attackDetectionClearBruteForceForUserPath("test-user@localhost"));
  assertBruteForce(detection.bruteForceUserStatus("test-user@localhost"),0,false,false);
  assertBruteForce(detection.bruteForceUserStatus("test-user2"),2,true,true);
  detection.clearAllBruteForce();
  assertAdminEvents.assertEvent("test",OperationType.DELETE,AdminEventPaths.attackDetectionClearAllBruteForcePath());
  assertBruteForce(detection.bruteForceUserStatus("test-user@localhost"),0,false,false);
  assertBruteForce(detection.bruteForceUserStatus("test-user2"),0,false,false);
}
