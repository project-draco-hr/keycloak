{
  String realmInfoUrl=KeycloakUriBuilder.fromUri(getAuthServerRoot()).path(ServiceUrlConstants.REALM_INFO_PATH).build(REALM_NAME).toString();
  PrivateKey privateKey=KeycloakModelUtils.getPrivateKey(privateKeyPem);
  JWTClientCredentialsProvider jwtProvider=new JWTClientCredentialsProvider(){
    @Override protected JsonWebToken createRequestToken(    String clientId,    String realmInfoUrl){
      JsonWebToken jwt=super.createRequestToken(clientId,realmInfoUrl);
      String tokenEndpointUrl=OIDCLoginProtocolService.tokenUrl(UriBuilder.fromUri(getAuthServerRoot())).build(REALM_NAME).toString();
      jwt.audience(tokenEndpointUrl);
      return jwt;
    }
  }
;
  jwtProvider.setPrivateKey(privateKey);
  jwtProvider.setTokenTimeout(10);
  return jwtProvider.createSignedRequestToken(clientId,realmInfoUrl);
}
