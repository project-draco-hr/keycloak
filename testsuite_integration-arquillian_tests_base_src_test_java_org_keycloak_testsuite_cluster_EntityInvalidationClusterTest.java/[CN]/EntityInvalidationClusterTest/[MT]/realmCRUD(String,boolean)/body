{
  log.info("Creating realm on : " + getCurrentFailNode());
  RealmRepresentation testRealm=new RealmRepresentation();
  testRealm.setRealm(realmName);
  testRealm.setEnabled(true);
  getAdminClientFor(getCurrentFailNode()).realms().create(testRealm);
  RealmRepresentation testRealmOnFailNode=getAdminClientFor(getCurrentFailNode()).realms().realm(realmName).toRepresentation();
  assertEquals(testRealmOnFailNode.getRealm(),testRealm.getRealm());
  if (backendFailover) {
    failure();
  }
  for (  ContainerInfo survivorNode : getCurrentSurvivorNodes()) {
    RealmRepresentation testRealmOnSurvivorNode=getAdminClientFor(survivorNode).realms().realm(realmName).toRepresentation();
    assertEquals(testRealmOnFailNode.getId(),testRealmOnSurvivorNode.getId());
    assertEquals(testRealmOnFailNode.getRealm(),testRealmOnSurvivorNode.getRealm());
    log.info("Creation on survivor: " + survivorNode + " verified");
  }
  failback();
  iterateCurrentFailNode();
  log.info("Updating realm on: " + getCurrentFailNode());
  String realmBeforeUpdate=realmName;
  realmName+="_updated";
  testRealm=testRealmOnFailNode;
  testRealm.setRealm(realmName);
  getAdminClientFor(getCurrentFailNode()).realms().realm(realmBeforeUpdate).update(testRealm);
  testRealmOnFailNode=getAdminClientFor(getCurrentFailNode()).realms().realm(realmName).toRepresentation();
  assertEquals(testRealmOnFailNode.getRealm(),testRealm.getRealm());
  if (backendFailover) {
    failure();
  }
  for (  ContainerInfo survivorNode : getCurrentSurvivorNodes()) {
    RealmRepresentation testRealmOnSurvivorNode=getAdminClientFor(survivorNode).realms().realm(realmName).toRepresentation();
    assertEquals(testRealmOnFailNode.getId(),testRealmOnSurvivorNode.getId());
    assertEquals(testRealmOnFailNode.getRealm(),testRealmOnSurvivorNode.getRealm());
    log.info("Update on survivor: " + survivorNode + " verified");
  }
  failback();
  iterateCurrentFailNode();
  log.info("Deleting realm on: " + getCurrentFailNode());
  getAdminClientFor(getCurrentFailNode()).realms().realm(realmName).remove();
  if (backendFailover) {
    failure();
  }
  boolean realmStillExists=false;
  for (  ContainerInfo survivorNode : getCurrentSurvivorNodes()) {
    boolean realmStillExistsOnSurvivor=false;
    for (    RealmRepresentation realmOnSurvivorNode : getAdminClientFor(survivorNode).realms().findAll()) {
      if (realmName.equals(realmOnSurvivorNode.getRealm()) || testRealmOnFailNode.getId().equals(realmOnSurvivorNode.getId())) {
        realmStillExistsOnSurvivor=true;
        realmStillExists=true;
        break;
      }
    }
    log.error("Deletion on survivor: " + survivorNode + (realmStillExistsOnSurvivor ? " FAILED" : " verified"));
  }
  assertFalse(realmStillExists);
}
