{
  RealmRepresentation testRealm=new RealmRepresentation();
  testRealm.setRealm(realm);
  testRealm.setEnabled(true);
  log.info("Creating test realm via node1.");
  backend1AdminClient().realms().create(testRealm);
  log.info("Test realm created.");
  RealmRepresentation testRealmOnBackend1=backend1AdminClient().realms().realm(realm).toRepresentation();
  assertEquals(testRealmOnBackend1.getRealm(),testRealm.getRealm());
  if (containerFailover) {
    stopBackend1();
  }
  RealmRepresentation testRealmOnBackend2=backend2AdminClient().realms().realm(realm).toRepresentation();
  assertEquals(testRealmOnBackend1.getId(),testRealmOnBackend2.getId());
  assertEquals(testRealmOnBackend1.getRealm(),testRealmOnBackend2.getRealm());
  failback();
  testRealmOnBackend2.setRealm(realm + "_updated");
  backend2AdminClient().realms().realm(realm).update(testRealmOnBackend2);
  if (containerFailover) {
    stopBackend2();
  }
  testRealmOnBackend1=backend1AdminClient().realms().realm(realm).toRepresentation();
  assertEquals(testRealmOnBackend1.getId(),testRealmOnBackend2.getId());
  assertEquals(testRealmOnBackend1.getRealm(),testRealmOnBackend2.getRealm());
  failback();
  backend1AdminClient().realms().realm(realm).remove();
  if (containerFailover) {
    stopBackend1();
  }
  boolean testRealmOnBackend2Exists=false;
  for (  RealmRepresentation realmOnBackend2 : backend2AdminClient().realms().findAll()) {
    if (realm.equals(realmOnBackend2.getRealm()) || testRealmOnBackend1.getId().equals(realmOnBackend2.getId())) {
      testRealmOnBackend2Exists=true;
      break;
    }
  }
  assertFalse(testRealmOnBackend2Exists);
}
