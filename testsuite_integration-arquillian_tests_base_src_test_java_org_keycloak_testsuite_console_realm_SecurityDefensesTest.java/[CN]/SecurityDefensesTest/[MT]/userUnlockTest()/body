{
  bruteForceDetectionPage.form().setProtectionEnabled(true);
  bruteForceDetectionPage.form().setMaxLoginFailures("1");
  bruteForceDetectionPage.form().setWaitIncrementSelect(SecurityDefenses.TimeSelectValues.MINUTES);
  bruteForceDetectionPage.form().setWaitIncrementInput("10");
  bruteForceDetectionPage.form().save();
  assertFlashMessageSuccess();
  testRealmAccountPage.navigateTo();
  setPasswordFor(testUser,PASSWORD + "-mismatch");
  testRealmLoginPage.form().login(testUser);
  usersPage.navigateTo();
  usersPage.table().searchUsers(testUser.getUsername());
  usersPage.table().editUser(testUser.getUsername());
  userAttributesPage.form().unlockUser();
  testRealmAccountPage.navigateTo();
  setPasswordFor(testUser,PASSWORD);
  testRealmLoginPage.form().login(testUser);
  assertCurrentUrlStartsWith(testRealmAccountPage);
}
