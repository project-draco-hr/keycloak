{
  KeycloakSession session=factory.createSession();
  session.getTransaction().begin();
  try {
    RealmManager manager=new RealmManager(session);
    if (manager.getRealm(RealmModel.DEFAULT_REALM) != null) {
      return;
    }
    RealmModel defaultRealm=manager.createRealm(RealmModel.DEFAULT_REALM,RealmModel.DEFAULT_REALM);
    manager.generateRealmKeys(defaultRealm);
    defaultRealm.setEnabled(true);
    defaultRealm.setTokenLifespan(300);
    defaultRealm.setAccessCodeLifespan(60);
    defaultRealm.setAccessCodeLifespanUserAction(600);
    defaultRealm.setSslNotRequired(false);
    defaultRealm.setCookieLoginAllowed(true);
    defaultRealm.setRegistrationAllowed(true);
    defaultRealm.setAutomaticRegistrationAfterSocialLogin(false);
    defaultRealm.setVerifyEmail(false);
    defaultRealm.addRequiredCredential(CredentialRepresentation.PASSWORD);
    RoleModel role=defaultRealm.addRole(SaasService.REALM_CREATOR_ROLE);
    UserModel admin=defaultRealm.addUser("admin");
    defaultRealm.grantRole(admin,role);
    session.getTransaction().commit();
  }
  finally {
    session.close();
  }
}
