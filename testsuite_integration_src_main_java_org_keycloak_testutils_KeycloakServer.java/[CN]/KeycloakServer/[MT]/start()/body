{
  long start=System.currentTimeMillis();
  ResteasyDeployment deployment=new ResteasyDeployment();
  deployment.setApplicationClass(KeycloakApplication.class.getName());
  Builder builder=Undertow.builder().addListener(config.getPort(),config.getHost());
  server=new UndertowJaxrsServer().start(builder);
  DeploymentInfo di=server.undertowDeployment(deployment,"rest");
  di.setClassLoader(getClass().getClassLoader());
  di.setContextPath("/auth");
  di.setDeploymentName("Keycloak");
  di.setResourceManager(new KeycloakResourceManager(config.getResourcesHome()));
  di.setDefaultServletConfig(new DefaultServletConfig(true));
  di.addWelcomePage("index.html");
  FilterInfo filter=Servlets.filter("SessionFilter",KeycloakSessionServletFilter.class);
  di.addFilter(filter);
  di.addFilterUrlMapping("SessionFilter","/rest/*",DispatcherType.REQUEST);
  ServletInfo tmpAdminRedirectServlet=Servlets.servlet("TmpAdminRedirectServlet",TmpAdminRedirectServlet.class);
  tmpAdminRedirectServlet.addMappings("/admin","/admin/");
  di.addServlet(tmpAdminRedirectServlet);
  server.deploy(di);
  factory=((KeycloakApplication)deployment.getApplication()).getFactory();
  setupDevConfig();
  if (config.getResourcesHome() != null) {
    info("Loading resources from " + config.getResourcesHome());
  }
  info("Started Keycloak (http://" + config.getHost() + ":"+ config.getPort()+ "/auth) in "+ (System.currentTimeMillis() - start)+ " ms\n");
}
