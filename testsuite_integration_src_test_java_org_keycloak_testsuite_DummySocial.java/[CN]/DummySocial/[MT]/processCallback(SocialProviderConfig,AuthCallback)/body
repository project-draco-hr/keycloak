{
  if (!callback.getQueryParam("state").equals(callback.getAttribute("state"))) {
    throw new SocialProviderException("Invalid state");
  }
  String username=callback.getQueryParam("username");
  SocialUser user=new SocialUser(username);
  user.setName(callback.getQueryParam("firstname"),callback.getQueryParam("lastname"));
  user.setEmail(callback.getQueryParam("email"));
  return user;
}
