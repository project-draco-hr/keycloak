{
  String error=callback.getQueryParam("error");
  if (error != null) {
    throw new SocialAccessDeniedException();
  }
  if (!callback.getQueryParam("state").equals(callback.getAttribute("state"))) {
    throw new SocialProviderException("Invalid state");
  }
  String id=callback.getQueryParam("id");
  String username=callback.getQueryParam("username");
  SocialUser user=new SocialUser(id,username);
  user.setName(callback.getQueryParam("firstname"),callback.getQueryParam("lastname"));
  user.setEmail(callback.getQueryParam("email"));
  return user;
}
