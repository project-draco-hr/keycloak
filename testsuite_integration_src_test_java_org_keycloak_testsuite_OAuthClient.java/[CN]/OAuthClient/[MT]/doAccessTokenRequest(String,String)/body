{
  HttpClient client=new DefaultHttpClient();
  HttpPost post=new HttpPost(getAccessTokenUrl());
  List<NameValuePair> parameters=new LinkedList<NameValuePair>();
  if (grantType != null) {
    parameters.add(new BasicNameValuePair("grant_type",grantType));
  }
  if (code != null) {
    parameters.add(new BasicNameValuePair("code",code));
  }
  if (redirectUri != null) {
    parameters.add(new BasicNameValuePair("redirect_uri",redirectUri));
  }
  if (clientId != null) {
    parameters.add(new BasicNameValuePair("client_id",clientId));
  }
  if (password != null) {
    parameters.add(new BasicNameValuePair("password",password));
  }
  UrlEncodedFormEntity formEntity=new UrlEncodedFormEntity(parameters,Charset.forName("UTF-8"));
  post.setEntity(formEntity);
  try {
    return new AccessTokenResponse(client.execute(post));
  }
 catch (  Exception e) {
    throw new AssertionError("Failed to retrieve access token",e);
  }
}
