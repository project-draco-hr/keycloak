{
  updateProfilePage.update("New first","New last","new@email.com");
  AssertEvents.ExpectedEvent expectedEvent=events.expectRequiredAction("update_profile");
  if (sessionId != null) {
    expectedEvent.session(sessionId);
  }
  sessionId=expectedEvent.assertEvent().getSessionId();
  events.expectRequiredAction("update_email").session(sessionId).detail(Details.PREVIOUS_EMAIL,"test-user@localhost").detail(Details.UPDATED_EMAIL,"new@email.com").assertEvent();
  return sessionId;
}
