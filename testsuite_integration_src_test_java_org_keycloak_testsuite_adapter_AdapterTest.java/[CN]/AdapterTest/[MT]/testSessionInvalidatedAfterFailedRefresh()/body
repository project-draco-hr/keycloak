{
  final AtomicInteger origTokenLifespan=new AtomicInteger();
  keycloakRule.update(new KeycloakRule.KeycloakSetup(){
    @Override public void config(    RealmManager manager,    RealmModel adminstrationRealm,    RealmModel demoRealm){
      ApplicationModel sessionPortal=demoRealm.getApplicationByName("session-portal");
      sessionPortal.setManagementUrl(null);
      origTokenLifespan.set(demoRealm.getAccessTokenLifespan());
      demoRealm.setAccessTokenLifespan(1);
    }
  }
,"demo");
  loginAndCheckSession(driver,loginPage);
  String logoutUri=OpenIDConnectService.logoutUrl(UriBuilder.fromUri("http://localhost:8081/auth")).queryParam(OAuth2Constants.REDIRECT_URI,"http://localhost:8081/session-portal").build("demo").toString();
  driver.navigate().to(logoutUri);
  Thread.sleep(2000);
  driver.navigate().to("http://localhost:8081/session-portal");
  Assert.assertTrue(driver.getCurrentUrl().startsWith(LOGIN_URL));
  loginPage.login("bburke@redhat.com","password");
  Assert.assertEquals(driver.getCurrentUrl(),"http://localhost:8081/session-portal");
  String pageSource=driver.getPageSource();
  Assert.assertTrue(pageSource.contains("Counter=1"));
  keycloakRule.update(new KeycloakRule.KeycloakSetup(){
    @Override public void config(    RealmManager manager,    RealmModel adminstrationRealm,    RealmModel demoRealm){
      ApplicationModel sessionPortal=demoRealm.getApplicationByName("session-portal");
      sessionPortal.setManagementUrl("http://localhost:8081/session-portal");
      demoRealm.setAccessTokenLifespan(origTokenLifespan.get());
    }
  }
,"demo");
}
