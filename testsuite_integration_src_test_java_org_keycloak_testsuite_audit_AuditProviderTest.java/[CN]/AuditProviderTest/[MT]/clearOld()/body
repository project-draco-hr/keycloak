{
  audit.onEvent(create(System.currentTimeMillis() - 30000,EventType.LOGIN,"realmId","clientId","userId","127.0.0.1","error"));
  audit.onEvent(create(System.currentTimeMillis() - 20000,EventType.LOGIN,"realmId","clientId","userId","127.0.0.1","error"));
  audit.onEvent(create(System.currentTimeMillis(),EventType.LOGIN,"realmId","clientId","userId","127.0.0.1","error"));
  audit.onEvent(create(System.currentTimeMillis(),EventType.LOGIN,"realmId","clientId","userId","127.0.0.1","error"));
  audit.onEvent(create(System.currentTimeMillis() - 30000,EventType.LOGIN,"realmId2","clientId","userId","127.0.0.1","error"));
  resetSession();
  audit.clear("realmId",System.currentTimeMillis() - 10000);
  Assert.assertEquals(3,audit.createQuery().getResultList().size());
}
