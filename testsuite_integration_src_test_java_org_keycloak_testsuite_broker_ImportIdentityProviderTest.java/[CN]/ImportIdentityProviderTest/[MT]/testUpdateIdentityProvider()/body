{
  RealmModel realm=installTestRealm();
  List<IdentityProviderModel> identityProviders=realm.getIdentityProviders();
  assertFalse(identityProviders.isEmpty());
  IdentityProviderModel identityProviderModel=identityProviders.get(0);
  String identityProviderId=identityProviderModel.getId();
  identityProviderModel.setName("Changed Name");
  identityProviderModel.getConfig().put("config-added","value-added");
  identityProviderModel.setEnabled(false);
  identityProviderModel.setUpdateProfileFirstLogin(false);
  identityProviderModel.setStoreToken(true);
  identityProviderModel.setAuthenticateByDefault(true);
  realm.updateIdentityProvider(identityProviderModel);
  commit();
  realm=this.realmManager.getRealm(realm.getId());
  identityProviderModel=realm.getIdentityProviderById(identityProviderId);
  assertEquals("Changed Name",identityProviderModel.getName());
  assertEquals("value-added",identityProviderModel.getConfig().get("config-added"));
  assertFalse(identityProviderModel.isEnabled());
  assertFalse(identityProviderModel.isUpdateProfileFirstLogin());
  assertTrue(identityProviderModel.isStoreToken());
  assertTrue(identityProviderModel.isAuthenticateByDefault());
  identityProviderModel.setName("Changed Name Again");
  identityProviderModel.getConfig().remove("config-added");
  identityProviderModel.setEnabled(true);
  identityProviderModel.setUpdateProfileFirstLogin(true);
  identityProviderModel.setAuthenticateByDefault(false);
  realm.updateIdentityProvider(identityProviderModel);
  commit();
  realm=this.realmManager.getRealm(realm.getId());
  identityProviderModel=realm.getIdentityProviderById(identityProviderId);
  assertEquals("Changed Name Again",identityProviderModel.getName());
  assertFalse(identityProviderModel.getConfig().containsKey("config-added"));
  assertTrue(identityProviderModel.isEnabled());
  assertTrue(identityProviderModel.isUpdateProfileFirstLogin());
  assertFalse(identityProviderModel.isAuthenticateByDefault());
  this.realmManager.removeRealm(realm);
}
