{
  RealmModel realm=realmProvider.getRealmByName(realmName);
  if (realm == null) {
    Assert.fail("realm " + realmName + " not found");
  }
  UserModel user=userProvider.getUserByUsername(username,realm);
  if (user == null) {
    Assert.fail("user " + username + " not found");
  }
  KeycloakSession session=keycloakRule.startSession();
  try {
    Assert.assertTrue(userProvider.validCredentials(session,realm,user,UserCredentialModel.password(password)));
  }
  finally {
    keycloakRule.stopSession(session,true);
  }
}
