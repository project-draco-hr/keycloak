{
  KeycloakSession session=keycloakRule.startSession();
  try {
    RealmManager manager=new RealmManager(session);
    RealmModel appRealm=manager.getRealm("test");
    LDAPFederationProvider ldapFedProvider=FederationTestUtils.getLdapProvider(session,ldapModel);
    LDAPObject jbrown2=FederationTestUtils.addLDAPUser(ldapFedProvider,appRealm,"JBrown2","John","Brown2","jbrown2@email.org",null,"1234");
    ldapFedProvider.getLdapIdentityStore().updatePassword(jbrown2,"password");
    LDAPObject jbrown3=FederationTestUtils.addLDAPUser(ldapFedProvider,appRealm,"jbrown3","John","Brown3","JBrown3@email.org",null,"1234");
    ldapFedProvider.getLdapIdentityStore().updatePassword(jbrown3,"password");
  }
  finally {
    keycloakRule.stopSession(session,true);
  }
  loginSuccessAndLogout("jbrown2","password");
  loginSuccessAndLogout("JBrown2","password");
  loginSuccessAndLogout("jbrown2@email.org","password");
  loginSuccessAndLogout("JBrown2@email.org","password");
  loginSuccessAndLogout("jbrown3","password");
  loginSuccessAndLogout("JBrown3","password");
  loginSuccessAndLogout("jbrown3@email.org","password");
  loginSuccessAndLogout("JBrown3@email.org","password");
}
