{
  KeycloakSession session=keycloakRule.startSession();
  RealmModel realm=session.realms().getRealmByName("test");
  UserModel user=session.users().addUser(realm,"memuser");
  user.updateCredential(UserCredentialModel.password("password"));
  keycloakRule.stopSession(session,true);
  loginSuccessAndLogout("memuser","password");
  session=keycloakRule.startSession();
  realm=session.realms().getRealmByName("test");
  user=session.users().getUserByUsername("memuser",realm);
  Assert.assertEquals(memoryProvider.getId(),StorageId.resolveProviderId(user));
  Assert.assertEquals(0,user.getCredentialsDirectly().size());
  session.users().removeUser(realm,user);
  Assert.assertNull(session.users().getUserByUsername("memuser",realm));
  keycloakRule.stopSession(session,true);
}
