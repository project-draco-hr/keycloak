{
  test1CreateRealm();
  UserProvider userProvider=realmManager.getSession().users();
  UserModel user=userProvider.addUser(realmModel,"bburke");
  UserCredentialModel cred=new UserCredentialModel();
  cred.setType(CredentialRepresentation.PASSWORD);
  cred.setValue("geheim");
  realmManager.getSession().userCredentialManager().updateCredential(realmModel,user,cred);
  Assert.assertTrue(realmManager.getSession().userCredentialManager().isValid(realmModel,user,UserCredentialModel.password("geheim")));
  List<CredentialModel> creds=realmManager.getSession().userCredentialManager().getStoredCredentialsByType(realmModel,user,CredentialModel.PASSWORD);
  Assert.assertEquals(creds.get(0).getHashIterations(),20000);
  realmModel.setPasswordPolicy(PasswordPolicy.parse(realmManager.getSession(),"hashIterations(200)"));
  Assert.assertTrue(realmManager.getSession().userCredentialManager().isValid(realmModel,user,UserCredentialModel.password("geheim")));
  creds=realmManager.getSession().userCredentialManager().getStoredCredentialsByType(realmModel,user,CredentialModel.PASSWORD);
  Assert.assertEquals(creds.get(0).getHashIterations(),200);
  realmModel.setPasswordPolicy(PasswordPolicy.parse(realmManager.getSession(),"hashIterations(1)"));
}
