{
  RealmModel realm=realmManager.getRealm("original");
  Map<String,ClientModel> clients=realm.getClientNameMap();
  ClientModel barClient=clients.get("bar-client");
  realm.removeClient(barClient.getId());
  commit();
  realm=realmManager.getRealm("original");
  clients=realm.getClientNameMap();
  ClientModel fooClient=clients.get("foo-client");
  Assert.assertNull(clients.get("bar-client"));
  UserModel john=session.users().getUserByUsername("john",realm);
  GrantedConsentModel johnFooConsent=john.getGrantedConsentByClient(fooClient.getId());
  Assert.assertEquals(johnFooConsent.getGrantedRoles().size(),1);
  Assert.assertEquals(johnFooConsent.getGrantedProtocolMappers().size(),1);
  Assert.assertTrue(isRoleGranted(realm,"realm-role",johnFooConsent));
  Assert.assertTrue(isMapperGranted(fooClient,"foo",johnFooConsent));
  Assert.assertNull(john.getGrantedConsentByClient(barClient.getId()));
}
