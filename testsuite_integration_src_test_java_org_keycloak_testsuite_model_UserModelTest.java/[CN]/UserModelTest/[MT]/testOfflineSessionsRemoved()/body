{
  RealmModel realm=realmManager.createRealm("original");
  ClientModel fooClient=realm.addClient("foo");
  ClientModel barClient=realm.addClient("bar");
  UserModel user1=session.users().addUser(realm,"user1");
  addOfflineUserSession(user1,"123","something1");
  addOfflineClientSession(user1,"456","123",fooClient.getId(),"something2");
  addOfflineClientSession(user1,"789","123",barClient.getId(),"something3");
  commit();
  realm=realmManager.getRealmByName("original");
  realm.removeClient(barClient.getId());
  commit();
  realm=realmManager.getRealmByName("original");
  user1=session.users().getUserByUsername("user1",realm);
  Assert.assertEquals("something1",user1.getOfflineUserSession("123").getData());
  Assert.assertEquals("something2",user1.getOfflineClientSession("456").getData());
  Assert.assertNull(user1.getOfflineClientSession("789"));
  realm.removeClient(fooClient.getId());
  commit();
  realm=realmManager.getRealmByName("original");
  user1=session.users().getUserByUsername("user1",realm);
  Assert.assertNull(user1.getOfflineClientSession("456"));
  Assert.assertNull(user1.getOfflineClientSession("789"));
  Assert.assertNull(user1.getOfflineUserSession("123"));
  Assert.assertEquals(0,user1.getOfflineUserSessions().size());
  Assert.assertEquals(0,user1.getOfflineClientSessions().size());
}
