{
  keycloakRule.configure(new KeycloakRule.KeycloakSetup(){
    @Override public void config(    RealmManager manager,    RealmModel adminstrationRealm,    RealmModel appRealm){
      for (      ApplicationModel app : appRealm.getApplications()) {
        if (app.getName().equals("test-app")) {
          app.addRedirectUri(oauth.getRedirectUri());
        }
      }
    }
  }
);
  oauth.state("mystate");
  AuthorizationCodeResponse response=oauth.doLogin("test-user@localhost","password");
  Assert.assertTrue(response.isRedirected());
  Assert.assertNotNull(response.getCode());
  oauth.verifyCode(response.getCode());
}
