{
  Client client=ClientBuilder.newClient();
  UriBuilder builder=UriBuilder.fromUri(org.keycloak.testsuite.Constants.AUTH_SERVER_ROOT);
  URI grantUri=OIDCLoginProtocolService.tokenUrl(builder).build("test");
  WebTarget grantTarget=client.target(grantUri);
  AccessTokenResponse accessTokenResponse=executeGrantAccessTokenRequest(grantTarget);
  KeycloakSession session=keycloakRule.startSession();
  keycloakRule.startSession().sessions().removeUserSessions(session.realms().getRealm("test"));
  keycloakRule.stopSession(session,true);
  Response response=executeUserInfoRequest(accessTokenResponse.getToken());
  assertEquals(Status.FORBIDDEN.getStatusCode(),response.getStatus());
  response.close();
  client.close();
}
