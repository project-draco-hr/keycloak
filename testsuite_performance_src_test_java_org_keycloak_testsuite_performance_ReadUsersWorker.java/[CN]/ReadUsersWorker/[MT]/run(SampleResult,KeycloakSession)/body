{
  RealmModel realm=session.realms().getRealm(realmId);
  if (realm == null) {
    throw new IllegalStateException("Realm '" + realmId + "' not found");
  }
  int totalIterationNumber=totalIterationCounter.incrementAndGet();
  String lastUsername=null;
  for (int i=0; i < readUsersPerIteration; i++) {
    ++userCounterInRealm;
    if (userCounterInRealm > countOfUsersPerRealm) {
      userCounterInRealm=1;
    }
    String username=PerfTestUtils.getUsername(userCounterInRealm);
    lastUsername=username;
    UserModel user=session.users().getUserByUsername(username,realm);
    if (readRoles) {
      user.getRoleMappings();
    }
    if (readScopes) {
    }
    if (readPassword) {
      session.users().validCredentials(realm,user,UserCredentialModel.password(username));
    }
    if (readSocialLinks) {
      session.users().getFederatedIdentities(user,realm);
    }
    if (searchBySocialLinks) {
      FederatedIdentityModel socialLink=new FederatedIdentityModel("facebook",username,username);
      session.users().getUserByFederatedIdentity(socialLink,realm);
    }
  }
  log.info("Finished iteration " + ++iterationNumber + " in ReadUsers test for "+ realmId+ " worker. Last read user "+ lastUsername+ " in realm: "+ realmId);
  int labelC=((totalIterationNumber - 1) / NUMBER_OF_ITERATIONS_IN_EACH_REPORT) * NUMBER_OF_ITERATIONS_IN_EACH_REPORT;
  result.setSampleLabel("ReadUsers " + (labelC + 1) + "-"+ (labelC + NUMBER_OF_ITERATIONS_IN_EACH_REPORT));
}
