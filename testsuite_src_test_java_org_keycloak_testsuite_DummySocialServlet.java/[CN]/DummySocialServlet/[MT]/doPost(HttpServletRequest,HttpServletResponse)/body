{
  String accessToken=req.getParameter("username");
  String state=null;
  String redirectUri=null;
  List<NameValuePair> query=URLEncodedUtils.parse(req.getQueryString(),Charset.forName("UTF-8"));
  for (  NameValuePair p : query) {
    if ("state".equals(p.getName())) {
      state=p.getValue();
    }
 else     if ("redirect_uri".equals(p.getName())) {
      redirectUri=p.getValue();
    }
  }
  String redirect=redirectUri + "?access_token=" + accessToken+ "&token_type=bearer&state="+ state;
  resp.sendRedirect(redirect);
}
