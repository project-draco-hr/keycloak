{
  appPage.open();
  Assert.assertTrue(loginPage.isCurrent());
  loginPage.resetPassword();
  Assert.assertTrue(resetPasswordPage.isCurrent());
  resetPasswordPage.changePassword("bburke@redhat.com","bburke@redhat.com");
  Assert.assertTrue(resetPasswordPage.isCurrent());
  Assert.assertEquals(1,greenMail.getReceivedMessages().length);
  MimeMessage message=greenMail.getReceivedMessages()[0];
  String body=(String)message.getContent();
  String changePasswordUrl=body.split("\n")[0];
  browser.navigate().to(changePasswordUrl.trim());
  Assert.assertTrue(updatePasswordPage.isCurrent());
  updatePasswordPage.changePassword("new-password","new-password");
  Assert.assertTrue(appPage.isCurrent());
  Assert.assertEquals("bburke@redhat.com",appPage.getUser());
  appPage.logout();
  appPage.open();
  Assert.assertTrue(loginPage.isCurrent());
  loginPage.login("bburke@redhat.com","new-password");
  Assert.assertTrue(appPage.isCurrent());
  Assert.assertEquals("bburke@redhat.com",appPage.getUser());
}
