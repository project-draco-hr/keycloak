{
  appPage.open();
  Assert.assertTrue(loginPage.isCurrent());
  String url=browser.getCurrentUrl();
  url=url.replace("tokens/login","account/password-reset");
  url=url + "&username=bburke@redhat.com";
  browser.navigate().to(url);
  MimeMessage message=greenMail.getReceivedMessages()[0];
  String body=(String)message.getContent();
  String changePasswordUrl=body.split("\n")[0];
  browser.navigate().to(changePasswordUrl.trim());
  changePasswordPage.changePassword("new-password","new-password");
  Assert.assertTrue(loginPage.isCurrent());
  loginPage.login("bburke@redhat.com","password");
  Assert.assertTrue(loginPage.isCurrent());
  Assert.assertEquals("Invalid username or password",loginPage.getError());
  loginPage.login("bburke@redhat.com","new-password");
  Assert.assertTrue(appPage.isCurrent());
  Assert.assertEquals("bburke@redhat.com",appPage.getUser());
}
