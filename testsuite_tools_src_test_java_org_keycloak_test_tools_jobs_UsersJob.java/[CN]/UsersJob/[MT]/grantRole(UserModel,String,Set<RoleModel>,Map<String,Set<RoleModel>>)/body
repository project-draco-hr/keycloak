{
  if (roleName.indexOf(':') == -1) {
    RoleModel realmRole=findRole(realmRoles,roleName);
    user.grantRole(realmRole);
  }
 else {
    String[] parts=roleName.split(":");
    Set<RoleModel> currentAppRoles=appRoles.get(parts[0]);
    if (currentAppRoles == null) {
      throw new IllegalStateException("Application '" + parts[0] + "' not found");
    }
    RoleModel appRole=findRole(currentAppRoles,parts[1]);
    user.grantRole(appRole);
  }
}
